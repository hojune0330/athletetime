# 애슬리트 타임 - 이미지 저장 및 정리 정책

## 📸 이미지 저장 방식
- 모든 이미지는 브라우저의 localStorage에 Base64 형식으로 저장됩니다
- 서버가 없는 정적 웹사이트이므로 사용자 브라우저에 직접 저장됩니다
- 브라우저별 localStorage 용량 제한: 약 5-10MB

## 🗂️ 이미지 처리 과정
1. **업로드 시**:
   - 원본 이미지: 최대 1200px로 자동 리사이징
   - 썸네일: 400px 크기로 자동 생성
   - 두 버전 모두 localStorage에 저장

2. **표시 방식**:
   - 게시물 목록: 썸네일 표시
   - 게시물 상세: 원본 이미지 표시
   - 전체화면 보기: 원본 이미지 표시

## 🧹 자동 정리 정책

### 단계별 정리 프로세스

#### 1단계: 원본 이미지 정리 (3일 후)
- **조건**: 게시물 작성 3일 경과
- **동작**: 원본 이미지만 삭제, 썸네일은 유지
- **결과**: 
  - 게시물 목록에서는 여전히 썸네일 표시
  - 상세보기에서는 썸네일을 확대하여 표시
  - 저장 공간 약 70% 절약

#### 2단계: 썸네일 정리 (30일 후)
- **조건**: 게시물 작성 30일 경과 + 저장소 사용률 50% 초과
- **동작**: 썸네일도 삭제
- **결과**: 
  - 게시물에 이미지가 있었다는 표시만 남음
  - 이미지 자체는 표시되지 않음

#### 3단계: 완전 삭제 (90일 후)
- **조건**: 게시물 작성 90일 경과
- **동작**: 모든 이미지 데이터 완전 삭제
- **결과**: 이미지 정보 완전 제거

## ⚙️ 정리 실행 시점

### 자동 정리
1. **페이지 로드 시**: 커뮤니티 페이지 접속 시 자동 체크
2. **1시간마다**: 페이지가 열려있는 동안 매시간 체크
3. **게시물 작성 시**: 새 게시물 작성 시 저장소 체크

### 정리 기준
- **저장소 50% 이상 사용**: 예방적 정리 시작
- **저장소 80% 이상 사용**: 적극적 정리 실행

## 💾 저장소 관리

### 용량 모니터링
```javascript
// 현재 저장소 사용량 확인
const storage = ImageHandler.checkStorageSpace();
console.log(`사용중: ${storage.percent}%`);
```

### 수동 정리 방법
브라우저 개발자 도구(F12) 콘솔에서:
```javascript
// 7일 이상된 원본 이미지 정리
const cleaned = ImageHandler.cleanOldImages(posts, 7, true);

// 30일 이상된 모든 이미지 정리
const cleaned = ImageHandler.cleanOldImages(posts, 30, false);
```

## 📊 정리 통계
정리가 실행되면 다음 정보가 기록됩니다:
- 정리된 게시물 수
- 확보된 저장 공간 (MB)
- 정리 유형 (원본/썸네일/완전삭제)

## ❓ FAQ

**Q: 왜 이미지가 삭제되나요?**
A: 브라우저 localStorage 용량 제한(5-10MB) 때문에 오래된 이미지를 정리하여 새로운 게시물을 위한 공간을 확보합니다.

**Q: 중요한 이미지를 보존하려면?**
A: 게시물 작성 후 3일 이내에 이미지를 다운로드하여 별도 보관하세요.

**Q: 삭제된 이미지를 복구할 수 있나요?**
A: 한번 삭제된 이미지는 복구할 수 없습니다. 중요한 이미지는 미리 백업하세요.

**Q: 정리 정책을 변경할 수 있나요?**
A: 현재는 고정된 정책이지만, 추후 사용자 설정 기능을 추가할 예정입니다.

## 🔍 기술적 세부사항

### 이미지 크기 계산
- Base64 인코딩: 원본 크기의 약 133% 차지
- 압축률: JPEG 품질 0.8로 설정
- 평균 이미지 크기:
  - 원본 (1200px): 약 100-200KB
  - 썸네일 (400px): 약 20-40KB

### 저장 공간 예시
5MB localStorage 기준:
- 원본+썸네일: 약 20-30개 게시물
- 썸네일만: 약 100-150개 게시물
- 텍스트만: 수천 개 게시물

## 📅 업데이트 이력
- 2024.09.25: 3단계 정리 정책 구현
- 2024.09.25: 자동 정리 기능 추가
- 2024.09.25: 저장소 모니터링 개선