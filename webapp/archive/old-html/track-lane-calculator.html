<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>400m íŠ¸ë™ ë ˆì¸ë³„ ì •ë°€ ê³„ì‚°ê¸° | Athlete Time</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Malgun Gothic', 'ë§‘ì€ ê³ ë”•', sans-serif;
    }
    
    .gradient-bg {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    }
    
    .lane-color-1 { background-color: #ef4444; }
    .lane-color-2 { background-color: #f97316; }
    .lane-color-3 { background-color: #eab308; }
    .lane-color-4 { background-color: #84cc16; }
    .lane-color-5 { background-color: #22c55e; }
    .lane-color-6 { background-color: #06b6d4; }
    .lane-color-7 { background-color: #3b82f6; }
    .lane-color-8 { background-color: #8b5cf6; }
    
    .track-diagram {
      position: relative;
      width: 100%;
      max-width: 600px;
      margin: 0 auto;
    }
    
    .curve-section {
      fill: none;
      stroke-width: 8;
      opacity: 0.7;
      transition: all 0.3s;
    }
    
    .curve-section:hover {
      opacity: 1;
      stroke-width: 10;
    }
    
    .straight-section {
      stroke-width: 8;
      opacity: 0.7;
      transition: all 0.3s;
    }
    
    .straight-section:hover {
      opacity: 1;
      stroke-width: 10;
    }
    
    @media print {
      .no-print {
        display: none !important;
      }
    }
  </style>
</head>
<body class="bg-gray-50">
  <div class="max-w-7xl mx-auto p-6">
    <!-- Header -->
    <div class="gradient-bg text-white p-6 rounded-xl mb-6">
      <div class="flex justify-between items-start">
        <div>
          <h1 class="text-3xl font-bold mb-2">400m íŠ¸ë™ ë ˆì¸ë³„ ì •ë°€ ê³„ì‚°ê¸°</h1>
          <p class="opacity-90">ê³¡ì„ ê³¼ ì§ì„  êµ¬ê°„ì„ ë¶„ë¦¬í•˜ì—¬ ì •í™•í•œ ê±°ë¦¬ì™€ í˜ì´ìŠ¤ ê³„ì‚°</p>
        </div>
        <div class="flex gap-2">
          <button onclick="window.location.href='pace-calculator.html'" class="bg-white/20 hover:bg-white/30 p-3 rounded-lg transition" title="í˜ì´ìŠ¤ ê³„ì‚°ê¸°">
            <i class="fas fa-calculator text-xl"></i>
          </button>
          <button onclick="window.location.href='index.html'" class="bg-white/20 hover:bg-white/30 p-3 rounded-lg transition" title="í™ˆìœ¼ë¡œ">
            <i class="fas fa-home text-xl"></i>
          </button>
        </div>
      </div>
    </div>

    <!-- Input Section -->
    <div class="bg-white rounded-xl shadow-lg p-6 mb-6">
      <h2 class="text-xl font-bold mb-4">ê³„ì‚° ì…ë ¥</h2>
      
      <div class="grid md:grid-cols-4 gap-4">
        <div>
          <label class="block text-sm font-medium mb-2">ë ˆì¸ ì„ íƒ</label>
          <select id="laneSelect" class="w-full p-3 border-2 rounded-lg focus:border-purple-500" onchange="calculateTrack()">
            <option value="1">ë ˆì¸ 1 (ìµœë‚´ì¸¡)</option>
            <option value="2">ë ˆì¸ 2</option>
            <option value="3">ë ˆì¸ 3</option>
            <option value="4" selected>ë ˆì¸ 4</option>
            <option value="5">ë ˆì¸ 5</option>
            <option value="6">ë ˆì¸ 6</option>
            <option value="7">ë ˆì¸ 7</option>
            <option value="8">ë ˆì¸ 8 (ìµœì™¸ì¸¡)</option>
          </select>
        </div>
        
        <div>
          <label class="block text-sm font-medium mb-2">ëª©í‘œ 400m ê¸°ë¡</label>
          <div class="flex gap-1">
            <input type="number" id="targetMin" placeholder="0" min="0" max="2" 
                   class="w-16 p-3 border-2 rounded-lg text-center" onchange="calculateTrack()">
            <span class="p-3">ë¶„</span>
            <input type="number" id="targetSec" placeholder="50" min="0" max="59" 
                   class="w-20 p-3 border-2 rounded-lg text-center" onchange="calculateTrack()">
            <span class="p-3">ì´ˆ</span>
          </div>
        </div>
        
        <div>
          <label class="block text-sm font-medium mb-2">í›ˆë ¨ ì¢…ëª©</label>
          <select id="eventType" class="w-full p-3 border-2 rounded-lg" onchange="calculateTrack()">
            <option value="400m">400m</option>
            <option value="200m">200m</option>
            <option value="800m">800m (2ë°”í€´)</option>
            <option value="1600m">1600m (4ë°”í€´)</option>
            <option value="interval">ì¸í„°ë²Œ í›ˆë ¨</option>
          </select>
        </div>
        
        <div>
          <label class="block text-sm font-medium mb-2">&nbsp;</label>
          <button onclick="calculateTrack()" 
                  class="w-full bg-purple-600 text-white p-3 rounded-lg hover:bg-purple-700 transition">
            <i class="fas fa-calculator mr-2"></i>ê³„ì‚°í•˜ê¸°
          </button>
        </div>
      </div>
    </div>

    <!-- Track Diagram -->
    <div class="bg-white rounded-xl shadow-lg p-6 mb-6">
      <h2 class="text-xl font-bold mb-4">íŠ¸ë™ êµ¬ê°„ë³„ ë¶„ì„</h2>
      
      <div class="track-diagram">
        <svg viewBox="0 0 600 400" class="w-full">
          <!-- Track Background -->
          <rect x="0" y="0" width="600" height="400" fill="#f9fafb"/>
          
          <!-- Grid lines for reference -->
          <g stroke="#e5e7eb" stroke-width="1" opacity="0.5">
            <line x1="100" y1="0" x2="100" y2="400"/>
            <line x1="200" y1="0" x2="200" y2="400"/>
            <line x1="300" y1="0" x2="300" y2="400"/>
            <line x1="400" y1="0" x2="400" y2="400"/>
            <line x1="500" y1="0" x2="500" y2="400"/>
            <line x1="0" y1="100" x2="600" y2="100"/>
            <line x1="0" y1="200" x2="600" y2="200"/>
            <line x1="0" y1="300" x2="600" y2="300"/>
          </g>
          
          <!-- Track outline -->
          <g id="trackOutline" fill="none" stroke="#374151" stroke-width="2">
            <!-- Outer track -->
            <path d="M 150 100 L 450 100 A 100 100 0 0 1 450 300 L 150 300 A 100 100 0 0 1 150 100" />
            <!-- Inner track -->
            <path d="M 170 120 L 430 120 A 80 80 0 0 1 430 280 L 170 280 A 80 80 0 0 1 170 120" />
          </g>
          
          <!-- Selected Lane Path (will be updated dynamically) -->
          <g id="selectedLane">
            <!-- Dynamic content here -->
          </g>
          
          <!-- Section Labels -->
          <g id="sectionLabels" font-size="12" font-weight="bold" text-anchor="middle">
            <!-- Start/Finish -->
            <line x1="300" y1="80" x2="300" y2="320" stroke="#1f2937" stroke-width="3" stroke-dasharray="5,5"/>
            <text x="300" y="70" fill="#1f2937">START/FINISH</text>
            
            <!-- Section markers -->
            <text x="375" y="200" fill="#6b7280">ì§ì„  100m</text>
            <text x="450" y="200" fill="#6b7280">ê³¡ì„  100m</text>
            <text x="225" y="200" fill="#6b7280">ì§ì„  100m</text>
            <text x="150" y="200" fill="#6b7280">ê³¡ì„  100m</text>
            
            <!-- Distance markers -->
            <g fill="#9ca3af" font-size="10">
              <text x="300" y="340">0m / 400m</text>
              <text x="450" y="340">100m</text>
              <text x="450" y="60">200m</text>
              <text x="150" y="60">300m</text>
            </g>
          </g>
          
          <!-- Lane Numbers -->
          <g id="laneNumbers" font-size="14" font-weight="bold" text-anchor="middle">
            <!-- Will be filled dynamically -->
          </g>
        </svg>
      </div>
      
      <!-- Legend -->
      <div class="mt-4 flex justify-center gap-6 text-sm">
        <div class="flex items-center">
          <div class="w-8 h-3 bg-blue-500 rounded mr-2"></div>
          <span>ì§ì„  êµ¬ê°„</span>
        </div>
        <div class="flex items-center">
          <div class="w-8 h-3 bg-red-500 rounded mr-2"></div>
          <span>ê³¡ì„  êµ¬ê°„</span>
        </div>
        <div class="flex items-center">
          <div class="w-8 h-3 bg-gray-400 rounded mr-2"></div>
          <span>ìŠ¤íƒœê±° (ì¶œë°œ ìœ„ì¹˜)</span>
        </div>
      </div>
    </div>

    <!-- Detailed Calculation Results -->
    <div class="grid md:grid-cols-2 gap-6 mb-6">
      <!-- Distance Analysis -->
      <div class="bg-white rounded-xl shadow-lg p-6">
        <h3 class="text-lg font-bold mb-4">
          <i class="fas fa-ruler text-blue-500 mr-2"></i>ê±°ë¦¬ ë¶„ì„
        </h3>
        
        <div id="distanceAnalysis" class="space-y-3">
          <!-- Will be filled dynamically -->
        </div>
        
        <div class="mt-4 p-3 bg-gray-50 rounded-lg">
          <h4 class="font-semibold text-sm mb-2">ê³„ì‚° ê³µì‹</h4>
          <div class="text-xs font-mono space-y-1">
            <p>ê³¡ì„  ê±°ë¦¬ = Ï€ Ã— ë°˜ê²½</p>
            <p>ë°˜ê²½ = 36.5 + (ë ˆì¸-1) Ã— 1.22</p>
            <p>ì§ì„  ê±°ë¦¬ = 84.39m (ê³ ì •)</p>
          </div>
        </div>
      </div>
      
      <!-- Pace Analysis -->
      <div class="bg-white rounded-xl shadow-lg p-6">
        <h3 class="text-lg font-bold mb-4">
          <i class="fas fa-tachometer-alt text-green-500 mr-2"></i>í˜ì´ìŠ¤ ë¶„ì„
        </h3>
        
        <div id="paceAnalysis" class="space-y-3">
          <!-- Will be filled dynamically -->
        </div>
        
        <div class="mt-4 p-3 bg-yellow-50 rounded-lg">
          <h4 class="font-semibold text-sm mb-2">ğŸ’¡ í›ˆë ¨ íŒ</h4>
          <p class="text-xs text-gray-700" id="trainingTip">
            ë ˆì¸ë³„ ê±°ë¦¬ ì°¨ì´ë¥¼ ê³ ë ¤í•˜ì—¬ ëª©í‘œ ì‹œê°„ì„ ì¡°ì •í•˜ì„¸ìš”.
          </p>
        </div>
      </div>
    </div>

    <!-- Comparison Table -->
    <div class="bg-white rounded-xl shadow-lg p-6 mb-6">
      <h3 class="text-lg font-bold mb-4">
        <i class="fas fa-table text-purple-500 mr-2"></i>ì „ì²´ ë ˆì¸ ë¹„êµ
      </h3>
      
      <div class="overflow-x-auto">
        <table class="w-full text-sm">
          <thead>
            <tr class="bg-gray-100">
              <th class="p-2 text-left">ë ˆì¸</th>
              <th class="p-2 text-center">ì´ ê±°ë¦¬</th>
              <th class="p-2 text-center">ì§ì„  (2Ã—)</th>
              <th class="p-2 text-center">ê³¡ì„  (2Ã—)</th>
              <th class="p-2 text-center">ìŠ¤íƒœê±°</th>
              <th class="p-2 text-center">ë°˜ê²½</th>
              <th class="p-2 text-center">ë³´ì • ì‹œê°„</th>
            </tr>
          </thead>
          <tbody id="comparisonTable">
            <!-- Will be filled dynamically -->
          </tbody>
        </table>
      </div>
    </div>

    <!-- Visual Chart -->
    <div class="bg-white rounded-xl shadow-lg p-6 mb-6">
      <h3 class="text-lg font-bold mb-4">
        <i class="fas fa-chart-bar text-indigo-500 mr-2"></i>êµ¬ê°„ë³„ ê±°ë¦¬ ì°¨íŠ¸
      </h3>
      
      <canvas id="distanceChart" width="400" height="200"></canvas>
    </div>

    <!-- Additional Information -->
    <div class="grid md:grid-cols-3 gap-6">
      <!-- Physics -->
      <div class="bg-gradient-to-br from-blue-50 to-blue-100 rounded-xl p-6">
        <h4 class="font-bold mb-3 text-blue-900">
          <i class="fas fa-atom mr-2"></i>ë¬¼ë¦¬í•™ì  ìš”ì†Œ
        </h4>
        <ul class="text-sm space-y-2 text-blue-800">
          <li>â€¢ ì›ì‹¬ë ¥: ì™¸ì¸¡ ë ˆì¸ì´ ìœ ë¦¬</li>
          <li>â€¢ ê²½ì‚¬ê°: ë‚´ì¸¡ì´ ë” ê¸‰ê²©</li>
          <li>â€¢ ë³´í­: ê³¡ì„ ì—ì„œ ê°ì†Œ</li>
          <li>â€¢ ê°€ì†ë„: ì§ì„ ì—ì„œ ìµœëŒ€</li>
        </ul>
      </div>
      
      <!-- Strategy -->
      <div class="bg-gradient-to-br from-green-50 to-green-100 rounded-xl p-6">
        <h4 class="font-bold mb-3 text-green-900">
          <i class="fas fa-chess mr-2"></i>ë ˆì¸ë³„ ì „ëµ
        </h4>
        <ul class="text-sm space-y-2 text-green-800">
          <li>â€¢ 1-3ë ˆì¸: íƒ€ì´íŠ¸í•œ ì½”ë„ˆë§</li>
          <li>â€¢ 4-5ë ˆì¸: ê· í˜•ì¡íŒ ì£¼í–‰</li>
          <li>â€¢ 6-8ë ˆì¸: ìŠ¤íƒœê±° í™œìš©</li>
          <li>â€¢ ê³µí†µ: ì¼ì •í•œ ë¦¬ë“¬ ìœ ì§€</li>
        </ul>
      </div>
      
      <!-- Records -->
      <div class="bg-gradient-to-br from-purple-50 to-purple-100 rounded-xl p-6">
        <h4 class="font-bold mb-3 text-purple-900">
          <i class="fas fa-trophy mr-2"></i>ì°¸ê³  ê¸°ë¡
        </h4>
        <ul class="text-sm space-y-2 text-purple-800">
          <li>â€¢ ë‚¨ì WR: 43.03ì´ˆ</li>
          <li>â€¢ ì—¬ì WR: 47.60ì´ˆ</li>
          <li>â€¢ ë‚¨ì í•œêµ­: 44.39ì´ˆ</li>
          <li>â€¢ ì—¬ì í•œêµ­: 51.84ì´ˆ</li>
        </ul>
      </div>
    </div>

    <!-- Creator Credit -->
    <div class="text-center mt-8 text-sm text-gray-600">
      ì œì‘ì: ì¥í˜¸ì¤€ ì½”ì¹˜ | ì •ë°€í•œ íŠ¸ë™ ë¶„ì„ìœ¼ë¡œ ìµœì ì˜ í›ˆë ¨ ì „ëµ ìˆ˜ë¦½
    </div>
  </div>

  <script>
    // Lane configuration data
    const laneConfig = {
      straightLength: 84.39, // meters per straight section
      innerRadius: 36.50,    // meters for lane 1
      laneWidth: 1.22        // meters between lanes
    };
    
    // Calculate lane data
    function getLaneData(laneNumber) {
      const radius = laneConfig.innerRadius + (laneNumber - 1) * laneConfig.laneWidth;
      const curveLength = Math.PI * radius; // Half circle
      const straightTotal = laneConfig.straightLength * 2;
      const curveTotal = curveLength * 2;
      const totalDistance = straightTotal + curveTotal;
      const stagger = totalDistance - 400;
      
      return {
        lane: laneNumber,
        radius: radius,
        straightLength: laneConfig.straightLength,
        curveLength: curveLength,
        straightTotal: straightTotal,
        curveTotal: curveTotal,
        totalDistance: totalDistance,
        stagger: stagger
      };
    }
    
    // Main calculation function
    function calculateTrack() {
      const laneNumber = parseInt(document.getElementById('laneSelect').value);
      const targetMin = parseInt(document.getElementById('targetMin').value) || 0;
      const targetSec = parseInt(document.getElementById('targetSec').value) || 50;
      const eventType = document.getElementById('eventType').value;
      
      const targetTime = targetMin * 60 + targetSec;
      const laneData = getLaneData(laneNumber);
      
      // Update track visualization
      updateTrackVisualization(laneNumber, laneData);
      
      // Update distance analysis
      updateDistanceAnalysis(laneData, targetTime);
      
      // Update pace analysis
      updatePaceAnalysis(laneData, targetTime, eventType);
      
      // Update comparison table
      updateComparisonTable(targetTime);
      
      // Update chart
      updateDistanceChart();
      
      // Update training tip
      updateTrainingTip(laneNumber, eventType);
    }
    
    // Update track SVG visualization
    function updateTrackVisualization(laneNumber, laneData) {
      const selectedLane = document.getElementById('selectedLane');
      const laneColors = ['#ef4444', '#f97316', '#eab308', '#84cc16', '#22c55e', '#06b6d4', '#3b82f6', '#8b5cf6'];
      const color = laneColors[laneNumber - 1];
      
      // Calculate path for selected lane
      const baseRadius = 90; // Base radius for visualization
      const visualRadius = baseRadius + (laneNumber - 1) * 10;
      
      selectedLane.innerHTML = `
        <!-- Selected lane path -->
        <g stroke="${color}" fill="none" stroke-width="6" opacity="0.8">
          <!-- Straight sections (blue overlay) -->
          <line x1="300" y1="${200 - visualRadius}" x2="450" y2="${200 - visualRadius}" 
                stroke="#3b82f6" stroke-width="8" opacity="0.8"/>
          <line x1="300" y1="${200 + visualRadius}" x2="450" y2="${200 + visualRadius}" 
                stroke="#3b82f6" stroke-width="8" opacity="0.8"/>
          
          <!-- Curve sections (red overlay) -->
          <path d="M 450 ${200 - visualRadius} A ${visualRadius} ${visualRadius} 0 0 1 450 ${200 + visualRadius}" 
                stroke="#ef4444" stroke-width="8" opacity="0.8"/>
          <path d="M 150 ${200 + visualRadius} A ${visualRadius} ${visualRadius} 0 0 1 150 ${200 - visualRadius}" 
                stroke="#ef4444" stroke-width="8" opacity="0.8"/>
        </g>
        
        <!-- Stagger line -->
        <line x1="${300 + laneData.stagger * 2}" y1="${200 - visualRadius - 20}" 
              x2="${300 + laneData.stagger * 2}" y2="${200 - visualRadius}" 
              stroke="#6b7280" stroke-width="3" stroke-dasharray="3,3"/>
        <text x="${300 + laneData.stagger * 2}" y="${200 - visualRadius - 25}" 
              font-size="10" fill="#6b7280" text-anchor="middle">
          +${laneData.stagger.toFixed(2)}m
        </text>
        
        <!-- Lane number -->
        <circle cx="300" cy="200" r="15" fill="${color}"/>
        <text x="300" y="205" font-size="14" font-weight="bold" fill="white" text-anchor="middle">
          ${laneNumber}
        </text>
      `;
    }
    
    // Update distance analysis
    function updateDistanceAnalysis(laneData, targetTime) {
      const html = `
        <div class="p-3 bg-blue-50 rounded-lg">
          <div class="flex justify-between items-center mb-2">
            <span class="font-medium">ì´ ê±°ë¦¬</span>
            <span class="text-xl font-bold text-blue-600">${laneData.totalDistance.toFixed(2)}m</span>
          </div>
          <div class="text-xs text-gray-600">ë ˆì¸ 1 ëŒ€ë¹„ +${laneData.stagger.toFixed(2)}m</div>
        </div>
        
        <div class="grid grid-cols-2 gap-2">
          <div class="p-3 bg-gray-50 rounded-lg">
            <div class="text-xs text-gray-500 mb-1">ì§ì„  êµ¬ê°„ (2Ã—)</div>
            <div class="font-bold">${laneData.straightTotal.toFixed(2)}m</div>
            <div class="text-xs text-blue-600">${(laneData.straightTotal / laneData.totalDistance * 100).toFixed(1)}%</div>
          </div>
          <div class="p-3 bg-gray-50 rounded-lg">
            <div class="text-xs text-gray-500 mb-1">ê³¡ì„  êµ¬ê°„ (2Ã—)</div>
            <div class="font-bold">${laneData.curveTotal.toFixed(2)}m</div>
            <div class="text-xs text-red-600">${(laneData.curveTotal / laneData.totalDistance * 100).toFixed(1)}%</div>
          </div>
        </div>
        
        <div class="p-2 bg-yellow-50 rounded text-xs">
          <strong>êµ¬ê°„ë³„ ìƒì„¸:</strong><br>
          â€¢ ì§ì„  1ê°œ: ${laneData.straightLength.toFixed(2)}m<br>
          â€¢ ê³¡ì„  1ê°œ: ${laneData.curveLength.toFixed(2)}m<br>
          â€¢ ê³¡ì„  ë°˜ê²½: ${laneData.radius.toFixed(2)}m
        </div>
      `;
      
      document.getElementById('distanceAnalysis').innerHTML = html;
    }
    
    // Update pace analysis
    function updatePaceAnalysis(laneData, targetTime, eventType) {
      const speed400m = 400 / targetTime; // m/s for 400m
      const actualSpeed = laneData.totalDistance / targetTime; // m/s for actual distance
      
      // Calculate split times
      const straightTime = laneData.straightTotal / actualSpeed;
      const curveTime = laneData.curveTotal / actualSpeed;
      
      // Calculate pace per km
      const pacePer400m = targetTime;
      const pacePerKm = (1000 / 400) * targetTime;
      
      const html = `
        <div class="p-3 bg-green-50 rounded-lg">
          <div class="flex justify-between items-center mb-2">
            <span class="font-medium">400m ëª©í‘œ</span>
            <span class="text-xl font-bold text-green-600">${formatTime(targetTime)}</span>
          </div>
          <div class="text-xs text-gray-600">ì‹¤ì œ ì†ë„: ${actualSpeed.toFixed(2)} m/s</div>
        </div>
        
        <div class="grid grid-cols-2 gap-2">
          <div class="p-3 bg-gray-50 rounded-lg">
            <div class="text-xs text-gray-500 mb-1">ì§ì„  ì‹œê°„</div>
            <div class="font-bold">${formatTime(straightTime)}</div>
            <div class="text-xs text-blue-600">${formatTime(straightTime/2)}/100m</div>
          </div>
          <div class="p-3 bg-gray-50 rounded-lg">
            <div class="text-xs text-gray-500 mb-1">ê³¡ì„  ì‹œê°„</div>
            <div class="font-bold">${formatTime(curveTime)}</div>
            <div class="text-xs text-red-600">${formatTime(curveTime/2)}/100m</div>
          </div>
        </div>
        
        <div class="p-2 bg-purple-50 rounded text-xs">
          <strong>í˜ì´ìŠ¤ ë³€í™˜:</strong><br>
          â€¢ 400m ë©: ${formatTime(pacePer400m)}<br>
          â€¢ í‚¬ë¡œë¯¸í„°: ${formatPacePerKm(pacePerKm)}<br>
          â€¢ ì‹œì†: ${(actualSpeed * 3.6).toFixed(2)} km/h
        </div>
      `;
      
      document.getElementById('paceAnalysis').innerHTML = html;
    }
    
    // Update comparison table
    function updateComparisonTable(targetTime) {
      const tbody = document.getElementById('comparisonTable');
      let html = '';
      
      for (let lane = 1; lane <= 8; lane++) {
        const data = getLaneData(lane);
        const adjustedTime = targetTime * (data.totalDistance / 400);
        const bgColor = lane % 2 === 0 ? 'bg-gray-50' : '';
        
        html += `
          <tr class="${bgColor} hover:bg-purple-50 transition">
            <td class="p-2">
              <span class="inline-block w-4 h-4 rounded-full lane-color-${lane} mr-2"></span>
              ë ˆì¸ ${lane}
            </td>
            <td class="p-2 text-center font-semibold">${data.totalDistance.toFixed(2)}m</td>
            <td class="p-2 text-center">${data.straightTotal.toFixed(2)}m</td>
            <td class="p-2 text-center">${data.curveTotal.toFixed(2)}m</td>
            <td class="p-2 text-center text-purple-600">+${data.stagger.toFixed(2)}m</td>
            <td class="p-2 text-center">${data.radius.toFixed(2)}m</td>
            <td class="p-2 text-center font-bold">${formatTime(adjustedTime)}</td>
          </tr>
        `;
      }
      
      tbody.innerHTML = html;
    }
    
    // Update distance chart
    function updateDistanceChart() {
      const ctx = document.getElementById('distanceChart').getContext('2d');
      
      const lanes = [];
      const straightData = [];
      const curveData = [];
      const totalData = [];
      
      for (let i = 1; i <= 8; i++) {
        const data = getLaneData(i);
        lanes.push(`ë ˆì¸ ${i}`);
        straightData.push(data.straightTotal);
        curveData.push(data.curveTotal);
        totalData.push(data.totalDistance);
      }
      
      // Clear existing chart
      if (window.distanceChartInstance) {
        window.distanceChartInstance.destroy();
      }
      
      window.distanceChartInstance = new Chart(ctx, {
        type: 'bar',
        data: {
          labels: lanes,
          datasets: [
            {
              label: 'ì§ì„  êµ¬ê°„',
              data: straightData,
              backgroundColor: 'rgba(59, 130, 246, 0.6)',
              borderColor: 'rgba(59, 130, 246, 1)',
              borderWidth: 1
            },
            {
              label: 'ê³¡ì„  êµ¬ê°„',
              data: curveData,
              backgroundColor: 'rgba(239, 68, 68, 0.6)',
              borderColor: 'rgba(239, 68, 68, 1)',
              borderWidth: 1
            }
          ]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          scales: {
            x: {
              stacked: true
            },
            y: {
              stacked: true,
              beginAtZero: true,
              title: {
                display: true,
                text: 'ê±°ë¦¬ (m)'
              }
            }
          },
          plugins: {
            tooltip: {
              callbacks: {
                footer: function(tooltipItems) {
                  let sum = 0;
                  tooltipItems.forEach(function(tooltipItem) {
                    sum += tooltipItem.parsed.y;
                  });
                  return 'ì´ ê±°ë¦¬: ' + sum.toFixed(2) + 'm';
                }
              }
            }
          }
        }
      });
    }
    
    // Update training tip
    function updateTrainingTip(laneNumber, eventType) {
      const tips = {
        '400m': {
          1: 'íƒ€ì´íŠ¸í•œ ì½”ë„ˆë§ ì—°ìŠµì´ ì¤‘ìš”í•©ë‹ˆë‹¤. ë‚´ì¸¡ ì–´ê¹¨ë¥¼ ë‚®ì¶”ê³  ëª¸ì„ ê¸°ìš¸ì´ì„¸ìš”.',
          2: 'ë ˆì¸ 1ë³´ë‹¤ 7m ë” ë‹¬ë ¤ì•¼ í•©ë‹ˆë‹¤. í˜ì´ìŠ¤ ì¡°ì ˆì— ìœ ì˜í•˜ì„¸ìš”.',
          3: 'ê· í˜•ì¡íŒ ë ˆì¸ì…ë‹ˆë‹¤. ì¼ì •í•œ ë¦¬ë“¬ì„ ìœ ì§€í•˜ì„¸ìš”.',
          4: 'ê°€ì¥ ì„ í˜¸ë˜ëŠ” ë ˆì¸ì…ë‹ˆë‹¤. ê²½ìŸìë¥¼ ë³¼ ìˆ˜ ìˆëŠ” ì´ì ì„ í™œìš©í•˜ì„¸ìš”.',
          5: 'ì™¸ì¸¡ ë ˆì¸ì˜ ì¥ì ì„ í™œìš©í•˜ë˜, ì˜¤ë²„í˜ì´ìŠ¤ì— ì£¼ì˜í•˜ì„¸ìš”.',
          6: 'ìŠ¤íƒœê±°ê°€ í¬ë¯€ë¡œ ì´ˆë°˜ í˜ì´ìŠ¤ë¥¼ ë³´ìˆ˜ì ìœ¼ë¡œ ê°€ì ¸ê°€ì„¸ìš”.',
          7: 'ê±°ì˜ 45më¥¼ ë” ë‹¬ë ¤ì•¼ í•©ë‹ˆë‹¤. ì²´ë ¥ ë°°ë¶„ì´ ì¤‘ìš”í•©ë‹ˆë‹¤.',
          8: 'ê°€ì¥ ê¸´ ê±°ë¦¬ì…ë‹ˆë‹¤. ìê¸° í˜ì´ìŠ¤ì— ì§‘ì¤‘í•˜ê³  ì£¼ë³€ì— í”ë“¤ë¦¬ì§€ ë§ˆì„¸ìš”.'
        },
        '200m': {
          1: 'í•œ ê°œì˜ ì½”ë„ˆë§Œ ë„ëŠ” ê²ƒì„ ê³ ë ¤í•˜ì—¬ ë” ê³µê²©ì ìœ¼ë¡œ ë‹¬ë¦¬ì„¸ìš”.',
          2: 'ê³¡ì„  êµ¬ê°„ì—ì„œì˜ ê°€ì†ì´ ì¤‘ìš”í•©ë‹ˆë‹¤.',
          3: 'ì§ì„  ì§„ì… ì‹œ ìµœëŒ€ ì†ë„ë¥¼ ë‚¼ ì¤€ë¹„ë¥¼ í•˜ì„¸ìš”.',
          4: 'ìŠ¤íƒ€íŠ¸ í›„ 60m ì§€ì ë¶€í„° ìµœëŒ€ ì†ë„ë¡œ ì „í™˜í•˜ì„¸ìš”.',
          5: 'ì™¸ì¸¡ ë ˆì¸ì˜ ì™„ë§Œí•œ ê³¡ì„ ì„ í™œìš©í•˜ì—¬ ì†ë„ë¥¼ ìœ ì§€í•˜ì„¸ìš”.',
          6: 'ìŠ¤íƒœê±° ë•Œë¬¸ì— ì•ì„œ ì¶œë°œí•˜ì§€ë§Œ ê¸´ì¥í•˜ì§€ ë§ˆì„¸ìš”.',
          7: 'ìì‹ ì˜ ë ˆì´ìŠ¤ì— ì§‘ì¤‘í•˜ê³  ë’¤ë¥¼ ëŒì•„ë³´ì§€ ë§ˆì„¸ìš”.',
          8: 'ê°€ì¥ ì™„ë§Œí•œ ì½”ë„ˆë¥¼ í™œìš©í•˜ì—¬ ìŠ¤í”¼ë“œë¥¼ ê·¹ëŒ€í™”í•˜ì„¸ìš”.'
        }
      };
      
      const tip = tips[eventType] ? tips[eventType][laneNumber] : 
                  'ë ˆì¸ë³„ ê±°ë¦¬ ì°¨ì´ë¥¼ ê³ ë ¤í•˜ì—¬ ëª©í‘œ ì‹œê°„ì„ ì¡°ì •í•˜ì„¸ìš”.';
      
      document.getElementById('trainingTip').textContent = tip;
    }
    
    // Format time helper
    function formatTime(seconds) {
      const min = Math.floor(seconds / 60);
      const sec = (seconds % 60).toFixed(2);
      return min > 0 ? `${min}:${sec.padStart(5, '0')}` : `${sec}ì´ˆ`;
    }
    
    // Format pace per km
    function formatPacePerKm(seconds) {
      const min = Math.floor(seconds / 60);
      const sec = Math.floor(seconds % 60);
      return `${min}:${sec.toString().padStart(2, '0')}/km`;
    }
    
    // Initialize on load
    document.addEventListener('DOMContentLoaded', function() {
      // Set default values
      document.getElementById('targetSec').value = '50';
      
      // Initial calculation
      calculateTrack();
    });
  </script>
</body>
</html>