<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>í˜ì´ìŠ¤ ê³„ì‚°ê¸° | ì• ìŠ¬ë¦¬íŠ¸ íƒ€ì„</title>
  
  <!-- PWA ë©”íƒ€ íƒœê·¸ -->
  <link rel="manifest" href="/manifest.json">
  <meta name="theme-color" content="#00ffa3">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="ì• ìŠ¬ë¦¬íŠ¸ íƒ€ì„">
  <link rel="apple-touch-icon" href="/icons/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
  <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <!-- dom-to-image ì œê±°, html2canvasë§Œ ì‚¬ìš© -->
  
  <!-- PWA ìŠ¤í¬ë¦½íŠ¸ -->
  <script src="/pwa-register.js" defer></script>
  
  <!-- í™˜ê²½ ëª¨ë‹¬ CSS -->
  <style>
    /* CRITICAL FIX: Prevent text floating at top of screen */
    /* Reset all positioning to prevent floating text */
    .floating-element,
    .top-floating,
    .absolute-position,
    .fixed-position {
      display: none !important;
      visibility: hidden !important;
      position: static !important;
      top: auto !important;
      left: auto !important;
      right: auto !important;
      bottom: auto !important;
      z-index: -999 !important;
    }
    
    /* Ensure proper content container positioning */
    .content-container {
      position: relative !important;
      margin-top: 0 !important;
      padding-top: 0 !important;
    }
    
    /* Fix for text positioning issues - add proper layout structure */
    html, body {
      height: 100%;
      margin: 0;
      padding: 0;
      overflow-x: hidden;
    }
    
    body { 
      font-family: -apple-system, BlinkMacSystemFont, 'Malgun Gothic', 'ë§‘ì€ ê³ ë”•', sans-serif;
      -webkit-tap-highlight-color: transparent;
    }
    
    .gradient-text {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }
    
    .card-hover {
      transition: all 0.3s ease;
    }
    
    .card-hover:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 20px rgba(0,0,0,0.1);
    }
    
    .pace-table {
      font-size: 12px;
      width: 100%;
      table-layout: fixed;
    }
    
    /* ëª¨ë°”ì¼ ë°˜ì‘í˜• ìŠ¤íƒ€ì¼ */
    @media (max-width: 768px) {
      .pace-table {
        font-size: 11px;
      }
      
      .pace-table td, .pace-table th {
        padding: 4px 2px;
      }
      
      /* í…Œì´ë¸” ìŠ¤í¬ë¡¤ */
      .table-container {
        overflow-x: auto;
        -webkit-overflow-scrolling: touch;
      }
      
      /* ì¹´ë“œ ê°„ê²© ì¤„ì´ê¸° */
      .card {
        margin-bottom: 1rem;
      }
    }
    
    .pace-table td, .pace-table th {
      padding: 6px 4px;
      text-align: center;
      border: 1px solid #e5e7eb;
      white-space: nowrap;
      box-sizing: border-box;
    }
    
    .pace-table th {
      background: #f3f4f6;
      font-weight: bold;
    }
    
    .pace-table .highlight-row {
      background: #fef3c7;
    }
    
    .pace-table .sub-highlight {
      background: #dbeafe;
    }
    
    .pace-table .highlight-cell {
      background: #fbbf24;
      font-weight: bold;
    }
    
    .lane-track {
      background: linear-gradient(135deg, #f97316 0%, #dc2626 100%);
      color: white;
    }
    
    input[type="number"]::-webkit-inner-spin-button,
    input[type="number"]::-webkit-outer-spin-button {
      opacity: 1;
      height: 40px;
    }
    
    .tab-active {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
    }
    
    /* Track lane visualization styles */
    .lane-1 { stroke: #ef4444; fill: none; }
    .lane-2 { stroke: #f97316; fill: none; }
    .lane-3 { stroke: #eab308; fill: none; }
    .lane-4 { stroke: #84cc16; fill: none; }
    .lane-5 { stroke: #22c55e; fill: none; }
    .lane-6 { stroke: #06b6d4; fill: none; }
    .lane-7 { stroke: #3b82f6; fill: none; }
    .lane-8 { stroke: #8b5cf6; fill: none; }
    
    .lane-selected {
      stroke-width: 3;
      opacity: 1;
    }
    
    .lane-unselected {
      stroke-width: 1.5;
      opacity: 0.4;
    }
    
    .track-time-text {
      font-size: 11px;
      font-weight: bold;
    }
    
    @media print {
      .no-print { display: none; }
      .pace-table { page-break-inside: avoid; }
    }
    
    .table-container {
      overflow-x: auto;
      -webkit-overflow-scrolling: touch;
    }

    .pace-header {
      position: sticky;
      left: 0;
      background: white;
      z-index: 1;
      box-shadow: 2px 0 4px rgba(0,0,0,0.1);
    }

    /* ëª¨ë°”ì¼ ë°˜ì‘í˜• ê°œì„  */
    @media (max-width: 768px) {
      /* í…Œì´ë¸” ê¸°ë³¸ ìŠ¤íƒ€ì¼ */
      .pace-table {
        font-size: 11px;
      }
      
      .pace-table td, .pace-table th {
        padding: 6px 3px;
        min-width: 40px;
      }
      
      /* ì²«ë²ˆì§¸ ì—´ ê³ ì • */
      .pace-table thead th:first-child,
      .pace-table tbody td:first-child {
        position: sticky;
        left: 0;
        background: white;
        z-index: 10;
        box-shadow: 2px 0 4px rgba(0,0,0,0.1);
        font-weight: bold;
        background-color: #f9fafb;
      }
      
      /* ë‹¤ìš´ë¡œë“œ ë²„íŠ¼ ëª¨ë°”ì¼ ìµœì í™” */
      .download-btn {
        position: static !important;
        margin-bottom: 10px;
        width: 100%;
        justify-content: center;
        flex-wrap: wrap;
        gap: 4px;
      }
      
      .download-btn button {
        flex: 1;
        min-width: 80px;
        padding: 8px 4px;
        font-size: 11px;
      }
      
      /* íƒ­ ë©”ë‰´ ìŠ¤í¬ë¡¤ */
      .tab-menu-container {
        overflow-x: auto;
        -webkit-overflow-scrolling: touch;
      }
      
      .tab-menu-container::-webkit-scrollbar {
        display: none;
      }
      
      /* ì°¨íŠ¸ ì»¨í…Œì´ë„ˆ ê°„ê²© */
      .chart-container {
        margin-bottom: 20px;
        padding: 12px !important;
      }
      
      /* ì…ë ¥ í•„ë“œ */
      input[type="number"] {
        font-size: 14px !important;
        padding: 6px !important;
      }
      
      /* ë²„íŠ¼ í¬ê¸° */
      .btn-small {
        padding: 6px 12px !important;
        font-size: 12px !important;
      }
      
      /* 3000m ì¥ì• ë¬¼ ëª¨ë°”ì¼ ë ˆì´ì•„ì›ƒ */
      .steeplechase-tables {
        display: block !important;
      }
      
      .steeplechase-tables > div {
        margin-bottom: 20px;
      }
      
      /* í—¤ë” í¬ê¸° ì¡°ì • */
      header h1 {
        font-size: 18px !important;
      }
      
      header img {
        height: 32px !important;
      }
      
      /* ì œì‘ ì •ë³´ */
      .chart-header-logo {
        font-size: 18px !important;
      }
      
      /* ìŠ¤í¬ë¡¤ í‘œì‹œê¸° */
      .table-container {
        position: relative;
      }
      
      .table-container.scrollable::after {
        content: 'â† ì¢Œìš° ìŠ¤í¬ë¡¤ â†’';
        position: absolute;
        right: 5px;
        top: 5px;
        background: linear-gradient(90deg, #3b82f6, #8b5cf6);
        color: white;
        padding: 2px 8px;
        border-radius: 12px;
        font-size: 10px;
        font-weight: 600;
        pointer-events: none;
        animation: pulse 2s infinite;
      }
      
      @keyframes pulse {
        0%, 100% { opacity: 0.8; }
        50% { opacity: 1; }
      }
    }
    
    /* íƒœë¸”ë¦¿ ë°˜ì‘í˜• */
    @media (min-width: 769px) and (max-width: 1024px) {
      .pace-table {
        font-size: 11px;
      }
      
      .pace-table td, .pace-table th {
        padding: 5px 3px;
      }
      
      .chart-container {
        padding: 16px;
      }
    }

    .chart-container {
      position: relative;
    }

    .chart-watermark {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%) rotate(-15deg);
      opacity: 0.03;
      pointer-events: none;
      z-index: 1;
      width: 50%;
      max-width: 350px;
      display: none; /* ì¼ë‹¨ ìˆ¨ê¹€ ì²˜ë¦¬ */
    }
    
    /* ì›Œí„°ë§ˆí¬ ì œê±° */
    .watermark-text {
      display: none !important;
    }
    
    /* í™˜ê²½ ì„ íƒ ëª¨ë‹¬ ìŠ¤íƒ€ì¼ - íŠ¸ë ˆì´ë‹ ê³„ì‚°ê¸°ì—ì„œ ê°€ì ¸ì˜´ */
    .env-modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.8);
      z-index: 2000;
      justify-content: center;
      align-items: center;
    }
    
    .env-modal.active {
      display: flex;
    }
    
    .env-modal-content {
      background: white;
      border-radius: 20px;
      padding: 2rem;
      max-width: 600px;
      width: 90%;
      animation: fadeInUp 0.3s ease;
    }
    
    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    
    .env-button {
      border: 2px solid #e5e7eb;
      transition: all 0.3s;
      cursor: pointer;
    }
    
    .env-button:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
    }
    
    .env-button.selected {
      border-color: #667eea;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
    }
    
    /* ìŠ¤í¬ë¡¤ë°” ìŠ¤íƒ€ì¼ */
    * {
      scrollbar-width: thin;
      scrollbar-color: #667eea rgba(0, 0, 0, 0.1);
    }
    
    *::-webkit-scrollbar {
      width: 6px;
      height: 6px;
    }
    
    *::-webkit-scrollbar-track {
      background: rgba(0, 0, 0, 0.1);
      border-radius: 3px;
    }
    
    *::-webkit-scrollbar-thumb {
      background: #667eea;
      border-radius: 3px;
    }
    
    *::-webkit-scrollbar-thumb:hover {
      background: #5a67d8;
    }
  </style>
</head>
<body class="bg-gray-50 min-h-screen">
  <!-- í—¤ë” -->
  <header class="bg-gradient-to-r from-blue-600 to-purple-600 text-white shadow-lg">
    <div class="container mx-auto px-4 py-4">
      <div class="flex items-center justify-between">
        <div class="flex items-center space-x-3">
          <div class="text-3xl">
            <i class="fas fa-running"></i>
          </div>
          <div>
            <h1 class="text-2xl font-bold">í˜ì´ìŠ¤ ê³„ì‚°ê¸°</h1>
            <p class="text-blue-100 text-sm">Athlete Time</p>
          </div>
        </div>
        <div class="flex items-center space-x-4">
          <!-- í™˜ê²½ ì„ íƒ ë²„íŠ¼ ì¶”ê°€ -->
          <button onclick="openEnvironmentModal()" class="bg-white text-blue-600 px-4 py-2 rounded-lg hover:bg-blue-50 transition-colors">
            <i class="fas fa-leaf mr-2"></i>í™˜ê²½ ì„ íƒ
          </button>
          <!-- ë‚´ë¹„ê²Œì´ì…˜ ë©”ë‰´ -->
          <nav class="hidden md:flex space-x-6">
            <a href="/" class="hover:text-blue-200 transition-colors"><i class="fas fa-home mr-1"></i>í™ˆ</a>
            <a href="/training-calculator.html" class="hover:text-blue-200 transition-colors"><i class="fas fa-dumbbell mr-1"></i>í›ˆë ¨</a>
            <a href="/competitions-calendar.html" class="hover:text-blue-200 transition-colors"><i class="fas fa-calendar mr-1"></i>ëŒ€íšŒ</a>
            <a href="/chat.html" class="hover:text-blue-200 transition-colors"><i class="fas fa-comments mr-1"></i>ì»¤ë®¤ë‹ˆí‹°</a>
          </nav>
          <!-- ëª¨ë°”ì¼ ë©”ë‰´ ë²„íŠ¼ -->
          <button class="md:hidden text-white" onclick="toggleMobileMenu()">
            <i class="fas fa-bars text-xl"></i>
          </button>
        </div>
      </div>
      <!-- ëª¨ë°”ì¼ ë©”ë‰´ -->
      <div id="mobileMenu" class="hidden md:hidden mt-4 pb-4">
        <nav class="flex flex-col space-y-2">
          <a href="/" class="text-white hover:text-blue-200 transition-colors py-2"><i class="fas fa-home mr-2"></i>í™ˆ</a>
          <a href="/training-calculator.html" class="text-white hover:text-blue-200 transition-colors py-2"><i class="fas fa-dumbbell mr-2"></i>í›ˆë ¨ ê³„ì‚°ê¸°</a>
          <a href="/competitions-calendar.html" class="text-white hover:text-blue-200 transition-colors py-2"><i class="fas fa-calendar mr-2"></i>ëŒ€íšŒ ìº˜ë¦°ë”</a>
          <a href="/chat.html" class="text-white hover:text-blue-200 transition-colors py-2"><i class="fas fa-comments mr-2"></i>ì»¤ë®¤ë‹ˆí‹°</a>
        </nav>
      </div>
    </div>
  </header>

  <!-- ë©”ì¸ ì»¨í…Œì´ë„ˆ -->
  <main class="container mx-auto px-4 py-6">
    <!-- ì…ë ¥ ì„¹ì…˜ -->
    <section class="bg-white rounded-xl shadow-lg p-6 mb-6">
      <h2 class="text-2xl font-bold mb-6 gradient-text"><i class="fas fa-stopwatch mr-3"></i>ê¸°ë¡ ì…ë ¥</h2>
      
      <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
        <!-- ê±°ë¦¬ ì„ íƒ -->
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">ê±°ë¦¬</label>
          <select id="distance" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
            <option value="400">400m</option>
            <option value="800">800m</option>
            <option value="1500">1500m</option>
            <option value="3000">3000m</option>
            <option value="5000" selected>5000m (5km)</option>
            <option value="10000">10000m (10km)</option>
            <option value="21097.5">í•˜í”„ë§ˆë¼í†¤ (21.0975km)</option>
            <option value="42195">ë§ˆë¼í†¤ (42.195km)</option>
          </select>
        </div>
        
        <!-- ì‹œê°„ ì…ë ¥ -->
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">ì‹œê°„</label>
          <div class="flex space-x-2">
            <input type="number" id="minutes" placeholder="ë¶„" min="0" max="999" class="flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
            <input type="number" id="seconds" placeholder="ì´ˆ" min="0" max="59" class="flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
          </div>
        </div>
        
        <!-- ê³„ì‚° ë²„íŠ¼ -->
        <div class="flex items-end">
          <button onclick="calculatePace()" class="w-full bg-gradient-to-r from-blue-600 to-purple-600 text-white px-6 py-2 rounded-lg hover:from-blue-700 hover:to-purple-700 transition-all transform hover:scale-105">
            <i class="fas fa-calculator mr-2"></i>ê³„ì‚°í•˜ê¸°
          </button>
        </div>
      </div>
      
      <!-- ë¹ ë¥¸ ì…ë ¥ ë²„íŠ¼ -->
      <div class="mt-4 flex flex-wrap gap-2">
        <button onclick="quickInput(20, 0)" class="px-3 py-1 bg-gray-100 text-gray-700 rounded-full text-sm hover:bg-gray-200 transition-colors">20ë¶„</button>
        <button onclick="quickInput(25, 0)" class="px-3 py-1 bg-gray-100 text-gray-700 rounded-full text-sm hover:bg-gray-200 transition-colors">25ë¶„</button>
        <button onclick="quickInput(30, 0)" class="px-3 py-1 bg-gray-100 text-gray-700 rounded-full text-sm hover:bg-gray-200 transition-colors">30ë¶„</button>
        <button onclick="quickInput(35, 0)" class="px-3 py-1 bg-gray-100 text-gray-700 rounded-full text-sm hover:bg-gray-200 transition-colors">35ë¶„</button>
        <button onclick="quickInput(40, 0)" class="px-3 py-1 bg-gray-100 text-gray-700 rounded-full text-sm hover:bg-gray-200 transition-colors">40ë¶„</button>
        <button onclick="quickInput(45, 0)" class="px-3 py-1 bg-gray-100 text-gray-700 rounded-full text-sm hover:bg-gray-200 transition-colors">45ë¶„</button>
        <button onclick="quickInput(50, 0)" class="px-3 py-1 bg-gray-100 text-gray-700 rounded-full text-sm hover:bg-gray-200 transition-colors">50ë¶„</button>
      </div>
    </section>

    <!-- ê²°ê³¼ ì„¹ì…˜ -->
    <section id="results" class="hidden">
      <!-- í˜ì´ìŠ¤ ì •ë³´ ì¹´ë“œ -->
      <div class="bg-white rounded-xl shadow-lg p-6 mb-6">
        <div class="flex justify-between items-start mb-4">
          <h3 class="text-xl font-bold gradient-text"><i class="fas fa-tachometer-alt mr-2"></i>í˜ì´ìŠ¤ ë¶„ì„</h3>
          <div class="download-btn flex space-x-2">
            <button onclick="downloadImage()" class="bg-green-500 text-white px-4 py-2 rounded-lg hover:bg-green-600 transition-colors text-sm">
              <i class="fas fa-image mr-1"></i>ì´ë¯¸ì§€
            </button>
            <button onclick="downloadPDF()" class="bg-red-500 text-white px-4 py-2 rounded-lg hover:bg-red-600 transition-colors text-sm">
              <i class="fas fa-file-pdf mr-1"></i>PDF
            </button>
          </div>
        </div>
        
        <div id="paceInfo" class="grid grid-cols-1 md:grid-cols-4 gap-4"></div>
      </div>

      <!-- íƒ­ ë©”ë‰´ -->
      <div class="bg-white rounded-xl shadow-lg mb-6">
        <div class="flex border-b">
          <button onclick="showTab('paceChart')" class="tab-btn flex-1 px-6 py-4 text-sm font-medium hover:text-blue-600 transition-colors border-b-2 border-transparent" data-tab="paceChart">
            <i class="fas fa-chart-line mr-2"></i>í˜ì´ìŠ¤ ì°¨íŠ¸
          </button>
          <button onclick="showTab('targetTables')" class="tab-btn flex-1 px-6 py-4 text-sm font-medium hover:text-blue-600 transition-colors border-b-2 border-transparent" data-tab="targetTables">
            <i class="fas fa-target mr-2"></i>ëª©í‘œ ê¸°ë¡í‘œ
          </button>
          <button onclick="showTab('laneChart')" class="tab-btn flex-1 px-6 py-4 text-sm font-medium hover:text-blue-600 transition-colors border-b-2 border-transparent" data-tab="laneChart">
            <i class="fas fa-running mr-2"></i>íŠ¸ë™ ë ˆì¸
          </button>
          <button onclick="showTab('steeplechase')" class="tab-btn flex-1 px-6 py-4 text-sm font-medium hover:text-blue-600 transition-colors border-b-2 border-transparent" data-tab="steeplechase">
            <i class="fas fa-hurdle mr-2"></i>3000m ì¥ì• ë¬¼
          </button>
        </div>
        
        <div class="p-6">
          <!-- í˜ì´ìŠ¤ ì°¨íŠ¸ íƒ­ -->
          <div id="paceChart" class="tab-content">
            <div class="chart-container bg-gray-50 rounded-lg p-4">
              <h4 class="text-lg font-bold mb-4"><i class="fas fa-table mr-2"></i>ê±°ë¦¬ë³„ í˜ì´ìŠ¤ ë¶„ì„</h4>
              <div class="table-container">
                <table id="paceTable" class="pace-table">
                  <thead id="paceTableHead"></thead>
                  <tbody id="paceTableBody"></tbody>
                </table>
              </div>
            </div>
          </div>
          
          <!-- ëª©í‘œ ê¸°ë¡í‘œ íƒ­ -->
          <div id="targetTables" class="tab-content hidden">
            <div class="space-y-6">
              <div class="chart-container bg-gray-50 rounded-lg p-4">
                <h4 class="text-lg font-bold mb-4"><i class="fas fa-medal mr-2"></i>5km ëª©í‘œ ê¸°ë¡</h4>
                <div class="table-container">
                  <table class="pace-table">
                    <thead>
                      <tr class="bg-gray-100">
                        <th>ëª©í‘œ ê¸°ë¡</th>
                        <th>í‚¬ë¡œë¯¸í„°ë‹¹ í˜ì´ìŠ¤</th>
                        <th>400m</th>
                        <th>100m</th>
                        <th>ì‹œì†(km/h)</th>
                        <th>ìˆ˜ì¤€</th>
                      </tr>
                    </thead>
                    <tbody id="target5kmTable"></tbody>
                  </table>
                </div>
              </div>
              
              <div class="chart-container bg-gray-50 rounded-lg p-4">
                <h4 class="text-lg font-bold mb-4"><i class="fas fa-medal mr-2"></i>10km ëª©í‘œ ê¸°ë¡</h4>
                <div class="table-container">
                  <table class="pace-table">
                    <thead>
                      <tr class="bg-gray-100">
                        <th>ëª©í‘œ ê¸°ë¡</th>
                        <th>í‚¬ë¡œë¯¸í„°ë‹¹ í˜ì´ìŠ¤</th>
                        <th>400m</th>
                        <th>100m</th>
                        <th>ì‹œì†(km/h)</th>
                        <th>ìˆ˜ì¤€</th>
                      </tr>
                    </thead>
                    <tbody id="target10kmTable"></tbody>
                  </table>
                </div>
              </div>
              
              <div class="chart-container bg-gray-50 rounded-lg p-4">
                <h4 class="text-lg font-bold mb-4"><i class="fas fa-medal mr-2"></i>í•˜í”„ë§ˆë¼í†¤ ëª©í‘œ ê¸°ë¡</h4>
                <div class="table-container">
                  <table class="pace-table">
                    <thead>
                      <tr class="bg-gray-100">
                        <th>ëª©í‘œ ê¸°ë¡</th>
                        <th>í‚¬ë¡œë¯¸í„°ë‹¹ í˜ì´ìŠ¤</th>
                        <th>5km</th>
                        <th>10km</th>
                        <th>ì‹œì†(km/h)</th>
                        <th>ìˆ˜ì¤€</th>
                      </tr>
                    </thead>
                    <tbody id="targetHalfTable"></tbody>
                  </table>
                </div>
              </div>
            </div>
          </div>
          
          <!-- íŠ¸ë™ ë ˆì¸ ì°¨íŠ¸ íƒ­ -->
          <div id="laneChart" class="tab-content hidden">
            <div class="chart-container bg-gray-50 rounded-lg p-4">
              <h4 class="text-lg font-bold mb-4"><i class="fas fa-map mr-2"></i>íŠ¸ë™ ë ˆì¸ë³„ ì‹œê°„ ì°¨íŠ¸</h4>
              <div class="mb-4">
                <label class="block text-sm font-medium text-gray-700 mb-2">ëª©í‘œ ì‹œê°„</label>
                <input type="text" id="laneTargetTime" placeholder="ì˜ˆ: 2:00" class="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                <button onclick="generateLaneChart()" class="ml-2 bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 transition-colors">
                  <i class="fas fa-sync mr-1"></i>ì°¨íŠ¸ ìƒì„±
                </button>
              </div>
              <div id="laneChartContainer" class="overflow-x-auto">
                <svg id="laneSvg" width="100%" height="300"></svg>
              </div>
            </div>
          </div>
          
          <!-- 3000m ì¥ì• ë¬¼ íƒ­ -->
          <div id="steeplechase" class="tab-content hidden">
            <div class="space-y-6">
              <div class="bg-blue-50 border-l-4 border-blue-500 p-4 rounded">
                <h5 class="font-bold text-blue-800"><i class="fas fa-info-circle mr-2"></i>3000m ì¥ì• ë¬¼ ë ˆì´ìŠ¤ ì •ë³´</h5>
                <p class="text-blue-700 text-sm mt-2">ì´ 7ë°”í€´ (7 Ã— 428.57m), 35ê°œ ì¥ì• ë¬¼ + 7ê°œ ë¬¼ì›…ë©ì´</p>
              </div>
              
              <div class="steeplechase-tables grid grid-cols-1 lg:grid-cols-2 gap-6">
                <div class="chart-container bg-gray-50 rounded-lg p-4">
                  <h4 class="text-lg font-bold mb-4"><i class="fas fa-stopwatch mr-2"></i>ë°”í€´ë‹¹ ëª©í‘œ ì‹œê°„</h4>
                  <div class="table-container">
                    <table class="pace-table">
                      <thead>
                        <tr class="bg-gray-100">
                          <th>ë°”í€´</th>
                          <th>ëª©í‘œ ì‹œê°„</th>
                          <th>ëˆ„ì  ì‹œê°„</th>
                          <th>ì¥ì• ë¬¼ ìˆ˜</th>
                        </tr>
                      </thead>
                      <tbody id="steeplechaseLaps"></tbody>
                    </table>
                  </div>
                </div>
                
                <div class="chart-container bg-gray-50 rounded-lg p-4">
                  <h4 class="text-lg font-bold mb-4"><i class="fas fa-tachometer-alt mr-2"></i>í˜ì´ìŠ¤ ë¶„ì„</h4>
                  <div class="table-container">
                    <table class="pace-table">
                      <thead>
                        <tr class="bg-gray-100">
                          <th>êµ¬ê°„</th>
                          <th>í˜ì´ìŠ¤</th>
                          <th>ì¥ì• ë¬¼</th>
                          <th>ë¹„ê³ </th>
                        </tr>
                      </thead>
                      <tbody id="steeplechasePace"></tbody>
                    </table>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- 9-10ì¼ ì£¼ê¸°í™” ì„¹ì…˜ -->
    <section id="periodizationSection" class="hidden bg-white rounded-xl shadow-lg p-6 mb-6">
      <h3 class="text-xl font-bold mb-4 flex items-center">
        <i class="fas fa-calendar-week text-purple-600 mr-2"></i>
        9-10ì¼ ê³¼í•™ì  ì£¼ê¸°í™” ì¶”ì²œ
      </h3>
      
      <div class="bg-gradient-to-r from-purple-50 to-blue-50 border border-purple-200 rounded-lg p-4 mb-4">
        <div class="font-semibold text-purple-700 mb-2">ğŸ§¬ ìƒë¦¬í•™ì  ê¸°ë°˜</div>
        <div class="text-sm text-gray-700 grid md:grid-cols-2 gap-3">
          <div>
            <strong>ê·¼ìœ¡ ë‹¨ë°±ì§ˆ í•©ì„±:</strong> 48-72ì‹œê°„<br>
            <strong>ë¯¸í† ì½˜ë“œë¦¬ì•„ ì ì‘:</strong> 72-96ì‹œê°„<br>
            <strong>ì‹ ê²½ê³„ íšŒë³µ:</strong> 24-48ì‹œê°„
          </div>
          <div>
            <strong>í˜¸ë¥´ëª¬ ìµœì í™”:</strong> 48-120ì‹œê°„<br>
            <strong>ì´ˆë³´ìƒ íš¨ê³¼:</strong> 72-96ì‹œê°„<br>
            <strong>ë¶€ìƒ ì˜ˆë°©:</strong> 30% ê°ì†Œ
          </div>
        </div>
      </div>
      
      <div class="grid md:grid-cols-9 gap-2 text-xs">
        <!-- Day 1-9 cycle display -->
        <div class="col-span-9 grid grid-cols-9 gap-1 mb-4">
          <!-- Day 1: High Intensity -->
          <div class="bg-red-100 border border-red-300 rounded p-2 text-center">
            <div class="font-bold text-red-700">Day 1</div>
            <div class="text-red-600 text-xs">ê³ ê°•ë„</div>
            <div class="text-gray-600 text-xs mt-1">ì¸í„°ë²Œ</div>
          </div>
          
          <!-- Day 2: Recovery -->
          <div class="bg-green-100 border border-green-300 rounded p-2 text-center">
            <div class="font-bold text-green-700">Day 2</div>
            <div class="text-green-600 text-xs">ì €ê°•ë„</div>
            <div class="text-gray-600 text-xs mt-1">íšŒë³µëŸ°</div>
          </div>
          
          <!-- Day 3: Threshold -->
          <div class="bg-orange-100 border border-orange-300 rounded p-2 text-center">
            <div class="font-bold text-orange-700">Day 3</div>
            <div class="text-orange-600 text-xs">ì¤‘ê°•ë„</div>
            <div class="text-gray-600 text-xs mt-1">ì„ê³„</div>
          </div>
          
          <!-- Day 4: Rest -->
          <div class="bg-gray-100 border border-gray-300 rounded p-2 text-center">
            <div class="font-bold text-gray-700">Day 4</div>
            <div class="text-gray-600 text-xs">íœ´ì‹</div>
            <div class="text-gray-600 text-xs mt-1">í¬ë¡œìŠ¤</div>
          </div>
          
          <!-- Day 5: Speed -->
          <div class="bg-purple-100 border border-purple-300 rounded p-2 text-center">
            <div class="font-bold text-purple-700">Day 5</div>
            <div class="text-purple-600 text-xs">ê³ ê°•ë„</div>
            <div class="text-gray-600 text-xs mt-1">ìŠ¤í”¼ë“œ</div>
          </div>
          
          <!-- Day 6: Easy -->
          <div class="bg-green-100 border border-green-300 rounded p-2 text-center">
            <div class="font-bold text-green-700">Day 6</div>
            <div class="text-green-600 text-xs">ì €ê°•ë„</div>
            <div class="text-gray-600 text-xs mt-1">ì‰¬ìš´ ëŸ°</div>
          </div>
          
          <!-- Day 7: Long -->
          <div class="bg-blue-100 border border-blue-300 rounded p-2 text-center">
            <div class="font-bold text-blue-700">Day 7</div>
            <div class="text-blue-600 text-xs">ì¤‘ê°•ë„</div>
            <div class="text-gray-600 text-xs mt-1">ì¥ê±°ë¦¬</div>
          </div>
          
          <!-- Day 8: Rest -->
          <div class="bg-gray-100 border border-gray-300 rounded p-2 text-center">
            <div class="font-bold text-gray-700">Day 8</div>
            <div class="text-gray-600 text-xs">íœ´ì‹</div>
            <div class="text-gray-600 text-xs mt-1">íšŒë³µ</div>
          </div>
          
          <!-- Day 9: Test -->
          <div class="bg-indigo-100 border border-indigo-300 rounded p-2 text-center">
            <div class="font-bold text-indigo-700">Day 9</div>
            <div class="text-indigo-600 text-xs">í…ŒìŠ¤íŠ¸</div>
            <div class="text-gray-600 text-xs mt-1">í‰ê°€</div>
          </div>
        </div>
        
        <!-- Optional Day 10 -->
        <div class="col-span-9 grid grid-cols-9 gap-1">
          <div class="col-span-9 col-start-1 bg-gray-50 border-2 border-dashed border-gray-300 rounded p-2 text-center opacity-75">
            <div class="font-bold text-gray-600">Day 10 (ì„ íƒ)</div>
            <div class="text-gray-500 text-xs">ì¶”ê°€ íšŒë³µì¼</div>
            <div class="text-gray-500 text-xs mt-1">í”¼ë¡œë„ ê¸°ë°˜</div>
          </div>
        </div>
      </div>
      
      <div class="mt-4 text-sm text-gray-600 text-center">
        ğŸ’¡ <strong>ìƒë¦¬í•™ì  ì´ˆë³´ìƒ:</strong> ê³ ê°•ë„ í›ˆë ¨ í›„ 72-96ì‹œê°„ì˜ íšŒë³µ ê¸°ê°„ì´ ì„±ì¥ì„ ê·¹ëŒ€í™”í•©ë‹ˆë‹¤.
      </div>
    </section>

    </main>

  <!-- í‘¸í„° -->
  <footer class="bg-gray-800 text-white py-8 mt-12">
    <div class="container mx-auto px-4 text-center">
      <div class="flex justify-center items-center space-x-4 mb-4">
        <img src="/icons/icon-72x72.png" alt="Athlete Time" class="w-8 h-8">
        <span class="text-xl font-bold">Athlete Time</span>
      </div>
      <p class="text-gray-400 text-sm">ëŸ¬ë‹ ê³„ì‚°ê¸° ì „ë¬¸ í”Œë«í¼ | ì •í™•í•œ í˜ì´ìŠ¤ ë¶„ì„</p>
      <div class="mt-4 text-xs text-gray-500">
        <p>Â© 2024 Athlete Time. All rights reserved.</p>
      </div>
    </div>
  </footer>

  <!-- í™˜ê²½ ì„ íƒ ëª¨ë‹¬ -->
  <div id="environmentModal" class="env-modal">
    <div class="env-modal-content">
      <div class="text-center mb-6">
        <h3 class="text-2xl font-bold text-gray-800 mb-2">í™˜ê²½ ì„ íƒ</h3>
        <p class="text-gray-600">ëŸ¬ë‹ í™˜ê²½ì— ë”°ë¼ ì ì ˆí•œ ê³„ì‚°ê¸°ë¥¼ ì„ íƒí•˜ì„¸ìš”</p>
      </div>
      
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
        <button onclick="selectEnvironment('track')" class="env-button p-6 rounded-xl text-center hover:border-blue-500">
          <div class="text-4xl mb-3">ğŸƒâ€â™‚ï¸</div>
          <h4 class="font-bold text-lg mb-2">íŠ¸ë™</h4>
          <p class="text-sm text-gray-600">ì •í™•í•œ ê±°ë¦¬, ì •í™•í•œ í˜ì´ìŠ¤</p>
        </button>
        
        <button onclick="selectEnvironment('road')" class="env-button p-6 rounded-xl text-center hover:border-blue-500">
          <div class="text-4xl mb-3">ğŸ›£ï¸</div>
          <h4 class="font-bold text-lg mb-2">ë„ë¡œ</h4>
          <p class="text-sm text-gray-600">ì‹¤ì œ ëŸ¬ë‹ í™˜ê²½</p>
        </button>
        
        <button onclick="selectEnvironment('trail')" class="env-button p-6 rounded-xl text-center hover:border-blue-500">
          <div class="text-4xl mb-3">ğŸ”ï¸</div>
          <h4 class="font-bold text-lg mb-2">íŠ¸ë ˆì¼</h4>
          <p class="text-sm text-gray-600">ìì—° ì† ëŸ¬ë‹</p>
        </button>
        
        <button onclick="selectEnvironment('treadmill')" class="env-button p-6 rounded-xl text-center hover:border-blue-500">
          <div class="text-4xl mb-3">ğŸƒâ€â™€ï¸</div>
          <h4 class="font-bold text-lg mb-2">ëŸ¬ë‹ë¨¸ì‹ </h4>
          <p class="text-sm text-gray-600">ì‹¤ë‚´ í›ˆë ¨</p>
        </button>
      </div>
      
      <div class="text-center">
        <button onclick="closeEnvironmentModal()" class="bg-gray-500 text-white px-6 py-2 rounded-lg hover:bg-gray-600 transition-colors">
          ë‹«ê¸°
        </button>
      </div>
    </div>
  </div>

  <script>
    // ì „ì—­ ë³€ìˆ˜
    let currentPace = null;
    let selectedEnvironment = 'road'; // ê¸°ë³¸ê°’

    // PWA ì„¤ì¹˜ í”„ë¡¬í”„íŠ¸ ì²˜ë¦¬
    let deferredPrompt;
    window.addEventListener('beforeinstallprompt', (e) => {
      e.preventDefault();
      deferredPrompt = e;
      // ì„¤ì¹˜ ë²„íŠ¼ í‘œì‹œ ë¡œì§ì€ pwa-register.jsì—ì„œ ì²˜ë¦¬
    });

    // ëª¨ë°”ì¼ ë©”ë‰´ í† ê¸€
    function toggleMobileMenu() {
      const menu = document.getElementById('mobileMenu');
      menu.classList.toggle('hidden');
    }

    // í™˜ê²½ ì„ íƒ ëª¨ë‹¬ í•¨ìˆ˜
    function openEnvironmentModal() {
      document.getElementById('environmentModal').classList.add('active');
    }

    function closeEnvironmentModal() {
      document.getElementById('environmentModal').classList.remove('active');
    }

    function selectEnvironment(env) {
      selectedEnvironment = env;
      
      // ëª¨ë“  ë²„íŠ¼ì—ì„œ ì„ íƒ ìƒíƒœ ì œê±°
      document.querySelectorAll('.env-button').forEach(btn => {
        btn.classList.remove('selected');
      });
      
      // ì„ íƒëœ ë²„íŠ¼ì— ìŠ¤íƒ€ì¼ ì ìš©
      event.target.closest('.env-button').classList.add('selected');
      
      // ì„ íƒí•œ í™˜ê²½ì— ë”°ë¥¸ ì²˜ë¦¬
      setTimeout(() => {
        closeEnvironmentModal();
        // í•„ìš”ì‹œ ì¶”ê°€ ë¡œì§ êµ¬í˜„
      }, 300);
    }

    // ë¹ ë¥¸ ì…ë ¥ í•¨ìˆ˜
    function quickInput(minutes, seconds) {
      document.getElementById('minutes').value = minutes;
      document.getElementById('seconds').value = seconds;
      calculatePace();
    }

    // íƒ­ ì „í™˜ í•¨ìˆ˜
    function showTab(tabName) {
      // ëª¨ë“  íƒ­ ë²„íŠ¼ê³¼ ì½˜í…ì¸  ìˆ¨ê¹€
      document.querySelectorAll('.tab-btn').forEach(btn => {
        btn.classList.remove('tab-active');
        btn.classList.remove('border-blue-500', 'text-blue-600');
        btn.classList.add('border-transparent');
      });
      document.querySelectorAll('.tab-content').forEach(content => {
        content.classList.add('hidden');
      });
      
      // ì„ íƒëœ íƒ­ í™œì„±í™”
      const activeBtn = document.querySelector(`[data-tab="${tabName}"]`);
      activeBtn.classList.add('tab-active');
      activeBtn.classList.add('border-blue-500', 'text-blue-600');
      activeBtn.classList.remove('border-transparent');
      
      document.getElementById(tabName).classList.remove('hidden');
      
      // íŠ¹ì • íƒ­ì— ëŒ€í•œ ì¶”ê°€ ì²˜ë¦¬
      if (tabName === 'laneChart') {
        generateLaneChart();
      } else if (tabName === 'steeplechase') {
        generateSteeplechaseTables();
      }
    }

    // ì‹œê°„ í¬ë§·íŒ… í•¨ìˆ˜
    function formatTime(seconds) {
      const min = Math.floor(seconds / 60);
      const sec = Math.floor(seconds % 60);
      return `${min}:${sec.toString().padStart(2, '0')}`;
    }

    function formatPace(secondsPerKm) {
      const min = Math.floor(secondsPerKm / 60);
      const sec = Math.floor(secondsPerKm % 60);
      return `${min}:${sec.toString().padStart(2, '0')}/km`;
    }

    // í˜ì´ìŠ¤ ê³„ì‚° í•¨ìˆ˜
    function calculatePace() {
      const distance = parseFloat(document.getElementById('distance').value);
      const minutes = parseInt(document.getElementById('minutes').value) || 0;
      const seconds = parseInt(document.getElementById('seconds').value) || 0;
      
      if (minutes === 0 && seconds === 0) {
        alert('ì‹œê°„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
        return;
      }
      
      const totalSeconds = minutes * 60 + seconds;
      const pacePerKm = totalSeconds / (distance / 1000);
      const speed = (distance / 1000) / (totalSeconds / 3600);
      
      currentPace = pacePerKm;
      
      // ê²°ê³¼ í‘œì‹œ
      displayResults(distance, totalSeconds, pacePerKm, speed);
      
      // ì°¨íŠ¸ ìƒì„±
      generatePaceTable(distance, pacePerKm);
      generateTargetTables();
      
      // 9-10ì¼ ì£¼ê¸°í™” ì„¹ì…˜ í‘œì‹œ
      generatePeriodizationRecommendations(pacePerKm, distance);
      
      // ê²°ê³¼ ì„¹ì…˜ í‘œì‹œ
      document.getElementById('results').classList.remove('hidden');
      document.getElementById('periodizationSection').classList.remove('hidden');
      
      // ì²« ë²ˆì§¸ íƒ­ í‘œì‹œ
      showTab('paceChart');
    }

    // ê²°ê³¼ í‘œì‹œ í•¨ìˆ˜
    function displayResults(distance, totalSeconds, pacePerKm, speed) {
      const paceInfo = document.getElementById('paceInfo');
      const distanceKm = (distance / 1000).toFixed(1);
      
      paceInfo.innerHTML = `
        <div class="bg-gradient-to-br from-blue-50 to-blue-100 p-4 rounded-lg">
          <div class="text-sm text-gray-600 mb-1">ê±°ë¦¬</div>
          <div class="text-2xl font-bold text-blue-600">${distanceKm}km</div>
        </div>
        <div class="bg-gradient-to-br from-green-50 to-green-100 p-4 rounded-lg">
          <div class="text-sm text-gray-600 mb-1">ì´ ì‹œê°„</div>
          <div class="text-2xl font-bold text-green-600">${formatTime(totalSeconds)}</div>
        </div>
        <div class="bg-gradient-to-br from-purple-50 to-purple-100 p-4 rounded-lg">
          <div class="text-sm text-gray-600 mb-1">í‰ê·  í˜ì´ìŠ¤</div>
          <div class="text-2xl font-bold text-purple-600">${formatPace(pacePerKm)}</div>
        </div>
        <div class="bg-gradient-to-br from-orange-50 to-orange-100 p-4 rounded-lg">
          <div class="text-sm text-gray-600 mb-1">í‰ê·  ì†ë„</div>
          <div class="text-2xl font-bold text-orange-600">${speed.toFixed(1)} km/h</div>
        </div>
      `;
    }

    // í˜ì´ìŠ¤ í…Œì´ë¸” ìƒì„± í•¨ìˆ˜
    function generatePaceTable(distance, pacePerKm) {
      const tableHead = document.getElementById('paceTableHead');
      const tableBody = document.getElementById('paceTableBody');
      
      // í…Œì´ë¸” í—¤ë”
      const headers = ['ê±°ë¦¬', 'ëª©í‘œ ì‹œê°„', 'í˜ì´ìŠ¤', '400m', '100m', 'ì†ë„'];
      tableHead.innerHTML = '<tr>' + headers.map(h => `<th class="bg-gray-100">${h}</th>`).join('') + '</tr>';
      
      // ë°ì´í„° ìƒì„±
      const distances = [100, 200, 400, 800, 1000, 1500, 3000, 5000, 10000, 21097.5, 42195];
      const labels = ['100m', '200m', '400m', '800m', '1km', '1500m', '3km', '5km', '10km', 'í•˜í”„', 'ë§ˆë¼í†¤'];
      
      tableBody.innerHTML = '';
      distances.forEach((dist, i) => {
        const row = tableBody.insertRow();
        const targetTime = pacePerKm * (dist / 1000);
        const pace400m = pacePerKm * 0.4;
        const pace100m = pacePerKm * 0.1;
        const speed = (dist / 1000) / (targetTime / 3600);
        
        // í˜„ì¬ ì…ë ¥í•œ ê±°ë¦¬ í•˜ì´ë¼ì´íŠ¸
        if (Math.abs(dist - distance) < 1) {
          row.className = 'highlight-row';
        }
        
        row.innerHTML = `
          <td class="font-bold">${labels[i]}</td>
          <td>${formatTime(targetTime)}</td>
          <td>${formatPace(pacePerKm)}</td>
          <td>${formatTime(pace400m)}</td>
          <td>${formatTime(pace100m)}</td>
          <td>${speed.toFixed(1)}</td>
        `;
      });
    }

    // ëª©í‘œ í…Œì´ë¸” ìƒì„± í•¨ìˆ˜
    function generateTargetTables() {
      // 5km ëª©í‘œ ê¸°ë¡
      const targets5km = [
        { time: 13 * 60, label: 'ì„¸ê³„ ì—˜ë¦¬íŠ¸', highlight: true },
        { time: 14 * 60, label: 'êµ­ê°€ëŒ€í‘œ' },
        { time: 15 * 60, label: 'ì—˜ë¦¬íŠ¸', highlight: true },
        { time: 16 * 60, label: 'ì¤€ì—˜ë¦¬íŠ¸' },
        { time: 17 * 60, label: 'ìµœìƒê¸‰' },
        { time: 18 * 60, label: 'ìƒê¸‰' },
        { time: 19 * 60, label: 'ì¤‘ìƒê¸‰' },
        { time: 20 * 60, label: 'ì„œë¸Œ 20', highlight: true },
        { time: 22 * 60, label: 'ì¤‘ê¸‰' },
        { time: 25 * 60, label: 'ì´ˆì¤‘ê¸‰', highlight: true },
        { time: 28 * 60, label: 'ì´ˆê¸‰' },
        { time: 30 * 60, label: 'ì…ë¬¸', highlight: true },
        { time: 35 * 60, label: 'ì™„ì£¼ ëª©í‘œ' },
        { time: 40 * 60, label: 'ê±´ê°• ì¡°ê¹…', highlight: true }
      ];
      
      const tbody5km = document.getElementById('target5kmTable');
      tbody5km.innerHTML = '';
      
      targets5km.forEach(target => {
        const row = tbody5km.insertRow();
        if (target.highlight) row.className = 'highlight-row';
        
        const pacePerKm = target.time / 5;
        const pace400m = pacePerKm * 0.4;
        const pace100m = pacePerKm * 0.1;
        const speed = 5000 / target.time * 3.6;
        
        row.innerHTML = `
          <td class="font-bold">${formatTime(target.time)}</td>
          <td>${formatPace(pacePerKm)}</td>
          <td>${formatTime(pace400m)}</td>
          <td>${formatTime(pace100m)}</td>
          <td>${speed.toFixed(1)}</td>
          <td class="text-xs">${target.label}</td>
        `;
      });
      
      // 10km ëª©í‘œ ê¸°ë¡
      const targets10km = [
        { time: 28 * 60, label: 'ì„¸ê³„ ì—˜ë¦¬íŠ¸', highlight: true },
        { time: 30 * 60, label: 'êµ­ê°€ëŒ€í‘œ' },
        { time: 32 * 60, label: 'ì—˜ë¦¬íŠ¸', highlight: true },
        { time: 35 * 60, label: 'ì¤€ì—˜ë¦¬íŠ¸' },
        { time: 38 * 60, label: 'ìµœìƒê¸‰' },
        { time: 42 * 60, label: 'ìƒê¸‰' },
        { time: 45 * 60, label: 'ì¤‘ìƒê¸‰' },
        { time: 50 * 60, label: 'ì„œë¸Œ 50', highlight: true },
        { time: 55 * 60, label: 'ì¤‘ê¸‰' },
        { time: 60 * 60, label: 'ì´ˆì¤‘ê¸‰', highlight: true },
        { time: 65 * 60, label: 'ì´ˆê¸‰' },
        { time: 70 * 60, label: 'ì…ë¬¸', highlight: true },
        { time: 80 * 60, label: 'ì™„ì£¼ ëª©í‘œ' },
        { time: 90 * 60, label: 'ê±´ê°• ì¡°ê¹…', highlight: true }
      ];
      
      const tbody10km = document.getElementById('target10kmTable');
      tbody10km.innerHTML = '';
      
      targets10km.forEach(target => {
        const row = tbody10km.insertRow();
        if (target.highlight) row.className = 'highlight-row';
        
        const pacePerKm = target.time / 10;
        const pace400m = pacePerKm * 0.4;
        const pace100m = pacePerKm * 0.1;
        const speed = 10000 / target.time * 3.6;
        
        row.innerHTML = `
          <td class="font-bold">${formatTime(target.time)}</td>
          <td>${formatPace(pacePerKm)}</td>
          <td>${formatTime(pace400m)}</td>
          <td>${formatTime(pace100m)}</td>
          <td>${speed.toFixed(1)}</td>
          <td class="text-xs">${target.label}</td>
        `;
      });
      
      // í•˜í”„ë§ˆë¼í†¤ ëª©í‘œ ê¸°ë¡
      const tbodyHalf = document.getElementById('targetHalfTable');
      tbodyHalf.innerHTML = '';
      
      const halfTargets = [
        { time: 60 * 60, label: 'ì„¸ê³„ ì—˜ë¦¬íŠ¸', highlight: true },
        { time: 65 * 60, label: 'êµ­ê°€ëŒ€í‘œ' },
        { time: 70 * 60, label: 'ì—˜ë¦¬íŠ¸', highlight: true },
        { time: 75 * 60, label: 'ì¤€ì—˜ë¦¬íŠ¸' },
        { time: 80 * 60, label: 'ìµœìƒê¸‰' },
        { time: 85 * 60, label: 'ìƒê¸‰' },
        { time: 90 * 60, label: 'ì¤‘ìƒê¸‰' },
        { time: 100 * 60, label: 'ì„œë¸Œ 100', highlight: true },
        { time: 105 * 60, label: 'ì¤‘ê¸‰' },
        { time: 115 * 60, label: 'ì´ˆì¤‘ê¸‰', highlight: true },
        { time: 125 * 60, label: 'ì´ˆê¸‰' },
        { time: 135 * 60, label: 'ì…ë¬¸', highlight: true },
        { time: 150 * 60, label: 'ì™„ì£¼ ëª©í‘œ' },
        { time: 180 * 60, label: 'ê±´ê°• ì¡°ê¹…', highlight: true }
      ];
      
      halfTargets.forEach(target => {
        const row = tbodyHalf.insertRow();
        if (target.highlight) row.className = 'highlight-row';
        
        const pacePerKm = target.time / 21.0975;
        const time5km = pacePerKm * 5;
        const time10km = pacePerKm * 10;
        const speed = 21097.5 / target.time * 3.6;
        
        row.innerHTML = `
          <td class="font-bold">${formatTime(target.time)}</td>
          <td>${formatPace(pacePerKm)}</td>
          <td>${formatTime(time5km)}</td>
          <td>${formatTime(time10km)}</td>
          <td>${speed.toFixed(1)}</td>
          <td class="text-xs">${target.label}</td>
        `;
      });
    }

    // íŠ¸ë™ ë ˆì¸ ì°¨íŠ¸ ìƒì„± í•¨ìˆ˜
    function generateLaneChart() {
      const targetTime = document.getElementById('laneTargetTime').value;
      if (!targetTime) return;
      
      // ì‹œê°„ íŒŒì‹± (ì˜ˆ: "2:00")
      const [min, sec] = targetTime.split(':').map(Number);
      const targetSeconds = min * 60 + sec;
      
      const svg = document.getElementById('laneSvg');
      const containerWidth = svg.parentElement.clientWidth;
      const chartWidth = Math.max(containerWidth - 40, 600);
      const chartHeight = 250;
      
      svg.setAttribute('width', chartWidth);
      svg.setAttribute('height', chartHeight);
      
      // ì°¨íŠ¸ ë°ì´í„°
      const lanes = [1, 2, 3, 4, 5, 6, 7, 8];
      const laneDistances = [400, 407.67, 415.33, 423, 430.67, 438.33, 446, 453.67]; // 1ë ˆì¸ ê¸°ì¤€ ì‹¤ì œ ê±°ë¦¬
      const times = lanes.map(lane => {
        const actualDistance = laneDistances[lane - 1];
        return (targetSeconds * actualDistance) / 400;
      });
      
      // SVG ë‚´ìš© ìƒì„±
      let svgContent = `
        <defs>
          <linearGradient id="laneGradient" x1="0%" y1="0%" x2="100%" y2="0%">
            <stop offset="0%" style="stop-color:#3b82f6;stop-opacity:1" />
            <stop offset="100%" style="stop-color:#8b5cf6;stop-opacity:1" />
          </linearGradient>
        </defs>
        <text x="${chartWidth/2}" y="30" text-anchor="middle" class="text-lg font-bold fill-gray-700">íŠ¸ë™ ë ˆì¸ë³„ ì‹œê°„ ì°¨ì´</text>
      `;
      
      // ì°¨íŠ¸ ë°” ìƒì„±
      const barWidth = chartWidth / (lanes.length + 1);
      const maxTime = Math.max(...times);
      const minTime = Math.min(...times);
      const timeRange = maxTime - minTime;
      
      lanes.forEach((lane, i) => {
        const x = (i + 0.5) * barWidth;
        const time = times[i];
        const barHeight = ((time - minTime) / timeRange) * 150 + 50;
        const y = chartHeight - barHeight - 40;
        
        // ë°”
        svgContent += `
          <rect x="${x - barWidth/3}" y="${y}" width="${barWidth/1.5}" height="${barHeight}" 
                fill="url(#laneGradient)" rx="4" class="hover:opacity-80 transition-opacity"/>
          <text x="${x}" y="${y - 10}" text-anchor="middle" class="text-sm font-bold fill-gray-700">${lane}ë ˆì¸</text>
          <text x="${x}" y="${chartHeight - 15}" text-anchor="middle" class="text-xs fill-gray-600">${formatTime(time)}</text>
        `;
        
        // ì°¨ì´ ì‹œê°„ í‘œì‹œ
        if (i > 0) {
          const timeDiff = time - times[0];
          if (timeDiff > 0) {
            svgContent += `
              <text x="${x}" y="${y + 20}" text-anchor="middle" class="text-xs fill-red-600 font-bold">
                +${formatTime(timeDiff)}
              </text>
            `;
          }
        }
      });
      
      // ë²”ë¡€
      svgContent += `
        <text x="${chartWidth - 150}" y="50" class="text-sm fill-gray-600">
          <tspan>ê¸°ì¤€: 1ë ˆì¸ ${targetTime}</tspan>
          <tspan x="${chartWidth - 150}" dy="15">ìµœëŒ€ ì°¨ì´: ${formatTime(maxTime - minTime)}</tspan>
        </text>
      `;
      
      svg.innerHTML = svgContent;
    }

    // 3000m ì¥ì• ë¬¼ í…Œì´ë¸” ìƒì„± í•¨ìˆ˜
    function generateSteeplechaseTables() {
      // ë°”í€´ë‹¹ ëª©í‘œ ì‹œê°„
      const laps = [
        { lap: 1, target: 60, hurdles: 5, water: 0 },
        { lap: 2, target: 61, hurdles: 5, water: 1 },
        { lap: 3, target: 62, hurdles: 5, water: 0 },
        { lap: 4, target: 63, hurdles: 5, water: 0 },
        { lap: 5, target: 64, hurdles: 5, water: 1 },
        { lap: 6, target: 65, hurdles: 5, water: 0 },
        { lap: 7, target: 66, hurdles: 5, water: 1 }
      ];
      
      const tbodyLaps = document.getElementById('steeplechaseLaps');
      tbodyLaps.innerHTML = '';
      
      let cumulativeTime = 0;
      
      laps.forEach(lap => {
        cumulativeTime += lap.target;
        const row = tbodyLaps.insertRow();
        
        row.innerHTML = `
          <td class="font-bold">${lap.lap}ë°”í€´</td>
          <td>${formatTime(lap.target)}</td>
          <td>${formatTime(cumulativeTime)}</td>
          <td>${lap.hurdles + lap.water}</td>
        `;
      });
      
      // í˜ì´ìŠ¤ ë¶„ì„
      const paceAnalysis = [
        { section: 'ì¥ì• ë¬¼ ì—†ìŒ', pace: 60, hurdles: 0, note: 'í‰ì§€ í˜ì´ìŠ¤' },
        { section: 'ì¥ì• ë¬¼ êµ¬ê°„', pace: 65, hurdles: 5, note: 'ì¥ì• ë¬¼ 5ê°œ' },
        { section: 'ë¬¼ì›…ë©ì´', pace: 68, hurdles: 1, note: 'ë¬¼ì›…ë©ì´ 1ê°œ' },
        { section: 'ë§ˆì§€ë§‰ ìŠ¤í¼íŠ¸', pace: 55, hurdles: 0, note: 'ìµœì¢… ê°€ì†' }
      ];
      
      const tbodyPace = document.getElementById('steeplechasePace');
      tbodyPace.innerHTML = '';
      
      paceAnalysis.forEach(analysis => {
        const row = tbodyPace.insertRow();
        
        row.innerHTML = `
          <td class="font-bold">${analysis.section}</td>
          <td>${formatPace(analysis.pace)}</td>
          <td>${analysis.hurdles}</td>
          <td class="text-xs">${analysis.note}</td>
        `;
      });
    }

    // ë‹¤ìš´ë¡œë“œ í•¨ìˆ˜
    function downloadImage() {
      const element = document.querySelector('#results');
      html2canvas(element, {
        scale: 2,
        backgroundColor: '#ffffff',
        useCORS: true
      }).then(canvas => {
        const link = document.createElement('a');
        link.download = `pace-analysis-${new Date().toISOString().slice(0, 10)}.png`;
        link.href = canvas.toDataURL('image/png');
        link.click();
      });
    }

    function downloadPDF() {
      const element = document.querySelector('#results');
      html2canvas(element, {
        scale: 2,
        backgroundColor: '#ffffff',
        useCORS: true
      }).then(canvas => {
        const imgData = canvas.toDataURL('image/png');
        const pdf = new jspdf.jsPDF('p', 'mm', 'a4');
        const imgWidth = 210;
        const pageHeight = 295;
        const imgHeight = (canvas.height * imgWidth) / canvas.width;
        let heightLeft = imgHeight;
        let position = 0;

        pdf.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);
        heightLeft -= pageHeight;

        while (heightLeft >= 0) {
          position = heightLeft - imgHeight;
          pdf.addPage();
          pdf.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);
          heightLeft -= pageHeight;
        }

        pdf.save(`pace-analysis-${new Date().toISOString().slice(0, 10)}.pdf`);
      });
    }

    // ì´ˆê¸°í™”
    document.addEventListener('DOMContentLoaded', function() {
      // ê¸°ë³¸ê°’ ì„¤ì •
      document.getElementById('minutes').value = 25;
      document.getElementById('seconds').value = 0;
      
      // ì´ˆê¸° ê³„ì‚°
      calculatePace();
    });

    // Enter í‚¤ë¡œ ê³„ì‚°
    document.addEventListener('keypress', function(e) {
      if (e.key === 'Enter') {
        calculatePace();
      }
    });
  </script>
</body>
</html>