# 채팅 시스템 개선 사항 📬

## 📋 개선 요청 사항 및 해결

### 1. ✅ 자동 스크롤 문제 해결
**문제**: "새메세지가 오면 밑으로 자동으로 내려감 (위에 메시지를 읽고 싶어도 많은 새 메시지가 오면 읽을 수 없음)"

**해결책**:
- **자동 스크롤 토글 버튼** 추가 (헤더 우측)
- 버튼을 클릭하여 자동 스크롤 ON/OFF 가능
- OFF 상태에서는 새 메시지가 와도 현재 읽는 위치 유지
- **"맨 아래로" 버튼** - 스크롤 위치가 위쪽일 때 자동으로 나타남

### 2. ✅ 채팅방 메시지 분리
**문제**: "메인채팅방에 모든 톡방에서의 대화가 다 보여짐. 분리가 안되어 있음"

**해결책**:
- 3개의 **독립적인 채팅방** 구현:
  - 💬 **메인 채팅방** - 모든 러너들의 소통 공간
  - 🏃 **러닝 채팅방** - 러닝 정보와 팁 공유
  - 🎈 **자유 채팅방** - 자유로운 대화
- 각 방은 **완전히 독립된 메시지 저장소** 사용
- 방 전환 시 해당 방의 메시지만 표시
- **읽지 않은 메시지 배지** - 다른 방에 새 메시지가 오면 숫자로 표시

### 3. ✅ 챗봇 기능 도입
**문제**: "톡관리봇(?) 도입하면 좋을 거 같음"

**해결책**:
- **시스템 알림봇** 🤖
  - 사용자 입장/퇴장 알림
  - 시스템 메시지 표시
- **명령어 시스템**:
  - `/help` 또는 `/도움` - 사용 가능한 명령어 표시
  - `/clear` 또는 `/청소` - 채팅창 청소
  - `/nick [닉네임]` - 닉네임 변경
  - `/users` 또는 `/유저` - 현재 접속자 수 확인

### 4. ✅ 뒤로가기 버튼 추가
**문제**: "뒤로가기 버튼이 있으면 더 편리할 것 같음"

**해결책**:
- 좌측 채팅방 목록 상단에 **"메인으로 돌아가기"** 버튼 추가
- 클릭 시 index.html로 이동
- 모바일에서도 햄버거 메뉴 통해 접근 가능

## 🎯 추가 개선 사항

### UI/UX 개선
- **반응형 디자인** - 모바일/태블릿/데스크톱 최적화
- **부드러운 애니메이션** - 메시지 진입 효과
- **시각적 구분** - 시스템/봇/일반 메시지 다른 스타일
- **시간 표시** - 각 메시지에 시간 표시

### 기능 개선
- **자동 재연결** - 연결 끊김 시 3초 후 자동 재연결
- **메시지 영구 저장** - 서버 재시작해도 메시지 유지
- **닉네임 저장** - 브라우저에 닉네임 자동 저장
- **메시지 제한** - 방당 최대 500개 메시지 (성능 최적화)

## 🚀 사용 방법

### 채팅방 이동
1. 좌측 채팅방 목록에서 원하는 방 클릭
2. 모바일: 햄버거 메뉴(☰) 클릭 → 채팅방 선택

### 자동 스크롤 제어
1. 헤더의 "자동 스크롤" 버튼 클릭
2. 회색 = OFF (수동 스크롤)
3. 파란색 = ON (자동 스크롤)

### 명령어 사용
1. 메시지 입력창에 `/help` 입력
2. 사용 가능한 명령어 목록 확인
3. 원하는 명령어 입력

### 닉네임 변경
1. 입력창 왼쪽 닉네임 필드 수정
2. 또는 `/nick 새닉네임` 명령어 사용

## 📱 모바일 사용 팁

- **채팅방 목록**: 햄버거 메뉴로 열기/닫기
- **자동 스크롤 OFF**: 과거 메시지 읽을 때
- **맨 아래로 버튼**: 빠르게 최신 메시지로 이동
- **스와이프**: 채팅방 목록 열기 (지원 예정)

## 🔧 기술 스펙

### Backend (server.js v2.0)
- **WebSocket**: 실시간 양방향 통신
- **Room Isolation**: 방별 독립 메시지 배열
- **Message Persistence**: JSON 파일 저장
- **Auto-save**: 5분마다 자동 저장

### Frontend (chat.html)
- **Vanilla JavaScript**: 프레임워크 없이 순수 JS
- **Tailwind CSS**: 유틸리티 기반 스타일링
- **Local Storage**: 닉네임 저장
- **WebSocket Reconnection**: 자동 재연결

## 🐛 알려진 이슈 및 해결 방법

### 연결이 자주 끊김
- Render 무료 플랜의 제한
- 자동 재연결 기능으로 보완

### 첫 메시지 전송 지연
- 서버 콜드 스타트 (최대 30초)
- Render Starter 플랜 업그레이드로 해결 가능

## 📝 향후 개선 계획

- [ ] 이미지 전송 기능
- [ ] 이모티콘/이모지 선택기
- [ ] 메시지 검색 기능
- [ ] 사용자 프로필 사진
- [ ] 메시지 수정/삭제
- [ ] 답글 기능
- [ ] 메시지 알림음
- [ ] 다크/라이트 테마 전환

## 💬 피드백

추가 개선 사항이나 버그 리포트는 언제든 환영합니다!
- Instagram: @athletic_time
- GitHub Issues: https://github.com/hojune0330/athletetime/issues