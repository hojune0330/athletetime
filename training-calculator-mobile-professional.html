<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>전문 훈련 계산기 - 모바일 | Athlete Time</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
  
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Malgun Gothic', '맑은 고딕', sans-serif;
      touch-action: manipulation;
      -webkit-tap-highlight-color: transparent;
    }
    
    .gradient-bg {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    }
    
    .training-zone-easy { background: linear-gradient(135deg, #10b981, #059669); }
    .training-zone-marathon { background: linear-gradient(135deg, #3b82f6, #2563eb); }
    .training-zone-threshold { background: linear-gradient(135deg, #f59e0b, #d97706); }
    .training-zone-interval { background: linear-gradient(135deg, #ef4444, #dc2626); }
    .training-zone-repetition { background: linear-gradient(135deg, #a855f7, #9333ea); }
    
    .intensity-low { 
      border-left: 4px solid #10b981; 
      background: linear-gradient(to right, rgba(16, 185, 129, 0.1), transparent);
    }
    .intensity-medium { 
      border-left: 4px solid #3b82f6; 
      background: linear-gradient(to right, rgba(59, 130, 246, 0.1), transparent);
    }
    .intensity-high { 
      border-left: 4px solid #ef4444; 
      background: linear-gradient(to right, rgba(239, 68, 68, 0.1), transparent);
    }
    .intensity-rest { 
      border-left: 4px solid #6b7280; 
      background: linear-gradient(to right, rgba(107, 114, 128, 0.1), transparent);
    }
    
    input[type="number"], select {
      font-size: 16px !important; /* Prevent iOS zoom */
    }
    
    .step-indicator {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 0 20%;
    }
    
    .step-dot {
      width: 12px;
      height: 12px;
      border-radius: 50%;
      background: #e5e7eb;
      transition: all 0.3s;
    }
    
    .step-dot.active {
      background: #9333ea;
      transform: scale(1.3);
    }
    
    .step-line {
      flex: 1;
      height: 2px;
      background: #e5e7eb;
      margin: 0 8px;
    }
    
    .step-line.active {
      background: #9333ea;
    }
    
    .scroll-container {
      scroll-snap-type: x mandatory;
      -webkit-overflow-scrolling: touch;
    }
    
    .scroll-item {
      scroll-snap-align: start;
    }
  </style>
</head>
<body class="bg-gray-50">
  <!-- Header -->
  <div class="gradient-bg text-white p-4 sticky top-0 z-50">
    <div class="flex items-center justify-between">
      <div>
        <h1 class="text-lg font-bold">전문 훈련 계산기</h1>
        <p class="text-xs opacity-90">Jack Daniels VDOT 기반</p>
      </div>
      <button onclick="window.location.href='index.html'" class="p-2">
        <i class="fas fa-home text-xl"></i>
      </button>
    </div>
  </div>

  <!-- Step Indicator -->
  <div class="bg-white px-4 py-3 shadow-sm">
    <div class="step-indicator">
      <div class="step-dot active" id="step1-dot"></div>
      <div class="step-line" id="step1-line"></div>
      <div class="step-dot" id="step2-dot"></div>
      <div class="step-line" id="step2-line"></div>
      <div class="step-dot" id="step3-dot"></div>
    </div>
    <div class="flex justify-between text-xs text-gray-600 mt-2 px-4">
      <span>프로필</span>
      <span>기록입력</span>
      <span>조건설정</span>
    </div>
  </div>

  <div class="p-4 pb-20">
    <!-- Step 1: Profile -->
    <div id="step1" class="step-content">
      <div class="bg-white rounded-lg shadow-md p-4 mb-4">
        <h2 class="font-bold text-lg mb-4">
          <i class="fas fa-user-circle mr-2 text-purple-600"></i>
          선수 프로필
        </h2>
        
        <!-- Gender -->
        <div class="mb-4">
          <label class="block text-sm font-medium mb-2">성별</label>
          <div class="grid grid-cols-2 gap-2">
            <button onclick="selectGender('male')" id="male-btn"
              class="p-3 border-2 rounded-lg text-center transition">
              <i class="fas fa-mars text-blue-500 text-xl"></i>
              <div class="text-sm mt-1">남성</div>
            </button>
            <button onclick="selectGender('female')" id="female-btn"
              class="p-3 border-2 rounded-lg text-center transition">
              <i class="fas fa-venus text-pink-500 text-xl"></i>
              <div class="text-sm mt-1">여성</div>
            </button>
          </div>
        </div>

        <!-- Age Group -->
        <div class="mb-4">
          <label class="block text-sm font-medium mb-2">연령대</label>
          <select id="ageGroup" class="w-full p-3 border rounded-lg">
            <option value="junior">주니어 (18세 이하)</option>
            <option value="senior" selected>시니어 (19-39세)</option>
            <option value="master40">마스터즈 40+</option>
            <option value="master50">마스터즈 50+</option>
            <option value="master60">마스터즈 60+</option>
          </select>
        </div>

        <!-- Experience -->
        <div class="mb-4">
          <label class="block text-sm font-medium mb-2">훈련 경력</label>
          <select id="experience" class="w-full p-3 border rounded-lg">
            <option value="beginner">초급 (1년 미만)</option>
            <option value="intermediate" selected>중급 (1-3년)</option>
            <option value="advanced">고급 (3-5년)</option>
            <option value="elite">엘리트 (5년+)</option>
          </select>
        </div>

        <!-- Weekly Volume -->
        <div class="mb-4">
          <label class="block text-sm font-medium mb-2">주간 훈련량</label>
          <select id="weeklyVolume" class="w-full p-3 border rounded-lg">
            <option value="low">30km 이하</option>
            <option value="moderate" selected>30-60km</option>
            <option value="high">60-100km</option>
            <option value="very-high">100km+</option>
          </select>
        </div>

        <!-- Training Frequency -->
        <div class="mb-4">
          <label class="block text-sm font-medium mb-2">훈련 빈도</label>
          <select id="frequency" class="w-full p-3 border rounded-lg">
            <option value="3-4">주 3-4회</option>
            <option value="5-6" selected>주 5-6회</option>
            <option value="7">주 7회</option>
            <option value="double">2회/일</option>
          </select>
        </div>

        <!-- Training Phase -->
        <div class="mb-4">
          <label class="block text-sm font-medium mb-2">현재 훈련 단계</label>
          <select id="trainingPhase" class="w-full p-3 border rounded-lg">
            <option value="base">기초 체력기</option>
            <option value="build" selected>전문 체력기</option>
            <option value="peak">피킹 단계</option>
            <option value="taper">테이퍼링</option>
            <option value="recovery">회복기</option>
          </select>
        </div>

        <button onclick="goToStep2()" 
          class="w-full bg-purple-600 text-white py-3 rounded-lg font-medium">
          다음 단계 <i class="fas fa-arrow-right ml-2"></i>
        </button>
      </div>
    </div>

    <!-- Step 2: Performance Input -->
    <div id="step2" class="step-content hidden">
      <div class="bg-white rounded-lg shadow-md p-4 mb-4">
        <h2 class="font-bold text-lg mb-4">
          <i class="fas fa-stopwatch mr-2 text-purple-600"></i>
          기준 기록 입력
        </h2>

        <div class="mb-4">
          <label class="block text-sm font-medium mb-2">종목 선택</label>
          <select id="eventDistance" class="w-full p-3 border rounded-lg">
            <option value="">종목을 선택하세요</option>
            <option value="800">800m</option>
            <option value="1500">1500m</option>
            <option value="3000">3000m (3km)</option>
            <option value="5000">5000m (5km)</option>
            <option value="10000">10000m (10km)</option>
            <option value="21097.5">하프마라톤</option>
            <option value="42195">풀마라톤</option>
          </select>
        </div>

        <div class="mb-4">
          <label class="block text-sm font-medium mb-2">기록 입력</label>
          <div class="grid grid-cols-3 gap-2">
            <input type="number" id="hours" placeholder="시" min="0" max="23"
              class="p-3 border rounded-lg text-center">
            <input type="number" id="minutes" placeholder="분" min="0" max="59"
              class="p-3 border rounded-lg text-center">
            <input type="number" id="seconds" placeholder="초" min="0" max="59" step="0.1"
              class="p-3 border rounded-lg text-center">
          </div>
        </div>

        <div class="flex gap-2">
          <button onclick="goToStep1()" 
            class="flex-1 bg-gray-200 text-gray-700 py-3 rounded-lg font-medium">
            <i class="fas fa-arrow-left mr-2"></i> 이전
          </button>
          <button onclick="goToStep3()" 
            class="flex-1 bg-purple-600 text-white py-3 rounded-lg font-medium">
            다음 <i class="fas fa-arrow-right ml-2"></i>
          </button>
        </div>
      </div>
    </div>

    <!-- Step 3: Conditions -->
    <div id="step3" class="step-content hidden">
      <div class="bg-white rounded-lg shadow-md p-4 mb-4">
        <h2 class="font-bold text-lg mb-4">
          <i class="fas fa-clipboard-check mr-2 text-purple-600"></i>
          특별 고려사항
        </h2>

        <div class="space-y-2 mb-4">
          <label class="flex items-center p-3 bg-gray-50 rounded-lg">
            <input type="checkbox" id="injury_recovery" class="mr-3 w-5 h-5">
            <div>
              <div class="font-medium">부상 회복중</div>
              <div class="text-xs text-gray-600">강도 40% 감소</div>
            </div>
          </label>

          <label class="flex items-center p-3 bg-gray-50 rounded-lg">
            <input type="checkbox" id="high_fatigue" class="mr-3 w-5 h-5">
            <div>
              <div class="font-medium">피로 누적</div>
              <div class="text-xs text-gray-600">회복 위주</div>
            </div>
          </label>

          <label class="flex items-center p-3 bg-gray-50 rounded-lg">
            <input type="checkbox" id="altitude" class="mr-3 w-5 h-5">
            <div>
              <div class="font-medium">고지대 훈련</div>
              <div class="text-xs text-gray-600">강도 조절</div>
            </div>
          </label>

          <label class="flex items-center p-3 bg-gray-50 rounded-lg">
            <input type="checkbox" id="hot_weather" class="mr-3 w-5 h-5">
            <div>
              <div class="font-medium">고온다습</div>
              <div class="text-xs text-gray-600">페이스 조절</div>
            </div>
          </label>

          <label class="flex items-center p-3 bg-gray-50 rounded-lg">
            <input type="checkbox" id="weight_loss" class="mr-3 w-5 h-5">
            <div>
              <div class="font-medium">체중 감량</div>
              <div class="text-xs text-gray-600">유산소 증가</div>
            </div>
          </label>

          <label class="flex items-center p-3 bg-gray-50 rounded-lg">
            <input type="checkbox" id="morning_only" class="mr-3 w-5 h-5">
            <div>
              <div class="font-medium">아침 훈련</div>
              <div class="text-xs text-gray-600">워밍업 증가</div>
            </div>
          </label>
        </div>

        <div class="flex gap-2">
          <button onclick="goToStep2()" 
            class="flex-1 bg-gray-200 text-gray-700 py-3 rounded-lg font-medium">
            <i class="fas fa-arrow-left mr-2"></i> 이전
          </button>
          <button onclick="calculateTraining()" 
            class="flex-1 bg-gradient-to-r from-purple-600 to-pink-600 text-white py-3 rounded-lg font-medium">
            <i class="fas fa-calculator mr-2"></i> 계산
          </button>
        </div>
      </div>
    </div>

    <!-- Results -->
    <div id="results" class="hidden">
      <!-- VDOT Score Card -->
      <div class="bg-gradient-to-r from-purple-600 to-pink-600 text-white rounded-lg p-4 mb-4">
        <div class="text-center">
          <div class="text-4xl font-bold" id="vdotScore">--</div>
          <div class="text-sm opacity-90">VDOT 점수</div>
          <div class="text-xs opacity-75 mt-1" id="vdotAdjustment"></div>
        </div>
        <div class="grid grid-cols-2 gap-4 mt-4">
          <div class="text-center">
            <div class="text-xl font-semibold" id="performanceLevel">--</div>
            <div class="text-xs opacity-90">수준</div>
          </div>
          <div class="text-center">
            <div class="text-xl" id="vo2max">--</div>
            <div class="text-xs opacity-90">VO₂max</div>
          </div>
        </div>
      </div>

      <!-- Training Zones -->
      <div class="bg-white rounded-lg shadow-md p-4 mb-4">
        <h3 class="font-bold text-lg mb-3">훈련 구역 페이스</h3>
        
        <div class="space-y-2">
          <div class="training-zone-easy text-white p-3 rounded-lg">
            <div class="flex justify-between items-center">
              <div>
                <div class="font-bold">Easy (E)</div>
                <div class="text-xs opacity-90">회복/기초</div>
              </div>
              <div class="text-lg font-bold" id="easyPace">--</div>
            </div>
          </div>

          <div class="training-zone-marathon text-white p-3 rounded-lg">
            <div class="flex justify-between items-center">
              <div>
                <div class="font-bold">Marathon (M)</div>
                <div class="text-xs opacity-90">마라톤</div>
              </div>
              <div class="text-lg font-bold" id="marathonPace">--</div>
            </div>
          </div>

          <div class="training-zone-threshold text-white p-3 rounded-lg">
            <div class="flex justify-between items-center">
              <div>
                <div class="font-bold">Threshold (T)</div>
                <div class="text-xs opacity-90">젖산역치</div>
              </div>
              <div class="text-lg font-bold" id="thresholdPace">--</div>
            </div>
          </div>

          <div class="training-zone-interval text-white p-3 rounded-lg">
            <div class="flex justify-between items-center">
              <div>
                <div class="font-bold">Interval (I)</div>
                <div class="text-xs opacity-90">VO₂max</div>
              </div>
              <div class="text-lg font-bold" id="intervalPace">--</div>
            </div>
          </div>

          <div class="training-zone-repetition text-white p-3 rounded-lg">
            <div class="flex justify-between items-center">
              <div>
                <div class="font-bold">Repetition (R)</div>
                <div class="text-xs opacity-90">스피드</div>
              </div>
              <div class="text-lg font-bold" id="repetitionPace">--</div>
            </div>
          </div>
        </div>
      </div>

      <!-- Weekly Plan -->
      <div class="bg-white rounded-lg shadow-md p-4 mb-4">
        <h3 class="font-bold text-lg mb-3">주간 훈련 계획</h3>
        <div class="overflow-x-auto">
          <div id="weeklyPlan" class="flex gap-2 scroll-container pb-2">
            <!-- Weekly plan cards -->
          </div>
        </div>
      </div>

      <!-- Key Workouts -->
      <div class="bg-white rounded-lg shadow-md p-4 mb-4">
        <h3 class="font-bold text-lg mb-3">핵심 훈련</h3>
        <div id="keyWorkouts" class="space-y-3">
          <!-- Key workout cards -->
        </div>
      </div>

      <!-- Recommendations -->
      <div class="bg-white rounded-lg shadow-md p-4 mb-4">
        <h3 class="font-bold text-lg mb-3">
          <i class="fas fa-lightbulb mr-2 text-yellow-500"></i>
          전문가 권장사항
        </h3>
        <div id="recommendations" class="space-y-3">
          <!-- Recommendation cards -->
        </div>
      </div>

      <button onclick="resetCalculator()" 
        class="w-full bg-gray-200 text-gray-700 py-3 rounded-lg font-medium">
        <i class="fas fa-redo mr-2"></i> 다시 계산
      </button>
    </div>
  </div>

  <!-- Footer -->
  <div class="fixed bottom-0 left-0 right-0 bg-white border-t px-4 py-2">
    <div class="text-center text-xs text-gray-600">
      <div>제작자: 장호준 코치</div>
      <div class="text-gray-400">© 2024 Athlete Time</div>
    </div>
  </div>

  <script>
    // User profile
    let userProfile = {
      gender: null,
      ageGroup: null,
      experience: null,
      weeklyVolume: null,
      frequency: null,
      trainingPhase: null,
      conditions: {},
      vdot: 0,
      adjustments: {
        pace: 1.0,
        volume: 1.0,
        intensity: 1.0
      }
    };

    // VDOT reference tables (Jack Daniels)
    const vdotTables = {
      30: { 800: 316, 1500: 681, 3000: 1520, 5000: 2680, 10000: 5560, 21097.5: 12240, 42195: 25380 },
      35: { 800: 279, 1500: 598, 3000: 1330, 5000: 2340, 10000: 4860, 21097.5: 10680, 42195: 22140 },
      40: { 800: 249, 1500: 532, 3000: 1178, 5000: 2070, 10000: 4290, 21097.5: 9420, 42195: 19500 },
      45: { 800: 224, 1500: 477, 3000: 1053, 5000: 1845, 10000: 3825, 21097.5: 8400, 42195: 17400 },
      50: { 800: 203, 1500: 431, 3000: 948, 5000: 1658, 10000: 3435, 21097.5: 7530, 42195: 15600 },
      55: { 800: 185, 1500: 392, 3000: 859, 5000: 1500, 10000: 3105, 21097.5: 6810, 42195: 14100 },
      60: { 800: 169, 1500: 357, 3000: 781, 5000: 1362, 10000: 2820, 21097.5: 6180, 42195: 12780 },
      65: { 800: 155, 1500: 327, 3000: 713, 5000: 1242, 10000: 2565, 21097.5: 5625, 42195: 11625 },
      70: { 800: 143, 1500: 301, 3000: 654, 5000: 1137, 10000: 2346, 21097.5: 5145, 42195: 10620 },
      75: { 800: 132, 1500: 277, 3000: 601, 5000: 1044, 10000: 2154, 21097.5: 4725, 42195: 9750 },
      80: { 800: 122, 1500: 256, 3000: 554, 5000: 961, 10000: 1983, 21097.5: 4350, 42195: 8970 }
    };

    // Navigation
    function goToStep1() {
      showStep(1);
    }

    function goToStep2() {
      if (!validateStep1()) {
        alert('모든 프로필 정보를 입력해주세요.');
        return;
      }
      showStep(2);
    }

    function goToStep3() {
      if (!validateStep2()) {
        alert('종목과 기록을 입력해주세요.');
        return;
      }
      showStep(3);
    }

    function showStep(step) {
      // Hide all steps
      document.querySelectorAll('.step-content').forEach(s => s.classList.add('hidden'));
      
      // Show selected step
      document.getElementById(`step${step}`).classList.remove('hidden');
      
      // Update indicator
      updateStepIndicator(step);
    }

    function updateStepIndicator(step) {
      // Reset all
      document.querySelectorAll('.step-dot').forEach(dot => dot.classList.remove('active'));
      document.querySelectorAll('.step-line').forEach(line => line.classList.remove('active'));
      
      // Activate up to current step
      for (let i = 1; i <= step; i++) {
        document.getElementById(`step${i}-dot`).classList.add('active');
        if (i < step) {
          document.getElementById(`step${i}-line`).classList.add('active');
        }
      }
    }

    function validateStep1() {
      return userProfile.gender !== null;
    }

    function validateStep2() {
      const distance = document.getElementById('eventDistance').value;
      const hours = parseInt(document.getElementById('hours').value) || 0;
      const minutes = parseInt(document.getElementById('minutes').value) || 0;
      const seconds = parseFloat(document.getElementById('seconds').value) || 0;
      
      return distance && (hours > 0 || minutes > 0 || seconds > 0);
    }

    function selectGender(gender) {
      userProfile.gender = gender;
      
      // Update UI
      document.getElementById('male-btn').classList.remove('border-purple-500', 'bg-purple-50');
      document.getElementById('female-btn').classList.remove('border-purple-500', 'bg-purple-50');
      
      if (gender === 'male') {
        document.getElementById('male-btn').classList.add('border-purple-500', 'bg-purple-50');
      } else {
        document.getElementById('female-btn').classList.add('border-purple-500', 'bg-purple-50');
      }
    }

    function calculateVDOT(distanceMeters, timeSeconds) {
      let closestVDOT = 30;
      let minDiff = Infinity;
      
      // Find closest VDOT
      for (const [vdot, times] of Object.entries(vdotTables)) {
        if (times[distanceMeters]) {
          const diff = Math.abs(times[distanceMeters] - timeSeconds);
          if (diff < minDiff) {
            minDiff = diff;
            closestVDOT = parseInt(vdot);
          }
        }
      }
      
      return closestVDOT;
    }

    function calculateTrainingPaces(vdot) {
      // Jack Daniels formula
      const paces = {
        easy: {
          min: Math.round((180 / vdot) * 195),
          max: Math.round((180 / vdot) * 175)
        },
        marathon: Math.round((180 / vdot) * 165),
        threshold: Math.round((180 / vdot) * 155),
        interval: Math.round((180 / vdot) * 140),
        repetition: Math.round((180 / vdot) * 125)
      };
      
      // Apply adjustments
      const adj = userProfile.adjustments.pace;
      Object.keys(paces).forEach(key => {
        if (key === 'easy') {
          paces.easy.min = Math.round(paces.easy.min * adj);
          paces.easy.max = Math.round(paces.easy.max * adj);
        } else {
          paces[key] = Math.round(paces[key] * adj);
        }
      });
      
      return paces;
    }

    function formatPace(secondsPerKm) {
      const minutes = Math.floor(secondsPerKm / 60);
      const seconds = Math.floor(secondsPerKm % 60);
      return `${minutes}:${seconds.toString().padStart(2, '0')}`;
    }

    function calculateAdjustments() {
      // Reset
      userProfile.adjustments = {
        pace: 1.0,
        volume: 1.0,
        intensity: 1.0
      };
      
      // Gender
      if (userProfile.gender === 'female') {
        userProfile.adjustments.pace *= 1.05;
      }
      
      // Age
      const age = userProfile.ageGroup;
      if (age === 'master40') {
        userProfile.adjustments.pace *= 1.02;
        userProfile.adjustments.volume *= 0.95;
      } else if (age === 'master50') {
        userProfile.adjustments.pace *= 1.05;
        userProfile.adjustments.volume *= 0.9;
      } else if (age === 'master60') {
        userProfile.adjustments.pace *= 1.08;
        userProfile.adjustments.volume *= 0.85;
      }
      
      // Experience
      const exp = userProfile.experience;
      if (exp === 'beginner') {
        userProfile.adjustments.volume *= 0.7;
        userProfile.adjustments.intensity *= 0.8;
      } else if (exp === 'elite') {
        userProfile.adjustments.volume *= 1.2;
        userProfile.adjustments.intensity *= 1.1;
      }
      
      // Conditions
      if (document.getElementById('injury_recovery').checked) {
        userProfile.adjustments.volume *= 0.6;
        userProfile.adjustments.intensity *= 0.7;
        userProfile.adjustments.pace *= 1.1;
      }
      
      if (document.getElementById('high_fatigue').checked) {
        userProfile.adjustments.volume *= 0.8;
        userProfile.adjustments.intensity *= 0.85;
      }
      
      if (document.getElementById('hot_weather').checked) {
        userProfile.adjustments.pace *= 1.05;
      }
    }

    function generateWeeklyPlan() {
      const weeklyPlan = document.getElementById('weeklyPlan');
      const freq = userProfile.frequency;
      
      let days = [];
      
      if (freq === '3-4') {
        days = [
          { day: '월', type: 'Easy', intensity: 'intensity-low', desc: '40분' },
          { day: '화', type: '휴식', intensity: 'intensity-rest', desc: '-' },
          { day: '수', type: 'Interval', intensity: 'intensity-high', desc: '45분' },
          { day: '목', type: '휴식', intensity: 'intensity-rest', desc: '-' },
          { day: '금', type: 'Tempo', intensity: 'intensity-medium', desc: '35분' },
          { day: '토', type: '휴식', intensity: 'intensity-rest', desc: '-' },
          { day: '일', type: 'Long', intensity: 'intensity-low', desc: '70분' }
        ];
      } else if (freq === '5-6') {
        days = [
          { day: '월', type: 'Easy', intensity: 'intensity-low', desc: '50분' },
          { day: '화', type: 'Interval', intensity: 'intensity-high', desc: '50분' },
          { day: '수', type: 'Easy', intensity: 'intensity-low', desc: '40분' },
          { day: '목', type: 'Tempo', intensity: 'intensity-medium', desc: '45분' },
          { day: '금', type: '휴식', intensity: 'intensity-rest', desc: '-' },
          { day: '토', type: 'M pace', intensity: 'intensity-medium', desc: '40분' },
          { day: '일', type: 'Long', intensity: 'intensity-low', desc: '90분' }
        ];
      } else {
        days = [
          { day: '월', type: 'Easy+', intensity: 'intensity-low', desc: '60분' },
          { day: '화', type: 'Interval', intensity: 'intensity-high', desc: '60분' },
          { day: '수', type: 'Recovery', intensity: 'intensity-low', desc: '40분' },
          { day: '목', type: 'Threshold', intensity: 'intensity-medium', desc: '50분' },
          { day: '금', type: 'Easy', intensity: 'intensity-low', desc: '45분' },
          { day: '토', type: 'Rep', intensity: 'intensity-high', desc: '45분' },
          { day: '일', type: 'Long', intensity: 'intensity-low', desc: '120분' }
        ];
      }
      
      weeklyPlan.innerHTML = days.map(d => `
        <div class="${d.intensity} p-3 rounded-lg min-w-[100px] scroll-item">
          <div class="font-bold text-center">${d.day}</div>
          <div class="text-sm text-center mt-1">${d.type}</div>
          <div class="text-xs text-center text-gray-600 mt-1">${d.desc}</div>
        </div>
      `).join('');
    }

    function generateKeyWorkouts(paces) {
      const keyWorkouts = document.getElementById('keyWorkouts');
      const exp = userProfile.experience;
      
      const workouts = [
        {
          title: 'VO₂max 인터벌',
          detail: exp === 'beginner' ? '800m x 4' : exp === 'intermediate' ? '1000m x 5' : '1200m x 5',
          pace: `I 페이스: ${formatPace(paces.interval)}/km`,
          rest: '조깅 2-3분'
        },
        {
          title: '젖산역치',
          detail: exp === 'beginner' ? '20분 연속' : exp === 'intermediate' ? '2 x 15분' : '30분 연속',
          pace: `T 페이스: ${formatPace(paces.threshold)}/km`,
          rest: '세트간 1분'
        },
        {
          title: '장거리',
          detail: exp === 'beginner' ? '60-75분' : exp === 'intermediate' ? '90-105분' : '120-150분',
          pace: `E 페이스: ${formatPace(paces.easy.max)}-${formatPace(paces.easy.min)}/km`,
          rest: '-'
        }
      ];
      
      keyWorkouts.innerHTML = workouts.map(w => `
        <div class="border-l-4 border-purple-500 pl-3">
          <div class="font-semibold">${w.title}</div>
          <div class="text-sm text-gray-600">${w.detail}</div>
          <div class="text-sm text-purple-600 font-medium mt-1">${w.pace}</div>
          ${w.rest !== '-' ? `<div class="text-xs text-gray-500">휴식: ${w.rest}</div>` : ''}
        </div>
      `).join('');
    }

    function generateRecommendations() {
      const recommendations = document.getElementById('recommendations');
      const recs = [];
      
      if (userProfile.gender === 'female') {
        recs.push({
          icon: 'fas fa-venus',
          title: '여성 러너',
          items: ['철분 보충 필수', '월경 주기 고려', '칼슘/비타민D 섭취']
        });
      }
      
      if (userProfile.ageGroup.includes('master')) {
        recs.push({
          icon: 'fas fa-user-clock',
          title: '마스터즈',
          items: ['회복 시간 1.5배', '근력 운동 주 2회', '충분한 워밍업']
        });
      }
      
      if (document.getElementById('injury_recovery').checked) {
        recs.push({
          icon: 'fas fa-band-aid',
          title: '부상 회복',
          items: ['통증시 즉시 중단', '크로스트레이닝', '점진적 증가']
        });
      }
      
      // Always add nutrition
      recs.push({
        icon: 'fas fa-apple-alt',
        title: '영양 섭취',
        items: ['훈련 후 30분내 보충', '탄:단 = 3:1', '충분한 수분']
      });
      
      recommendations.innerHTML = recs.map(r => `
        <div class="bg-gray-50 rounded-lg p-3">
          <div class="font-semibold mb-2">
            <i class="${r.icon} mr-2 text-purple-600"></i>${r.title}
          </div>
          <ul class="text-sm text-gray-600 space-y-1">
            ${r.items.map(item => `<li>• ${item}</li>`).join('')}
          </ul>
        </div>
      `).join('');
    }

    function calculateTraining() {
      // Update profile
      userProfile.ageGroup = document.getElementById('ageGroup').value;
      userProfile.experience = document.getElementById('experience').value;
      userProfile.weeklyVolume = document.getElementById('weeklyVolume').value;
      userProfile.frequency = document.getElementById('frequency').value;
      userProfile.trainingPhase = document.getElementById('trainingPhase').value;
      
      // Get performance data
      const distance = parseFloat(document.getElementById('eventDistance').value);
      const hours = parseInt(document.getElementById('hours').value) || 0;
      const minutes = parseInt(document.getElementById('minutes').value) || 0;
      const seconds = parseFloat(document.getElementById('seconds').value) || 0;
      
      const totalSeconds = hours * 3600 + minutes * 60 + seconds;
      
      // Calculate adjustments
      calculateAdjustments();
      
      // Calculate VDOT
      let vdot = calculateVDOT(distance, totalSeconds);
      const displayVDOT = userProfile.gender === 'female' ? vdot * 0.88 : vdot;
      
      // Display VDOT
      document.getElementById('vdotScore').textContent = displayVDOT.toFixed(1);
      document.getElementById('performanceLevel').textContent = 
        displayVDOT >= 65 ? '엘리트' :
        displayVDOT >= 55 ? '상급' :
        displayVDOT >= 45 ? '중급' :
        displayVDOT >= 35 ? '초급' : '입문';
      document.getElementById('vo2max').textContent = (displayVDOT * 1.05).toFixed(1) + ' ml/kg/min';
      
      if (userProfile.gender === 'female') {
        document.getElementById('vdotAdjustment').textContent = '여성 보정 적용';
      }
      
      // Calculate paces
      const paces = calculateTrainingPaces(vdot);
      
      // Display paces
      document.getElementById('easyPace').textContent = 
        `${formatPace(paces.easy.max)}-${formatPace(paces.easy.min)}`;
      document.getElementById('marathonPace').textContent = formatPace(paces.marathon);
      document.getElementById('thresholdPace').textContent = formatPace(paces.threshold);
      document.getElementById('intervalPace').textContent = formatPace(paces.interval);
      document.getElementById('repetitionPace').textContent = formatPace(paces.repetition);
      
      // Generate plans
      generateWeeklyPlan();
      generateKeyWorkouts(paces);
      generateRecommendations();
      
      // Show results
      document.getElementById('step3').classList.add('hidden');
      document.getElementById('results').classList.remove('hidden');
      
      // Scroll to top
      window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    function resetCalculator() {
      // Reset profile
      userProfile = {
        gender: null,
        ageGroup: null,
        experience: null,
        weeklyVolume: null,
        frequency: null,
        trainingPhase: null,
        conditions: {},
        vdot: 0,
        adjustments: {
          pace: 1.0,
          volume: 1.0,
          intensity: 1.0
        }
      };
      
      // Reset UI
      document.querySelectorAll('button[id$="-btn"]').forEach(btn => {
        btn.classList.remove('border-purple-500', 'bg-purple-50');
      });
      
      document.getElementById('eventDistance').value = '';
      document.getElementById('hours').value = '';
      document.getElementById('minutes').value = '';
      document.getElementById('seconds').value = '';
      
      document.querySelectorAll('input[type="checkbox"]').forEach(cb => {
        cb.checked = false;
      });
      
      // Show step 1
      document.getElementById('results').classList.add('hidden');
      showStep(1);
    }
  </script>
</body>
</html>