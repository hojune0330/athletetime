<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>ëŸ¬ë‹í†¡ - ì‹¤ì‹œê°„ ì±„íŒ… | ì• ìŠ¬ë¦¬íŠ¸ íƒ€ì„</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      -webkit-tap-highlight-color: transparent;
    }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Malgun Gothic', sans-serif;
      background: #0a0a0a;
      color: #ffffff;
      height: 100vh;
      overflow: hidden;
    }
    
    /* ë ˆì´ì•„ì›ƒ */
    .chat-container {
      display: flex;
      height: 100vh;
    }
    
    /* ì‚¬ì´ë“œë°” */
    .sidebar {
      width: 280px;
      background: #111111;
      border-right: 1px solid rgba(255, 255, 255, 0.1);
      display: flex;
      flex-direction: column;
    }
    
    .sidebar-header {
      padding: 20px;
      background: linear-gradient(135deg, #667eea, #764ba2);
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    
    .logo {
      font-size: 1.2rem;
      font-weight: bold;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .home-button {
      padding: 8px 16px;
      background: rgba(255, 255, 255, 0.2);
      border-radius: 8px;
      font-size: 0.85rem;
      cursor: pointer;
      transition: all 0.3s;
      text-decoration: none;
      color: white;
    }
    
    .home-button:hover {
      background: rgba(255, 255, 255, 0.3);
    }
    
    /* í”„ë¡œí•„ ì„¹ì…˜ */
    .profile-section {
      padding: 15px;
      background: rgba(255, 255, 255, 0.02);
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }
    
    .profile-info {
      display: flex;
      align-items: center;
      gap: 12px;
      cursor: pointer;
      padding: 10px;
      border-radius: 8px;
      transition: background 0.3s;
    }
    
    .profile-info:hover {
      background: rgba(255, 255, 255, 0.05);
    }
    
    .avatar {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background: linear-gradient(135deg, #667eea, #ec4899);
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      font-size: 1.2rem;
    }
    
    .username {
      flex: 1;
    }
    
    .username-main {
      font-weight: 600;
      font-size: 0.95rem;
    }
    
    .username-status {
      font-size: 0.75rem;
      color: #10b981;
      display: flex;
      align-items: center;
      gap: 4px;
      margin-top: 2px;
    }
    
    /* í†µê³„ ì„¹ì…˜ */
    .stats-section {
      padding: 15px;
      background: rgba(102, 126, 234, 0.05);
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }
    
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 10px;
    }
    
    .stat-item {
      text-align: center;
    }
    
    .stat-value {
      font-size: 1.2rem;
      font-weight: bold;
      color: #667eea;
    }
    
    .stat-label {
      font-size: 0.7rem;
      color: #999;
      margin-top: 2px;
    }
    
    /* ì±„íŒ…ë°© ë¦¬ìŠ¤íŠ¸ */
    .room-list {
      flex: 1;
      overflow-y: auto;
      padding: 10px;
    }
    
    .room-section-title {
      font-size: 0.75rem;
      color: #666;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      padding: 10px 10px 5px;
      font-weight: 600;
    }
    
    .room-item {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 12px;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.3s;
      margin-bottom: 4px;
      position: relative;
    }
    
    .room-item:hover {
      background: rgba(255, 255, 255, 0.05);
    }
    
    .room-item.active {
      background: rgba(102, 126, 234, 0.15);
      border-left: 3px solid #667eea;
    }
    
    .room-icon {
      width: 36px;
      height: 36px;
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.2rem;
      background: linear-gradient(135deg, #667eea, #764ba2);
    }
    
    .room-info {
      flex: 1;
    }
    
    .room-name {
      font-weight: 600;
      font-size: 0.9rem;
      margin-bottom: 2px;
    }
    
    .room-meta {
      display: flex;
      align-items: center;
      gap: 10px;
      font-size: 0.75rem;
      color: #999;
    }
    
    .room-users {
      display: flex;
      align-items: center;
      gap: 4px;
    }
    
    .room-timer {
      position: absolute;
      top: 5px;
      right: 10px;
      font-size: 0.65rem;
      color: #f59e0b;
      display: flex;
      align-items: center;
      gap: 3px;
    }
    
    /* ìƒˆ ë°© ë§Œë“¤ê¸° ë²„íŠ¼ */
    .create-room-btn {
      margin: 10px;
      padding: 12px;
      background: linear-gradient(135deg, #667eea, #764ba2);
      border: none;
      border-radius: 8px;
      color: white;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
    }
    
    .create-room-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 20px rgba(102, 126, 234, 0.4);
    }
    
    /* ë©”ì¸ ì±„íŒ… ì˜ì—­ */
    .chat-main {
      flex: 1;
      display: flex;
      flex-direction: column;
      background: #0a0a0a;
    }
    
    .chat-header {
      height: 60px;
      background: #111111;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      display: flex;
      align-items: center;
      padding: 0 20px;
      justify-content: space-between;
    }
    
    .chat-header-info {
      display: flex;
      align-items: center;
      gap: 15px;
    }
    
    .chat-header-title {
      font-size: 1.1rem;
      font-weight: 600;
    }
    
    .chat-header-users {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 6px 12px;
      background: rgba(255, 255, 255, 0.05);
      border-radius: 20px;
      font-size: 0.85rem;
    }
    
    .online-dot {
      width: 8px;
      height: 8px;
      background: #10b981;
      border-radius: 50%;
      animation: pulse 2s infinite;
    }
    
    @keyframes pulse {
      0%, 100% { transform: scale(1); opacity: 1; }
      50% { transform: scale(1.2); opacity: 0.8; }
    }
    
    /* ë©”ì‹œì§€ ì˜ì—­ */
    .messages-container {
      flex: 1;
      overflow-y: auto;
      padding: 20px;
      display: flex;
      flex-direction: column;
      gap: 15px;
    }
    
    /* ë©”ì‹œì§€ ìŠ¤íƒ€ì¼ */
    .message {
      display: flex;
      gap: 12px;
      animation: fadeInUp 0.3s ease-out;
      max-width: 100%;
    }
    
    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    
    .message-avatar {
      width: 36px;
      height: 36px;
      border-radius: 50%;
      background: linear-gradient(135deg, #667eea, #ec4899);
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      font-size: 0.9rem;
      flex-shrink: 0;
    }
    
    .message-content {
      flex: 1;
      display: flex;
      flex-direction: column;
    }
    
    .message-header {
      display: flex;
      align-items: baseline;
      gap: 10px;
      margin-bottom: 4px;
    }
    
    .message-username {
      font-weight: 600;
      font-size: 0.9rem;
      color: #667eea;
    }
    
    .message-time {
      font-size: 0.75rem;
      color: #666;
    }
    
    .message-text {
      color: #e0e0e0;
      line-height: 1.5;
      word-wrap: break-word;
      max-width: 70%;
      display: inline-block;
      background: rgba(255, 255, 255, 0.05);
      padding: 10px 15px;
      border-radius: 12px;
    }
    
    .message.own {
      flex-direction: row-reverse;
    }
    
    .message.own .message-content {
      align-items: flex-end;
      text-align: right;
    }
    
    .message.own .message-header {
      flex-direction: row-reverse;
      justify-content: flex-start;
    }
    
    .message.own .message-username {
      color: #ec4899;
    }
    
    .message.own .message-text {
      background: linear-gradient(135deg, rgba(102, 126, 234, 0.1), rgba(236, 72, 153, 0.1));
      padding: 10px 15px;
      border-radius: 12px;
      display: inline-block;
      max-width: 70%;
    }
    
    /* ì‹œìŠ¤í…œ ë©”ì‹œì§€ */
    .message.system {
      justify-content: center;
      font-size: 0.85rem;
      color: #666;
      font-style: italic;
    }
    
    /* íƒ€ì´í•‘ í‘œì‹œ */
    .typing-indicator {
      display: none;
      padding: 10px 20px;
      font-size: 0.85rem;
      color: #999;
      font-style: italic;
    }
    
    .typing-indicator.show {
      display: block;
    }
    
    /* ì…ë ¥ ì˜ì—­ */
    .input-container {
      padding: 20px;
      background: #111111;
      border-top: 1px solid rgba(255, 255, 255, 0.1);
    }
    
    .input-wrapper {
      display: flex;
      gap: 10px;
      align-items: center;
    }
    
    .message-input {
      flex: 1;
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 25px;
      padding: 12px 20px;
      color: white;
      font-size: 0.95rem;
      outline: none;
      transition: all 0.3s;
    }
    
    .message-input:focus {
      border-color: #667eea;
      background: rgba(255, 255, 255, 0.08);
    }
    
    .send-button {
      width: 45px;
      height: 45px;
      border-radius: 50%;
      background: linear-gradient(135deg, #667eea, #764ba2);
      border: none;
      color: white;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s;
    }
    
    .send-button:hover {
      transform: scale(1.05);
    }
    
    .send-button:active {
      transform: scale(0.95);
    }
    
    /* ëª¨ë‹¬ */
    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.8);
      backdrop-filter: blur(10px);
      z-index: 1000;
      align-items: center;
      justify-content: center;
      padding: 20px;
    }
    
    .modal.active {
      display: flex;
    }
    
    .modal-content {
      background: #1a1a1a;
      border-radius: 16px;
      padding: 30px;
      max-width: 400px;
      width: 100%;
      animation: modalSlideUp 0.3s ease-out;
    }
    
    @keyframes modalSlideUp {
      from {
        transform: translateY(50px);
        opacity: 0;
      }
      to {
        transform: translateY(0);
        opacity: 1;
      }
    }
    
    /* ëª¨ë°”ì¼ ëŒ€ì‘ */
    @media (max-width: 768px) {
      .sidebar {
        position: fixed;
        left: -280px;
        z-index: 100;
        transition: left 0.3s;
      }
      
      .sidebar.open {
        left: 0;
      }
      
      .chat-main {
        width: 100%;
      }
      
      .mobile-menu-btn {
        display: flex;
      }
      
      .stats-section {
        display: none;
      }
    }
    
    @media (min-width: 769px) {
      .mobile-menu-btn {
        display: none;
      }
    }
    
    /* ìŠ¤í¬ë¡¤ë°” ì»¤ìŠ¤í…€ */
    ::-webkit-scrollbar {
      width: 8px;
      height: 8px;
    }
    
    ::-webkit-scrollbar-track {
      background: #111;
    }
    
    ::-webkit-scrollbar-thumb {
      background: #333;
      border-radius: 4px;
    }
    
    ::-webkit-scrollbar-thumb:hover {
      background: #444;
    }
  </style>
</head>
<body>
  <div class="chat-container">
    <!-- ì‚¬ì´ë“œë°” -->
    <div class="sidebar" id="sidebar">
      <div class="sidebar-header">
        <div class="logo">
          <i class="fas fa-running"></i>
          <span>ëŸ¬ë‹í†¡</span>
        </div>
        <a href="index.html" class="home-button">
          <i class="fas fa-home"></i> ë©”ì¸
        </a>
      </div>
      
      <!-- í”„ë¡œí•„ ì„¹ì…˜ -->
      <div class="profile-section">
        <div class="profile-info" onclick="openProfileModal()">
          <div class="avatar" id="userAvatar">?</div>
          <div class="username">
            <div class="username-main" id="userNickname">ì—°ê²° ì¤‘...</div>
            <div class="username-status">
              <i class="fas fa-circle" style="font-size: 6px;"></i>
              <span id="connectionStatus">ì—°ê²° ì¤‘</span>
            </div>
          </div>
          <i class="fas fa-cog" style="color: #666;"></i>
        </div>
      </div>
      
      <!-- ì‹¤ì‹œê°„ í†µê³„ -->
      <div class="stats-section">
        <div class="stats-grid">
          <div class="stat-item">
            <div class="stat-value" id="onlineCount">0</div>
            <div class="stat-label">ì ‘ì†ì</div>
          </div>
          <div class="stat-item">
            <div class="stat-value" id="roomCount">0</div>
            <div class="stat-label">ì±„íŒ…ë°©</div>
          </div>
          <div class="stat-item">
            <div class="stat-value" id="messageCount">0</div>
            <div class="stat-label">ë©”ì‹œì§€</div>
          </div>
          <div class="stat-item">
            <div class="stat-value" id="roomUserCount">0</div>
            <div class="stat-label">í˜„ì¬ë°©</div>
          </div>
        </div>
      </div>
      
      <!-- ì±„íŒ…ë°© ë¦¬ìŠ¤íŠ¸ -->
      <div class="room-list" id="roomList">
        <div class="room-section-title">ë©”ì¸ ì±„íŒ…ë°©</div>
        <!-- ë™ì ìœ¼ë¡œ ìƒì„± -->
      </div>
      
      <!-- ìƒˆ ë°© ë§Œë“¤ê¸° ë²„íŠ¼ -->
      <button type="button" class="create-room-btn" onclick="openCreateRoomModal()">
        <i class="fas fa-plus"></i>
        <span>ìƒˆ ì±„íŒ…ë°© ë§Œë“¤ê¸°</span>
      </button>
    </div>
    
    <!-- ë©”ì¸ ì±„íŒ… ì˜ì—­ -->
    <div class="chat-main">
      <div class="chat-header">
        <div class="chat-header-info">
          <button type="button" onclick="toggleSidebar()" class="mobile-menu-btn" style="background: none; border: none; color: white; font-size: 1.2rem;">
            <i class="fas fa-bars"></i>
          </button>
          <div class="chat-header-title" id="currentRoomName">ì±„íŒ…ë°© ì„ íƒ</div>
          <div class="chat-header-users">
            <div class="online-dot"></div>
            <span id="currentRoomUsers">0ëª…</span>
          </div>
        </div>
        <button type="button" onclick="openGuideModal()" style="background: rgba(255, 255, 255, 0.1); border: 1px solid rgba(255, 255, 255, 0.2); color: #999; padding: 6px 12px; border-radius: 8px; font-size: 0.8rem; cursor: pointer; transition: all 0.3s; display: flex; align-items: center; gap: 5px;" onmouseover="this.style.background='rgba(255, 255, 255, 0.2)'; this.style.color='white'" onmouseout="this.style.background='rgba(255, 255, 255, 0.1)'; this.style.color='#999'">
          <i class="fas fa-info-circle"></i>
          <span>ì•ˆë‚´</span>
        </button>
      </div>
      
      <!-- ë©”ì‹œì§€ ì˜ì—­ -->
      <div class="messages-container" id="messagesContainer">
        <div class="message system">
          <span>ì±„íŒ…ë°©ì„ ì„ íƒí•˜ì„¸ìš”</span>
        </div>
      </div>
      
      <!-- íƒ€ì´í•‘ í‘œì‹œ -->
      <div class="typing-indicator" id="typingIndicator"></div>
      
      <!-- ì…ë ¥ ì˜ì—­ -->
      <div class="input-container">
        <div class="input-wrapper">
          <input type="text" class="message-input" id="messageInput" 
                 placeholder="ë©”ì‹œì§€ë¥¼ ì…ë ¥í•˜ì„¸ìš”..." 
                 onkeypress="if(event.key==='Enter' && !event.shiftKey) sendMessage()"
                 oninput="handleTyping()"
                 disabled aria-label="messageInputì— ì…ë ¥">
          <button type="button" class="send-button" onclick="sendMessage()" id="sendBtn" disabled>
            <i class="fas fa-paper-plane"></i>
          </button>
        </div>
      </div>
    </div>
  </div>
  
  <!-- í”„ë¡œí•„ ì„¤ì • ëª¨ë‹¬ -->
  <div class="modal" id="profileModal">
    <div class="modal-content">
      <h3 style="font-size: 1.3rem; font-weight: 700; margin-bottom: 20px; background: linear-gradient(135deg, #667eea, #764ba2); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">
        í”„ë¡œí•„ ì„¤ì •
      </h3>
      <div style="margin-bottom: 15px;">
        <label style="display: block; margin-bottom: 5px; color: #999; font-size: 0.85rem;">ë‹‰ë„¤ì„</label>
        <input type="text" id="nicknameInput" placeholder="ë‹‰ë„¤ì„ì„ ì…ë ¥í•˜ì„¸ìš”" maxlength="20"
               style="width: 100%; padding: 12px 16px; background: rgba(255, 255, 255, 0.05); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 8px; color: white; font-size: 0.95rem; outline: none;" aria-label="nicknameInputì— ì…ë ¥">
      </div>
      <div style="margin-bottom: 20px;">
        <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
          <input type="checkbox" id="anonymousCheck" style="width: 18px; height: 18px;">
          <span style="color: #999; font-size: 0.9rem;">ìµëª…ìœ¼ë¡œ í™œë™í•˜ê¸°</span>
        </label>
      </div>
      <div style="display: flex; gap: 10px; justify-content: flex-end;">
        <button type="button" onclick="closeProfileModal()" style="padding: 10px 20px; background: rgba(255, 255, 255, 0.1); color: white; border: none; border-radius: 8px; font-weight: 600; cursor: pointer;">
          ì·¨ì†Œ
        </button>
        <button type="button" onclick="saveProfile()" style="padding: 10px 20px; background: linear-gradient(135deg, #667eea, #764ba2); color: white; border: none; border-radius: 8px; font-weight: 600; cursor: pointer;">
          ì €ì¥
        </button>
      </div>
    </div>
  </div>
  
  <!-- ì±„íŒ…ë°© ìƒì„± ëª¨ë‹¬ -->
  <div class="modal" id="createRoomModal">
    <div class="modal-content">
      <h3 style="font-size: 1.3rem; font-weight: 700; margin-bottom: 20px; background: linear-gradient(135deg, #667eea, #764ba2); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">
        ìƒˆ ì±„íŒ…ë°© ë§Œë“¤ê¸°
      </h3>
      <div style="margin-bottom: 15px;">
        <label style="display: block; margin-bottom: 5px; color: #999; font-size: 0.85rem;">ì±„íŒ…ë°© ì´ë¦„</label>
        <input type="text" id="roomNameInput" placeholder="ì±„íŒ…ë°© ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”" maxlength="30"
               style="width: 100%; padding: 12px 16px; background: rgba(255, 255, 255, 0.05); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 8px; color: white; font-size: 0.95rem; outline: none;" aria-label="roomNameInputì— ì…ë ¥">
      </div>
      <div style="margin-bottom: 20px;">
        <label style="display: block; margin-bottom: 5px; color: #999; font-size: 0.85rem;">ì„¤ëª… (ì„ íƒ)</label>
        <input type="text" id="roomDescInput" placeholder="ì±„íŒ…ë°© ì„¤ëª…" maxlength="100"
               style="width: 100%; padding: 12px 16px; background: rgba(255, 255, 255, 0.05); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 8px; color: white; font-size: 0.95rem; outline: none;" aria-label="roomDescInputì— ì…ë ¥">
      </div>
      <div style="padding: 15px; background: rgba(243, 158, 11, 0.1); border-radius: 8px; margin-bottom: 20px;">
        <p style="color: #f59e0b; font-size: 0.85rem; line-height: 1.5;">
          <i class="fas fa-info-circle"></i> 
          ìƒì„±ëœ ì±„íŒ…ë°©ì€ 30ë¶„ê°„ í™œë™ì´ ì—†ìœ¼ë©´ ìë™ìœ¼ë¡œ ì‚­ì œë©ë‹ˆë‹¤.
        </p>
      </div>
      <div style="display: flex; gap: 10px; justify-content: flex-end;">
        <button type="button" onclick="closeCreateRoomModal()" style="padding: 10px 20px; background: rgba(255, 255, 255, 0.1); color: white; border: none; border-radius: 8px; font-weight: 600; cursor: pointer;">
          ì·¨ì†Œ
        </button>
        <button type="button" onclick="createRoom()" style="padding: 10px 20px; background: linear-gradient(135deg, #667eea, #764ba2); color: white; border: none; border-radius: 8px; font-weight: 600; cursor: pointer;">
          ë§Œë“¤ê¸°
        </button>
      </div>
    </div>
  </div>
  
  <!-- ì±„íŒ… ì•ˆë‚´ì‚¬í•­ ëª¨ë‹¬ -->
  <div id="guideModal" class="modal">
    <div class="modal-content" style="max-width: 600px; max-height: 80vh; overflow-y: auto;">
      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; padding-bottom: 15px; border-bottom: 1px solid rgba(255, 255, 255, 0.1);">
        <h2 style="font-size: 1.5rem; font-weight: 700; background: linear-gradient(135deg, #667eea, #764ba2); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">
          ğŸ“œ ì±„íŒ…ë°© ì´ìš© ì•ˆë‚´
        </h2>
        <button type="button" onclick="closeGuideModal()" style="background: none; border: none; color: #999; font-size: 1.5rem; cursor: pointer; padding: 0; width: 30px; height: 30px; display: flex; align-items: center; justify-content: center;">
          Ã—
        </button>
      </div>
      
      <div style="space-y: 20px;">
        <!-- ê¸°ë³¸ ì •ë³´ -->
        <div style="margin-bottom: 20px;">
          <h3 style="color: #667eea; font-size: 1.1rem; margin-bottom: 10px; display: flex; align-items: center; gap: 8px;">
            <i class="fas fa-clock"></i> ë©”ì‹œì§€ ë³´ê´€ ì •ì±…
          </h3>
          <div style="background: rgba(102, 126, 234, 0.1); padding: 12px; border-radius: 8px; border-left: 3px solid #667eea;">
            <p style="color: #e0e0e0; line-height: 1.6; font-size: 0.9rem;">
              â€¢ ëª¨ë“  ì±„íŒ… ë©”ì‹œì§€ëŠ” <strong style="color: #ec4899;">24ì‹œê°„ í›„ ìë™ ì‚­ì œ</strong>ë©ë‹ˆë‹¤.<br>
              â€¢ ì‚¬ìš©ì ìƒì„± ì±„íŒ…ë°©ì€ <strong style="color: #ec4899;">30ë¶„ê°„ í™œë™ì´ ì—†ìœ¼ë©´ ìë™ ì‚­ì œ</strong>ë©ë‹ˆë‹¤.<br>
              â€¢ ì¤‘ìš”í•œ ëŒ€í™”ëŠ” ê°œì¸ì ìœ¼ë¡œ ì €ì¥í•´ ì£¼ì‹œê¸° ë°”ëë‹ˆë‹¤.
            </p>
          </div>
        </div>

        <!-- ê²½ê³  ì‚¬í•­ -->
        <div style="margin-bottom: 20px;">
          <h3 style="color: #ef4444; font-size: 1.1rem; margin-bottom: 10px; display: flex; align-items: center; gap: 8px;">
            <i class="fas fa-exclamation-triangle"></i> ê¸ˆì§€ í–‰ìœ„ ë° ì²˜ë²Œ
          </h3>
          <div style="background: rgba(239, 68, 68, 0.1); padding: 12px; border-radius: 8px; border-left: 3px solid #ef4444;">
            <p style="color: #fca5a5; line-height: 1.8; font-size: 0.9rem; font-weight: 500;">
              ë‹¤ìŒ í–‰ìœ„ëŠ” <strong>ì—„ê²©íˆ ê¸ˆì§€</strong>ë˜ë©°, ìœ„ë°˜ ì‹œ <strong>ê²€ì°° ê³ ë°œ ë° ë²•ì  ì²˜ë²Œ</strong>ì„ ë°›ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤:
            </p>
            <ul style="color: #fca5a5; line-height: 1.8; font-size: 0.85rem; margin-top: 10px; padding-left: 20px;">
              <li>ğŸš« <strong>ë¶ˆë²• ì½˜í…ì¸ </strong>: ìŒë€ë¬¼, ë„ë°•, ì•½ë¬¼ ê±°ë˜ ë“±</li>
              <li>ğŸ“¢ <strong>ìŠ¤íŒ¸ ë° ê´‘ê³ </strong>: ë¬´ë‹¨ í™ë³´, ìƒì—…ì  ê´‘ê³ </li>
              <li>ğŸ¤¬ <strong>ìš•ì„¤ ë° ë¹„ë°©</strong>: íƒ€ì¸ì— ëŒ€í•œ ëª¨ìš•, ëª…ì˜ˆí›¼ì†</li>
              <li>ğŸ™… <strong>ì„±í¬ë¡±</strong>: ì„±ì  ëª¨ìš•, í˜‘ë°•, ìŠ¤í† í‚¹</li>
              <li>ğŸ†˜ <strong>ê°œì¸ì •ë³´ ìœ ì¶œ</strong>: íƒ€ì¸ì˜ ê°œì¸ì •ë³´ ë¬´ë‹¨ ê³µê°œ</li>
              <li>âš ï¸ <strong>í—ˆìœ„ ì‚¬ì‹¤ ìœ í¬</strong>: ê°€ì§œë‰´ìŠ¤, ì˜ëª»ëœ ì •ë³´ í™•ì‚°</li>
            </ul>
            <p style="color: #fbbf24; margin-top: 15px; font-size: 0.85rem; padding: 10px; background: rgba(251, 191, 36, 0.1); border-radius: 4px;">
              âš ï¸ <strong>ì²˜ë²Œ</strong>: í˜•ë²• ë° ê´€ë ¨ ë²•ë¥ ì— ë”°ë¼ <strong>ì§•ì—­ ë˜ëŠ” ë²Œê¸ˆí˜•</strong>ì— ì²˜í•´ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
            </p>
          </div>
        </div>

        <!-- ê°œì¸ì •ë³´ ë³´í˜¸ -->
        <div style="margin-bottom: 20px;">
          <h3 style="color: #10b981; font-size: 1.1rem; margin-bottom: 10px; display: flex; align-items: center; gap: 8px;">
            <i class="fas fa-shield-alt"></i> ê°œì¸ì •ë³´ ë³´í˜¸
          </h3>
          <div style="background: rgba(16, 185, 129, 0.1); padding: 12px; border-radius: 8px; border-left: 3px solid #10b981;">
            <p style="color: #e0e0e0; line-height: 1.6; font-size: 0.9rem;">
              â€¢ ë‹‰ë„¤ì„ê³¼ ì±„íŒ… ë‚´ìš©ë§Œ ì €ì¥ë˜ë©°, ê°œì¸ ì‹ë³„ ì •ë³´ëŠ” ìˆ˜ì§‘í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.<br>
              â€¢ ìµëª… ëª¨ë“œë¥¼ ì‚¬ìš©í•˜ì—¬ ì™„ì „í•œ ìµëª…ì„±ì„ ë³´ì¥ë°›ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.<br>
              â€¢ IP ì£¼ì†ŒëŠ” ë²•ì  ìš”ì²­ ì‹œì—ë§Œ ì œê³µë©ë‹ˆë‹¤.<br>
              â€¢ ëª¨ë“  ë°ì´í„°ëŠ” SSL ì•”í˜¸í™”ë¥¼ í†µí•´ ì•ˆì „í•˜ê²Œ ì „ì†¡ë©ë‹ˆë‹¤.
            </p>
          </div>
        </div>

        <!-- ì´ìš© íŒ -->
        <div style="margin-bottom: 20px;">
          <h3 style="color: #f59e0b; font-size: 1.1rem; margin-bottom: 10px; display: flex; align-items: center; gap: 8px;">
            <i class="fas fa-lightbulb"></i> ì´ìš© íŒ
          </h3>
          <div style="background: rgba(245, 158, 11, 0.1); padding: 12px; border-radius: 8px; border-left: 3px solid #f59e0b;">
            <ul style="color: #e0e0e0; line-height: 1.6; font-size: 0.9rem; padding-left: 20px;">
              <li>ìƒˆ ì±„íŒ…ë°© ìƒì„±: í•˜ë‹¨ "+" ë²„íŠ¼ í´ë¦­</li>
              <li>í”„ë¡œí•„ ë³€ê²½: ì¢Œì¸¡ ìƒë‹¨ í”„ë¡œí•„ í´ë¦­</li>
              <li>ìµëª… ëª¨ë“œ: í”„ë¡œí•„ ì„¤ì •ì—ì„œ í™œì„±í™”</li>
              <li>ë°© ë‚˜ê°€ê¸°: ë‹¤ë¥¸ ë°© ì„ íƒ ì‹œ ìë™ í‡´ì¥</li>
            </ul>
          </div>
        </div>

        <!-- ë¬¸ì˜ ì •ë³´ -->
        <div>
          <h3 style="color: #8b5cf6; font-size: 1.1rem; margin-bottom: 10px; display: flex; align-items: center; gap: 8px;">
            <i class="fas fa-envelope"></i> ë¬¸ì˜ ë° ì‹ ê³ 
          </h3>
          <div style="background: rgba(139, 92, 246, 0.1); padding: 12px; border-radius: 8px; border-left: 3px solid #8b5cf6;">
            <p style="color: #e0e0e0; line-height: 1.6; font-size: 0.9rem;">
              ë¶€ì ì ˆí•œ í–‰ìœ„ë¥¼ ë°œê²¬í•˜ì‹  ê²½ìš° ì¦‰ì‹œ ì‹ ê³ í•´ ì£¼ì„¸ìš”.<br>
              ë¬¸ì˜: admin@athlete-time.com
            </p>
          </div>
        </div>
      </div>
      
      <div style="margin-top: 25px; padding-top: 20px; border-top: 1px solid rgba(255, 255, 255, 0.1); text-align: center;">
        <button type="button" onclick="closeGuideModal()" style="padding: 12px 30px; background: linear-gradient(135deg, #667eea, #764ba2); color: white; border: none; border-radius: 8px; font-weight: 600; cursor: pointer; font-size: 0.95rem;">
          í™•ì¸í–ˆìŠµë‹ˆë‹¤
        </button>
      </div>
    </div>
  </div>
  
  <script>
    // ì „ì—­ ë³€ìˆ˜
    let ws = null;
    let currentRoom = null;
    let userProfile = {
      nickname: null,
      avatar: '?',
      anonymous: false,
      userId: null
    };
    let typingTimeout = null;
    let isTyping = false;
    let reconnectAttempts = 0;
    let roomTimers = new Map();
    
    // ì´ˆê¸°í™”
    function init() {
      loadProfile();
      connectWebSocket();
    }
    
    // í”„ë¡œí•„ ë¡œë“œ
    function loadProfile() {
      const saved = (function() { try { return localStorage.getItem('runningChatProfile'); } catch(e) { console.error('Storage error:', e); return null; } })();
      if (saved) {
        userProfile = JSON.parse(saved);
      } else {
        userProfile.userId = 'user_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
        userProfile.nickname = `ëŸ¬ë„ˆ${Math.floor(Math.random() * 10000)}`;
        userProfile.avatar = userProfile.nickname.substring(0, 1);
        userProfile.anonymous = false;
        saveProfileToStorage();
      }
      updateProfileUI();
    }
    
    // í”„ë¡œí•„ ì €ì¥
    function saveProfileToStorage() {
      (function() { try { return localStorage.setItem('runningChatProfile', JSON.stringify(userProfile); } catch(e) { console.error('Storage error:', e); return null; } })());
    }
    
    // í”„ë¡œí•„ UI ì—…ë°ì´íŠ¸
    function updateProfileUI() {
      const displayName = userProfile.anonymous ? 'ìµëª…ëŸ¬ë„ˆ' : userProfile.nickname;
      const displayAvatar = userProfile.anonymous ? 'ìµ' : userProfile.avatar;
      
      document.getElementById('userNickname').textContent = displayName;
      document.getElementById('userAvatar').textContent = displayAvatar;
    }
    
    // WebSocket ì—°ê²°
    function connectWebSocket() {
      // WebSocket URL ìë™ ê°ì§€ - ì‹¤ì œ í˜¸ìŠ¤íŒ… í™˜ê²½ ì§€ì›
      let wsUrl;
      const hostname = window.location.hostname;
      const protocol = window.location.protocol;
      
      // ë‹¤ì–‘í•œ í˜¸ìŠ¤íŒ… í™˜ê²½ ì²˜ë¦¬
      if (hostname.includes('e2b.dev')) {
        // E2B sandbox í™˜ê²½
        const sandboxId = hostname.split('.')[0].split('-').slice(1).join('-');
        wsUrl = `wss://3004-${sandboxId}.e2b.dev`;
      } else if (hostname === 'localhost' || hostname === '127.0.0.1') {
        // ë¡œì»¬ ê°œë°œ í™˜ê²½
        wsUrl = `ws://${hostname}:3004`;
      } else if (protocol === 'https:') {
        // HTTPS í˜¸ìŠ¤íŒ… í™˜ê²½ (Vercel, Netlify ë“±)
        // ì‹¤ì œ ë°°í¬ ì‹œ WebSocket ì„œë²„ URLë¡œ êµì²´ í•„ìš”
        // ì˜ˆ: wss://your-chat-server.herokuapp.com ë˜ëŠ” wss://chat.yourdomain.com
        wsUrl = `wss://${hostname}:3004`;
      } else {
        // HTTP í˜¸ìŠ¤íŒ… í™˜ê²½
        wsUrl = `ws://${hostname}:3004`;
      }
      
      console.log('ğŸ”Œ WebSocket ì—°ê²° ì‹œë„:', wsUrl);
      
      try {
        ws = new WebSocket(wsUrl);
        
        ws.onopen = () => {
          // console.log('âœ… ì±„íŒ… ì„œë²„ ì—°ê²°ë¨'); // Production: removed
          reconnectAttempts = 0;
          document.getElementById('connectionStatus').textContent = 'ì˜¨ë¼ì¸';
          
          // ë©”ì¸ ì±„íŒ…ë°© ìë™ ì…ì¥
          setTimeout(() => {
            joinRoom('main');
          }, 500);
        };
        
        ws.onmessage = (event) => {
          const data = JSON.parse(event.data);
          handleWebSocketMessage(data);
        };
        
        ws.onclose = () => {
          // console.log('âŒ ì±„íŒ… ì„œë²„ ì—°ê²° ëŠê¹€'); // Production: removed
          document.getElementById('connectionStatus').textContent = 'ì˜¤í”„ë¼ì¸';
          
          // ì¬ì—°ê²° ì‹œë„
          if (reconnectAttempts < 5) {
            reconnectAttempts++;
            setTimeout(connectWebSocket, 2000 * reconnectAttempts);
          }
        };
        
        ws.onerror = (error) => {
          console.error('WebSocket ì˜¤ë¥˜:', error);
        };
        
      } catch (error) {
        console.error('WebSocket ì—°ê²° ì‹¤íŒ¨:', error);
      }
    }
    
    // WebSocket ë©”ì‹œì§€ ì²˜ë¦¬
    function handleWebSocketMessage(data) {
      switch(data.type) {
        case 'connected':
          updateRoomList(data.data.rooms);
          updateStats(data.data.stats);
          break;
          
        case 'room_joined':
          handleRoomJoined(data.data);
          break;
          
        case 'message':
          displayMessage(data.data);
          break;
          
        case 'user_joined':
          addSystemMessage(`${data.data.nickname}ë‹˜ì´ ì…ì¥í–ˆìŠµë‹ˆë‹¤.`);
          updateRoomUserCount(data.data.count);
          break;
          
        case 'user_left':
          addSystemMessage(`${data.data.nickname}ë‹˜ì´ í‡´ì¥í–ˆìŠµë‹ˆë‹¤.`);
          updateRoomUserCount(data.data.count);
          break;
          
        case 'room_created':
          addRoomToList(data.data);
          break;
          
        case 'room_deleted':
          removeRoomFromList(data.data.roomId);
          if (currentRoom === data.data.roomId) {
            joinRoom('general');
            alert(`í˜„ì¬ ì±„íŒ…ë°©ì´ ${data.data.reason}ìœ¼ë¡œ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.`);
          }
          break;
          
        case 'room_update':
          updateRoomInfo(data.data);
          break;
          
        case 'stats_update':
          updateStats(data.data);
          break;
          
        case 'user_typing':
          showTypingIndicator(data.data);
          break;
          
        case 'server_shutdown':
          addSystemMessage('ì„œë²„ê°€ ì¬ì‹œì‘ë©ë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì—°ê²°ë©ë‹ˆë‹¤.');
          break;
          
        case 'error':
          alert(data.data.message);
          break;
      }
    }
    
    // ë°© ì…ì¥ ì²˜ë¦¬
    function handleRoomJoined(data) {
      // ë©”ì‹œì§€ ì´ˆê¸°í™”
      document.getElementById('messagesContainer').innerHTML = '';
      
      // íˆìŠ¤í† ë¦¬ í‘œì‹œ
      if (data.messages && data.messages.length > 0) {
        data.messages.forEach(msg => {
          displayMessage(msg, false);
        });
      }
      
      addSystemMessage('ì±„íŒ…ë°©ì— ì…ì¥í–ˆìŠµë‹ˆë‹¤.');
      updateRoomUserCount(data.userCount);
      
      // ì…ë ¥ í™œì„±í™”
      document.getElementById('messageInput').disabled = false;
      document.getElementById('sendBtn').disabled = false;
      document.getElementById('messageInput').focus();
    }
    
    // ë°© ì…ì¥
    function joinRoom(roomId) {
      if (!ws || ws.readyState !== WebSocket.OPEN) {
        alert('ì„œë²„ì— ì—°ê²°ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.');
        return;
      }
      
      if (roomId === currentRoom) return;
      
      currentRoom = roomId;
      
      // UI ì—…ë°ì´íŠ¸
      document.querySelectorAll('.room-item').forEach(item => {
        item.classList.remove('active');
        if (item.dataset.roomId === roomId) {
          item.classList.add('active');
          const roomName = item.querySelector('.room-name').textContent;
          document.getElementById('currentRoomName').textContent = roomName;
        }
      });
      
      // ì„œë²„ì— ì…ì¥ ìš”ì²­
      ws.send(JSON.stringify({
        type: 'join',
        data: {
          room: roomId,
          nickname: userProfile.nickname,
          userId: userProfile.userId
        }
      }));
      
      // ëª¨ë°”ì¼ì—ì„œ ì‚¬ì´ë“œë°” ë‹«ê¸°
      if (window.innerWidth <= 768) {
        document.getElementById('sidebar').classList.remove('open');
      }
    }
    
    // ë©”ì‹œì§€ ì „ì†¡
    function sendMessage() {
      const input = document.getElementById('messageInput');
      const text = input.value.trim();
      
      if (!text || !ws || ws.readyState !== WebSocket.OPEN || !currentRoom) return;
      
      const displayName = userProfile.anonymous ? 'ìµëª…ëŸ¬ë„ˆ' : userProfile.nickname;
      const displayAvatar = userProfile.anonymous ? 'ìµ' : userProfile.avatar;
      
      ws.send(JSON.stringify({
        type: 'message',
        data: {
          text,
          nickname: displayName,
          avatar: displayAvatar,
          room: currentRoom,
          userId: userProfile.userId  // userId ì¶”ê°€
        }
      }));
      
      // ìì‹ ì˜ ë©”ì‹œì§€ëŠ” ì„œë²„ì—ì„œ ë°›ì•„ì„œ í‘œì‹œ (ì¤‘ë³µ ë°©ì§€)
      // displayMessage í˜¸ì¶œ ì œê±°
      
      input.value = '';
    }
    
    // ë©”ì‹œì§€ í‘œì‹œ
    function displayMessage(data, isOwn = false) {
      const container = document.getElementById('messagesContainer');
      
      // ìì‹ ì˜ ë©”ì‹œì§€ì¸ì§€ í™•ì¸
      if (data.userId === userProfile.userId) {
        isOwn = true;
      }
      
      const messageDiv = document.createElement('div');
      messageDiv.className = `message ${isOwn ? 'own' : ''}`;
      
      const time = new Date(data.timestamp || new Date()).toLocaleTimeString('ko-KR', {
        hour: '2-digit',
        minute: '2-digit'
      });
      
      messageDiv.innerHTML = `
        <div class="message-avatar">${data.avatar || '?'}</div>
        <div class="message-content">
          <div class="message-header">
            <span class="message-username">${data.nickname || 'ìµëª…'}</span>
            <span class="message-time">${time}</span>
          </div>
          <div class="message-text">${escapeHtml(data.text)}</div>
        </div>
      `;
      
      container.appendChild(messageDiv);
      container.scrollTop = container.scrollHeight;
    }
    
    // ì‹œìŠ¤í…œ ë©”ì‹œì§€
    function addSystemMessage(text) {
      const container = document.getElementById('messagesContainer');
      const messageDiv = document.createElement('div');
      messageDiv.className = 'message system';
      messageDiv.innerHTML = `<span>${text}</span>`;
      container.appendChild(messageDiv);
      container.scrollTop = container.scrollHeight;
    }
    
    // ì±„íŒ…ë°© ëª©ë¡ ì—…ë°ì´íŠ¸
    function updateRoomList(rooms) {
      const container = document.getElementById('roomList');
      container.innerHTML = '<div class="room-section-title">ë©”ì¸ ì±„íŒ…ë°©</div>';
      
      const permanentRooms = [];
      const customRooms = [];
      
      rooms.forEach(room => {
        if (room.permanent) {
          permanentRooms.push(room);
        } else {
          customRooms.push(room);
        }
      });
      
      // ë©”ì¸ ì±„íŒ…ë°©
      permanentRooms.forEach(room => {
        container.appendChild(createRoomElement(room));
      });
      
      // ì‚¬ìš©ì ìƒì„± ì±„íŒ…ë°©
      if (customRooms.length > 0) {
        const title = document.createElement('div');
        title.className = 'room-section-title';
        title.style.marginTop = '20px';
        title.textContent = 'ì‚¬ìš©ì ì±„íŒ…ë°©';
        container.appendChild(title);
        
        customRooms.forEach(room => {
          container.appendChild(createRoomElement(room));
        });
      }
    }
    
    // ì±„íŒ…ë°© ì—˜ë¦¬ë¨¼íŠ¸ ìƒì„±
    function createRoomElement(room) {
      const div = document.createElement('div');
      div.className = 'room-item';
      div.dataset.roomId = room.id;
      div.onclick = () => joinRoom(room.id);
      
      const timeLeft = room.permanent ? '' : calculateTimeLeft(room.lastActivity);
      
      div.innerHTML = `
        <div class="room-icon">${room.icon || 'ğŸ’¬'}</div>
        <div class="room-info">
          <div class="room-name">${room.name}</div>
          <div class="room-meta">
            <span class="room-users">
              <i class="fas fa-users"></i>
              <span>${room.userCount || 0}</span>
            </span>
            <span>${room.desc || ''}</span>
          </div>
        </div>
        ${!room.permanent && timeLeft ? `<div class="room-timer"><i class="fas fa-clock"></i> ${timeLeft}</div>` : ''}
      `;
      
      return div;
    }
    
    // ë‚¨ì€ ì‹œê°„ ê³„ì‚°
    function calculateTimeLeft(lastActivity) {
      if (!lastActivity) return '';
      
      const now = new Date();
      const last = new Date(lastActivity);
      const diff = now - last;
      const minutesLeft = Math.max(0, 30 - Math.floor(diff / 60000));
      
      if (minutesLeft <= 0) return 'ê³§ ì‚­ì œ';
      if (minutesLeft <= 5) return `${minutesLeft}ë¶„`;
      return '';
    }
    
    // í†µê³„ ì—…ë°ì´íŠ¸
    function updateStats(stats) {
      if (stats.onlineUsers !== undefined) {
        document.getElementById('onlineCount').textContent = stats.onlineUsers;
      }
      if (stats.totalRooms !== undefined) {
        document.getElementById('roomCount').textContent = stats.totalRooms;
      }
      if (stats.totalMessages !== undefined) {
        document.getElementById('messageCount').textContent = 
          stats.totalMessages > 999 ? '999+' : stats.totalMessages;
      }
    }
    
    // ë°© ì‚¬ìš©ì ìˆ˜ ì—…ë°ì´íŠ¸
    function updateRoomUserCount(count) {
      document.getElementById('currentRoomUsers').textContent = `${count}ëª…`;
      document.getElementById('roomUserCount').textContent = count;
    }
    
    // íƒ€ì´í•‘ ì²˜ë¦¬
    function handleTyping() {
      if (!ws || ws.readyState !== WebSocket.OPEN || !currentRoom) return;
      
      if (!isTyping) {
        isTyping = true;
        ws.send(JSON.stringify({
          type: 'typing',
          data: { isTyping: true }
        }));
      }
      
      clearTimeout(typingTimeout);
      typingTimeout = setTimeout(() => {
        isTyping = false;
        ws.send(JSON.stringify({
          type: 'typing',
          data: { isTyping: false }
        }));
      }, 1000);
    }
    
    // íƒ€ì´í•‘ í‘œì‹œ
    function showTypingIndicator(data) {
      const indicator = document.getElementById('typingIndicator');
      if (data.isTyping) {
        indicator.textContent = `${data.nickname}ë‹˜ì´ ì…ë ¥ ì¤‘...`;
        indicator.classList.add('show');
        
        setTimeout(() => {
          indicator.classList.remove('show');
        }, 3000);
      }
    }
    
    // í”„ë¡œí•„ ëª¨ë‹¬
    function openProfileModal() {
      document.getElementById('nicknameInput').value = userProfile.nickname;
      document.getElementById('anonymousCheck').checked = userProfile.anonymous;
      document.getElementById('profileModal').classList.add('active');
    }
    
    function closeProfileModal() {
      document.getElementById('profileModal').classList.remove('active');
    }
    
    function saveProfile() {
      userProfile.nickname = document.getElementById('nicknameInput').value || `ëŸ¬ë„ˆ${Math.floor(Math.random() * 10000)}`;
      userProfile.anonymous = document.getElementById('anonymousCheck').checked;
      userProfile.avatar = userProfile.nickname.substring(0, 1);
      
      saveProfileToStorage();
      updateProfileUI();
      closeProfileModal();
      
      // ì„œë²„ì— í”„ë¡œí•„ ì—…ë°ì´íŠ¸
      if (ws && ws.readyState === WebSocket.OPEN) {
        ws.send(JSON.stringify({
          type: 'profile_update',
          data: userProfile
        }));
      }
    }
    
    // ì±„íŒ…ë°© ìƒì„±
    function openCreateRoomModal() {
      document.getElementById('createRoomModal').classList.add('active');
    }
    
    function closeCreateRoomModal() {
      document.getElementById('createRoomModal').classList.remove('active');
      document.getElementById('roomNameInput').value = '';
      document.getElementById('roomDescInput').value = '';
    }
    
    function createRoom() {
      const roomName = document.getElementById('roomNameInput').value.trim();
      const roomDesc = document.getElementById('roomDescInput').value.trim();
      
      if (!roomName) {
        alert('ì±„íŒ…ë°© ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”.');
        return;
      }
      
      if (!ws || ws.readyState !== WebSocket.OPEN) {
        alert('ì„œë²„ì— ì—°ê²°ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.');
        return;
      }
      
      ws.send(JSON.stringify({
        type: 'create_room',
        data: {
          name: roomName,
          description: roomDesc,
          icon: 'ğŸ’¬',
          private: false
        }
      }));
      
      closeCreateRoomModal();
    }
    
    // ì‚¬ì´ë“œë°” í† ê¸€
    function toggleSidebar() {
      document.getElementById('sidebar').classList.toggle('open');
    }
    
    // ë°© ì¶”ê°€
    function addRoomToList(room) {
      const container = document.getElementById('roomList');
      
      // ì‚¬ìš©ì ì±„íŒ…ë°© ì„¹ì…˜ì´ ì—†ìœ¼ë©´ ì¶”ê°€
      let customSection = container.querySelector('.custom-rooms-section');
      if (!customSection) {
        const title = document.createElement('div');
        title.className = 'room-section-title custom-rooms-section';
        title.style.marginTop = '20px';
        title.textContent = 'ì‚¬ìš©ì ì±„íŒ…ë°©';
        container.appendChild(title);
      }
      
      container.appendChild(createRoomElement(room));
    }
    
    // ë°© ì œê±°
    function removeRoomFromList(roomId) {
      const element = document.querySelector(`[data-room-id="${roomId}"]`);
      if (element) {
        element.remove();
      }
    }
    
    // ë°© ì •ë³´ ì—…ë°ì´íŠ¸
    function updateRoomInfo(data) {
      const element = document.querySelector(`[data-room-id="${data.id}"]`);
      if (element) {
        const userCount = element.querySelector('.room-users span');
        if (userCount) {
          userCount.textContent = data.userCount;
        }
      }
    }
    
    // HTML ì´ìŠ¤ì¼€ì´í”„
    function escapeHtml(text) {
      const div = document.createElement('div');
      div.textContent = text;
      return div.innerHTML;
    }
    
    // íƒ€ì´ë¨¸ ì—…ë°ì´íŠ¸ (1ë¶„ë§ˆë‹¤)
    setInterval(() => {
      document.querySelectorAll('.room-item').forEach(item => {
        const roomId = item.dataset.roomId;
        // íƒ€ì´ë¨¸ ì—…ë°ì´íŠ¸ ë¡œì§
      });
    }, 60000);
    
    // ì•ˆë‚´ ëª¨ë‹¬
    function openGuideModal() {
      document.getElementById('guideModal').classList.add('active');
    }
    
    function closeGuideModal() {
      document.getElementById('guideModal').classList.remove('active');
    }
    
    // ì´ˆê¸°í™”
    init();
  </script>

</body>
</html>