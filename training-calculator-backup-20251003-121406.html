<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>훈련 페이스 계산기 - VDOT 기반 과학적 훈련 | Athlete Time</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Malgun Gothic', '맑은 고딕', sans-serif;
    }
    
    .gradient-bg {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    }
    
    .gradient-text {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }
    
    .training-zone-easy { background: linear-gradient(135deg, #10b981, #059669); }
    .training-zone-marathon { background: linear-gradient(135deg, #3b82f6, #2563eb); }
    .training-zone-threshold { background: linear-gradient(135deg, #f59e0b, #d97706); }
    .training-zone-interval { background: linear-gradient(135deg, #ef4444, #dc2626); }
    .training-zone-repetition { background: linear-gradient(135deg, #a855f7, #9333ea); }
    
    .zone-card {
      transition: all 0.3s ease;
      cursor: pointer;
    }
    
    .zone-card:hover {
      transform: translateY(-4px);
      box-shadow: 0 10px 20px rgba(0,0,0,0.1);
    }
    
    .result-table th {
      position: sticky;
      top: 0;
      background: white;
      z-index: 10;
    }
    
    @keyframes slideIn {
      from {
        transform: translateY(20px);
        opacity: 0;
      }
      to {
        transform: translateY(0);
        opacity: 1;
      }
    }
    
    .slide-in {
      animation: slideIn 0.5s ease;
    }
  </style>
</head>
<body class="bg-gray-50">
  <div class="min-h-screen">
    <!-- 헤더 -->
    <div class="gradient-bg text-white py-8 px-4 shadow-lg">
      <div class="container mx-auto max-w-6xl">
        <div class="flex items-center justify-between mb-4">
          <h1 class="text-3xl font-bold flex items-center gap-3">
            <i class="fas fa-running"></i>
            훈련 페이스 계산기
          </h1>
          <a href="index.html" class="bg-white/20 hover:bg-white/30 px-4 py-2 rounded-lg transition">
            <i class="fas fa-home mr-2"></i>메인으로
          </a>
        </div>
        <p class="text-lg opacity-90">Jack Daniels VDOT 기반 과학적 훈련 페이스 계산</p>
      </div>
    </div>

    <div class="container mx-auto max-w-6xl px-4 py-8">
      <!-- 입력 섹션 -->
      <div class="bg-white rounded-xl shadow-lg p-6 mb-8">
        <h2 class="text-2xl font-bold mb-6 flex items-center gap-2">
          <i class="fas fa-calculator text-purple-600"></i>
          기준 기록 입력
        </h2>
        
        <div class="grid md:grid-cols-2 gap-6">
          <!-- 거리 선택 -->
          <div>
            <label class="block text-sm font-semibold text-gray-700 mb-2">
              <i class="fas fa-route text-blue-500 mr-1"></i>
              거리 선택
            </label>
            <select id="distanceSelect" class="w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:border-purple-500 focus:outline-none text-lg">
              <option value="">거리를 선택하세요</option>
              <optgroup label="트랙 경기">
                <option value="800">800m</option>
                <option value="1500">1500m</option>
                <option value="3000">3000m</option>
              </optgroup>
              <optgroup label="로드 경기">
                <option value="5000">5km</option>
                <option value="10000">10km</option>
                <option value="21097.5">하프마라톤</option>
                <option value="42195">풀마라톤</option>
              </optgroup>
            </select>
          </div>
          
          <!-- 시간 입력 -->
          <div>
            <label class="block text-sm font-semibold text-gray-700 mb-2">
              <i class="fas fa-clock text-green-500 mr-1"></i>
              기록 입력
            </label>
            <div class="flex gap-2">
              <input type="number" id="hours" min="0" max="6" placeholder="시" 
                     class="w-20 px-3 py-3 border-2 border-gray-200 rounded-lg focus:border-purple-500 focus:outline-none text-center text-lg">
              <span class="self-center text-xl">:</span>
              <input type="number" id="minutes" min="0" max="59" placeholder="분" 
                     class="w-20 px-3 py-3 border-2 border-gray-200 rounded-lg focus:border-purple-500 focus:outline-none text-center text-lg">
              <span class="self-center text-xl">:</span>
              <input type="number" id="seconds" min="0" max="59" placeholder="초" 
                     class="w-20 px-3 py-3 border-2 border-gray-200 rounded-lg focus:border-purple-500 focus:outline-none text-center text-lg">
            </div>
            <p class="text-xs text-gray-500 mt-2">예: 풀마라톤 3시간 30분 → 3:30:00</p>
          </div>
        </div>
        
        <!-- 계산 버튼 -->
        <div class="mt-6 flex gap-4">
          <button onclick="calculateTrainingPaces()" 
                  class="flex-1 bg-gradient-to-r from-purple-600 to-purple-700 text-white px-6 py-3 rounded-lg font-semibold hover:from-purple-700 hover:to-purple-800 transition-all transform hover:scale-105">
            <i class="fas fa-play mr-2"></i>
            훈련 페이스 계산
          </button>
          <button onclick="resetForm()" 
                  class="px-6 py-3 border-2 border-gray-300 rounded-lg font-semibold hover:bg-gray-100 transition">
            <i class="fas fa-redo mr-2"></i>
            초기화
          </button>
        </div>
      </div>

      <!-- VDOT 설명 카드 -->
      <div class="bg-gradient-to-r from-blue-50 to-purple-50 rounded-xl p-6 mb-8 border-l-4 border-purple-500">
        <h3 class="text-lg font-bold mb-2 flex items-center gap-2">
          <i class="fas fa-info-circle text-purple-600"></i>
          VDOT이란?
        </h3>
        <p class="text-gray-700 leading-relaxed">
          VDOT은 Jack Daniels 박사가 개발한 러닝 체력 지표로, VO2max를 기반으로 한 과학적 훈련 시스템입니다. 
          현재 기록을 입력하면 개인의 VDOT 값을 계산하고, 이를 통해 5가지 훈련 구간별 최적 페이스를 제공합니다.
        </p>
      </div>

      <!-- 결과 섹션 -->
      <div id="resultsSection" class="hidden slide-in">
        <!-- VDOT 및 예상 기록 -->
        <div class="bg-white rounded-xl shadow-lg p-6 mb-8">
          <h2 class="text-2xl font-bold mb-6 flex items-center gap-2">
            <i class="fas fa-chart-line text-orange-500"></i>
            VDOT 분석 결과
          </h2>
          
          <div class="grid md:grid-cols-3 gap-4 mb-6">
            <!-- VDOT 값 -->
            <div class="bg-gradient-to-r from-purple-500 to-purple-600 rounded-lg p-4 text-white">
              <div class="text-sm opacity-90 mb-1">VDOT 지수</div>
              <div class="text-3xl font-bold" id="vdotValue">-</div>
              <div class="text-xs opacity-80 mt-1" id="vdotLevel">-</div>
            </div>
            
            <!-- VO2max -->
            <div class="bg-gradient-to-r from-blue-500 to-blue-600 rounded-lg p-4 text-white">
              <div class="text-sm opacity-90 mb-1">추정 VO₂max</div>
              <div class="text-3xl font-bold" id="vo2maxValue">-</div>
              <div class="text-xs opacity-80 mt-1">ml/kg/min</div>
            </div>
            
            <!-- 훈련 강도 -->
            <div class="bg-gradient-to-r from-green-500 to-green-600 rounded-lg p-4 text-white">
              <div class="text-sm opacity-90 mb-1">주간 권장 거리</div>
              <div class="text-3xl font-bold" id="weeklyMileage">-</div>
              <div class="text-xs opacity-80 mt-1">km/week</div>
            </div>
          </div>
          
          <!-- 예상 기록 테이블 -->
          <h3 class="text-lg font-bold mb-3">
            <i class="fas fa-trophy text-yellow-500 mr-2"></i>
            동일 VDOT 기준 예상 기록
          </h3>
          <div class="overflow-x-auto">
            <table class="w-full">
              <thead>
                <tr class="bg-gray-100">
                  <th class="px-4 py-2 text-left">거리</th>
                  <th class="px-4 py-2 text-center">예상 기록</th>
                  <th class="px-4 py-2 text-center">km 페이스</th>
                  <th class="px-4 py-2 text-center">달성률</th>
                </tr>
              </thead>
              <tbody id="predictedTimesTable" class="divide-y">
                <!-- JavaScript로 채워짐 -->
              </tbody>
            </table>
          </div>
        </div>

        <!-- 5가지 훈련 구간 -->
        <div class="bg-white rounded-xl shadow-lg p-6 mb-8">
          <h2 class="text-2xl font-bold mb-6 flex items-center gap-2">
            <i class="fas fa-tachometer-alt text-red-500"></i>
            훈련 구간별 페이스
          </h2>
          
          <div class="grid md:grid-cols-5 gap-4 mb-6" id="trainingZones">
            <!-- E (Easy) -->
            <div class="zone-card bg-gradient-to-b from-green-500 to-green-600 rounded-lg p-4 text-white">
              <div class="text-xs opacity-90 mb-1">E (Easy)</div>
              <div class="text-2xl font-bold mb-2" id="easyPace">-</div>
              <div class="text-xs opacity-80">회복/지구력</div>
              <div class="text-xs opacity-80 mt-1">65-79% HRmax</div>
            </div>
            
            <!-- M (Marathon) -->
            <div class="zone-card bg-gradient-to-b from-blue-500 to-blue-600 rounded-lg p-4 text-white">
              <div class="text-xs opacity-90 mb-1">M (Marathon)</div>
              <div class="text-2xl font-bold mb-2" id="marathonPace">-</div>
              <div class="text-xs opacity-80">마라톤 페이스</div>
              <div class="text-xs opacity-80 mt-1">80-90% HRmax</div>
            </div>
            
            <!-- T (Threshold) -->
            <div class="zone-card bg-gradient-to-b from-yellow-500 to-orange-600 rounded-lg p-4 text-white">
              <div class="text-xs opacity-90 mb-1">T (Threshold)</div>
              <div class="text-2xl font-bold mb-2" id="thresholdPace">-</div>
              <div class="text-xs opacity-80">젖산역치</div>
              <div class="text-xs opacity-80 mt-1">88-92% HRmax</div>
            </div>
            
            <!-- I (Interval) -->
            <div class="zone-card bg-gradient-to-b from-red-500 to-red-600 rounded-lg p-4 text-white">
              <div class="text-xs opacity-90 mb-1">I (Interval)</div>
              <div class="text-2xl font-bold mb-2" id="intervalPace">-</div>
              <div class="text-xs opacity-80">VO₂max</div>
              <div class="text-xs opacity-80 mt-1">95-100% HRmax</div>
            </div>
            
            <!-- R (Repetition) -->
            <div class="zone-card bg-gradient-to-b from-purple-500 to-purple-600 rounded-lg p-4 text-white">
              <div class="text-xs opacity-90 mb-1">R (Repetition)</div>
              <div class="text-2xl font-bold mb-2" id="repetitionPace">-</div>
              <div class="text-xs opacity-80">스피드/폼</div>
              <div class="text-xs opacity-80 mt-1">효율성 중심</div>
            </div>
          </div>
          
          <!-- 상세 훈련 가이드 -->
          <div class="bg-gray-50 rounded-lg p-6">
            <h3 class="text-lg font-bold mb-4">
              <i class="fas fa-clipboard-list text-purple-600 mr-2"></i>
              훈련 구간별 상세 가이드
            </h3>
            
            <div class="space-y-4" id="trainingGuide">
              <!-- Easy -->
              <div class="flex gap-4 p-4 bg-white rounded-lg border-l-4 border-green-500">
                <div class="text-green-500 text-2xl">
                  <i class="fas fa-walking"></i>
                </div>
                <div class="flex-1">
                  <h4 class="font-bold mb-1">E (Easy) - 편안한 페이스</h4>
                  <p class="text-sm text-gray-700 mb-2">회복 및 기초 지구력 향상을 위한 훈련</p>
                  <div class="grid md:grid-cols-3 gap-2 text-xs">
                    <div class="bg-gray-50 p-2 rounded">
                      <span class="font-semibold">훈련량:</span> 주간 거리의 25-30%
                    </div>
                    <div class="bg-gray-50 p-2 rounded">
                      <span class="font-semibold">지속시간:</span> 30분-2시간
                    </div>
                    <div class="bg-gray-50 p-2 rounded">
                      <span class="font-semibold">목적:</span> 회복, 유산소 기초
                    </div>
                  </div>
                </div>
              </div>
              
              <!-- Marathon -->
              <div class="flex gap-4 p-4 bg-white rounded-lg border-l-4 border-blue-500">
                <div class="text-blue-500 text-2xl">
                  <i class="fas fa-running"></i>
                </div>
                <div class="flex-1">
                  <h4 class="font-bold mb-1">M (Marathon) - 마라톤 페이스</h4>
                  <p class="text-sm text-gray-700 mb-2">목표 마라톤 페이스 적응 훈련</p>
                  <div class="grid md:grid-cols-3 gap-2 text-xs">
                    <div class="bg-gray-50 p-2 rounded">
                      <span class="font-semibold">훈련량:</span> 주간 거리의 15-20%
                    </div>
                    <div class="bg-gray-50 p-2 rounded">
                      <span class="font-semibold">지속시간:</span> 40분-2시간 30분
                    </div>
                    <div class="bg-gray-50 p-2 rounded">
                      <span class="font-semibold">목적:</span> 레이스 페이스 적응
                    </div>
                  </div>
                </div>
              </div>
              
              <!-- Threshold -->
              <div class="flex gap-4 p-4 bg-white rounded-lg border-l-4 border-orange-500">
                <div class="text-orange-500 text-2xl">
                  <i class="fas fa-heartbeat"></i>
                </div>
                <div class="flex-1">
                  <h4 class="font-bold mb-1">T (Threshold) - 젖산역치 페이스</h4>
                  <p class="text-sm text-gray-700 mb-2">젖산 처리 능력 향상을 위한 템포런</p>
                  <div class="grid md:grid-cols-3 gap-2 text-xs">
                    <div class="bg-gray-50 p-2 rounded">
                      <span class="font-semibold">훈련량:</span> 주간 거리의 10%
                    </div>
                    <div class="bg-gray-50 p-2 rounded">
                      <span class="font-semibold">지속시간:</span> 20-60분
                    </div>
                    <div class="bg-gray-50 p-2 rounded">
                      <span class="font-semibold">목적:</span> 젖산 역치 향상
                    </div>
                  </div>
                </div>
              </div>
              
              <!-- Interval -->
              <div class="flex gap-4 p-4 bg-white rounded-lg border-l-4 border-red-500">
                <div class="text-red-500 text-2xl">
                  <i class="fas fa-bolt"></i>
                </div>
                <div class="flex-1">
                  <h4 class="font-bold mb-1">I (Interval) - 인터벌 페이스</h4>
                  <p class="text-sm text-gray-700 mb-2">최대 산소섭취량(VO₂max) 향상</p>
                  <div class="grid md:grid-cols-3 gap-2 text-xs">
                    <div class="bg-gray-50 p-2 rounded">
                      <span class="font-semibold">훈련량:</span> 주간 거리의 8%
                    </div>
                    <div class="bg-gray-50 p-2 rounded">
                      <span class="font-semibold">반복:</span> 3-5분 x 4-6회
                    </div>
                    <div class="bg-gray-50 p-2 rounded">
                      <span class="font-semibold">휴식:</span> 운동시간의 50-90%
                    </div>
                  </div>
                </div>
              </div>
              
              <!-- Repetition -->
              <div class="flex gap-4 p-4 bg-white rounded-lg border-l-4 border-purple-500">
                <div class="text-purple-500 text-2xl">
                  <i class="fas fa-rocket"></i>
                </div>
                <div class="flex-1">
                  <h4 class="font-bold mb-1">R (Repetition) - 반복 페이스</h4>
                  <p class="text-sm text-gray-700 mb-2">스피드와 러닝 효율성 향상</p>
                  <div class="grid md:grid-cols-3 gap-2 text-xs">
                    <div class="bg-gray-50 p-2 rounded">
                      <span class="font-semibold">훈련량:</span> 주간 거리의 5%
                    </div>
                    <div class="bg-gray-50 p-2 rounded">
                      <span class="font-semibold">반복:</span> 200-600m x 6-10회
                    </div>
                    <div class="bg-gray-50 p-2 rounded">
                      <span class="font-semibold">휴식:</span> 완전 회복
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- 주간 훈련 계획 예시 -->
        <div class="bg-white rounded-xl shadow-lg p-6 mb-8">
          <h2 class="text-2xl font-bold mb-6 flex items-center gap-2">
            <i class="fas fa-calendar-alt text-green-500"></i>
            주간 훈련 계획 예시
          </h2>
          
          <div class="overflow-x-auto">
            <table class="w-full" id="weeklyPlanTable">
              <thead>
                <tr class="bg-gray-100">
                  <th class="px-4 py-2 text-left">요일</th>
                  <th class="px-4 py-2 text-left">훈련 내용</th>
                  <th class="px-4 py-2 text-center">거리</th>
                  <th class="px-4 py-2 text-center">강도</th>
                  <th class="px-4 py-2 text-left">세부사항</th>
                </tr>
              </thead>
              <tbody class="divide-y">
                <!-- JavaScript로 채워짐 -->
              </tbody>
            </table>
          </div>
        </div>

        <!-- 트랙 훈련 세트 -->
        <div class="bg-white rounded-xl shadow-lg p-6 mb-8">
          <h2 class="text-2xl font-bold mb-6 flex items-center gap-2">
            <i class="fas fa-stopwatch text-purple-500"></i>
            트랙 훈련 세트 (400m 기준)
          </h2>
          
          <div class="grid md:grid-cols-2 gap-6">
            <!-- 인터벌 세트 -->
            <div class="bg-gradient-to-r from-red-50 to-orange-50 rounded-lg p-4 border border-red-200">
              <h3 class="font-bold text-lg mb-3 text-red-700">
                <i class="fas fa-fire mr-2"></i>인터벌 훈련 세트
              </h3>
              <div class="space-y-2 text-sm" id="intervalSets">
                <!-- JavaScript로 채워짐 -->
              </div>
            </div>
            
            <!-- 반복 훈련 세트 -->
            <div class="bg-gradient-to-r from-purple-50 to-pink-50 rounded-lg p-4 border border-purple-200">
              <h3 class="font-bold text-lg mb-3 text-purple-700">
                <i class="fas fa-redo mr-2"></i>반복 훈련 세트
              </h3>
              <div class="space-y-2 text-sm" id="repetitionSets">
                <!-- JavaScript로 채워짐 -->
              </div>
            </div>
          </div>
        </div>

        <!-- 심박수 가이드 -->
        <div class="bg-white rounded-xl shadow-lg p-6 mb-8">
          <h2 class="text-2xl font-bold mb-6 flex items-center gap-2">
            <i class="fas fa-heartbeat text-red-500"></i>
            심박수 훈련 가이드
          </h2>
          
          <div class="mb-4">
            <label class="block text-sm font-semibold text-gray-700 mb-2">나이 입력 (선택사항)</label>
            <div class="flex gap-2 items-center">
              <input type="number" id="ageInput" min="10" max="100" placeholder="예: 30" 
                     class="w-32 px-3 py-2 border-2 border-gray-200 rounded-lg focus:border-purple-500 focus:outline-none">
              <button onclick="calculateHeartRateZones()" 
                      class="bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 transition">
                심박수 구간 계산
              </button>
            </div>
          </div>
          
          <div id="heartRateZones" class="hidden">
            <div class="grid md:grid-cols-5 gap-3">
              <!-- JavaScript로 채워짐 -->
            </div>
          </div>
        </div>

        <!-- 훈련 팁 -->
        <div class="bg-gradient-to-r from-yellow-50 to-orange-50 rounded-xl p-6 border-l-4 border-yellow-500">
          <h3 class="text-lg font-bold mb-3 flex items-center gap-2">
            <i class="fas fa-lightbulb text-yellow-600"></i>
            과학적 훈련 원칙
          </h3>
          <ul class="space-y-2 text-gray-700">
            <li class="flex items-start gap-2">
              <i class="fas fa-check text-green-500 mt-1"></i>
              <span><strong>점진적 과부하:</strong> 매주 주간 거리를 10% 이하로 증가시키세요.</span>
            </li>
            <li class="flex items-start gap-2">
              <i class="fas fa-check text-green-500 mt-1"></i>
              <span><strong>80/20 원칙:</strong> 전체 훈련의 80%는 Easy 페이스, 20%는 고강도로 구성하세요.</span>
            </li>
            <li class="flex items-start gap-2">
              <i class="fas fa-check text-green-500 mt-1"></i>
              <span><strong>회복의 중요성:</strong> 고강도 훈련 후 최소 48시간의 회복 시간을 가지세요.</span>
            </li>
            <li class="flex items-start gap-2">
              <i class="fas fa-check text-green-500 mt-1"></i>
              <span><strong>주기화:</strong> 3주 증가, 1주 감량의 패턴으로 훈련량을 조절하세요.</span>
            </li>
            <li class="flex items-start gap-2">
              <i class="fas fa-check text-green-500 mt-1"></i>
              <span><strong>개인차 고려:</strong> VDOT은 가이드라인입니다. 몸 상태에 따라 조절하세요.</span>
            </li>
          </ul>
        </div>
      </div>

      <!-- 푸터 -->
      <div class="mt-12 text-center text-gray-600 text-sm">
        <p class="mb-2">
          <i class="fas fa-info-circle mr-1"></i>
          본 계산기는 Jack Daniels의 'Daniels' Running Formula'를 기반으로 제작되었습니다.
        </p>
        <p class="font-semibold">
          제작: 장호준 코치 | Athlete Time
        </p>
      </div>
    </div>
  </div>

  <script>
    // VDOT 테이블 (Jack Daniels' Running Formula 기반)
    const vdotTable = [
      {vdot: 30, times: {800: 330, 1500: 690, 3000: 1470, 5000: 2570, 10000: 5340, 21097.5: 11760, 42195: 24480}},
      {vdot: 35, times: {800: 294, 1500: 615, 3000: 1302, 5000: 2260, 10000: 4680, 21097.5: 10260, 42195: 21300}},
      {vdot: 40, times: {800: 264, 1500: 552, 3000: 1164, 5000: 2010, 10000: 4140, 21097.5: 9030, 42195: 18690}},
      {vdot: 45, times: {800: 240, 1500: 498, 3000: 1048, 5000: 1800, 10000: 3690, 21097.5: 8010, 42195: 16530}},
      {vdot: 50, times: {800: 218, 1500: 453, 3000: 949, 5000: 1620, 10000: 3310, 21097.5: 7150, 42195: 14730}},
      {vdot: 55, times: {800: 200, 1500: 414, 3000: 864, 5000: 1470, 10000: 2990, 21097.5: 6430, 42195: 13210}},
      {vdot: 60, times: {800: 184, 1500: 380, 3000: 790, 5000: 1340, 10000: 2710, 21097.5: 5810, 42195: 11910}},
      {vdot: 65, times: {800: 170, 1500: 350, 3000: 725, 5000: 1225, 10000: 2470, 21097.5: 5280, 42195: 10800}},
      {vdot: 70, times: {800: 157, 1500: 323, 3000: 668, 5000: 1125, 10000: 2260, 21097.5: 4820, 42195: 9840}},
      {vdot: 75, times: {800: 146, 1500: 300, 3000: 617, 5000: 1037, 10000: 2080, 21097.5: 4420, 42195: 9000}},
      {vdot: 80, times: {800: 136, 1500: 278, 3000: 572, 5000: 960, 10000: 1920, 21097.5: 4070, 42195: 8270}},
      {vdot: 85, times: {800: 127, 1500: 259, 3000: 531, 5000: 890, 10000: 1775, 21097.5: 3760, 42195: 7630}}
    ];

    // 훈련 페이스 계산 함수
    function getTrainingPaces(vdot) {
      // Jack Daniels 공식 기반 페이스 계산 (km당 초)
      return {
        easy: Math.round((-3.8 * vdot + 540)),  // E 페이스
        marathon: Math.round((-3.5 * vdot + 475)),  // M 페이스
        threshold: Math.round((-3.0 * vdot + 410)),  // T 페이스
        interval: Math.round((-2.5 * vdot + 355)),  // I 페이스
        repetition: Math.round((-2.2 * vdot + 320))  // R 페이스
      };
    }

    // VDOT 계산 함수
    function calculateVDOT(distance, seconds) {
      let closestVdot = 30;
      let smallestDiff = Number.MAX_VALUE;

      for (const entry of vdotTable) {
        if (entry.times[distance]) {
          const diff = Math.abs(entry.times[distance] - seconds);
          if (diff < smallestDiff) {
            smallestDiff = diff;
            closestVdot = entry.vdot;
          }
        }
      }

      // 보간법을 이용한 정확한 VDOT 계산
      const index = vdotTable.findIndex(v => v.vdot === closestVdot);
      if (index > 0 && index < vdotTable.length - 1) {
        const prev = vdotTable[index - 1];
        const curr = vdotTable[index];
        const next = vdotTable[index + 1];
        
        if (seconds > curr.times[distance] && prev.times[distance]) {
          const ratio = (seconds - curr.times[distance]) / (prev.times[distance] - curr.times[distance]);
          closestVdot = curr.vdot - (ratio * 5);
        } else if (seconds < curr.times[distance] && next.times[distance]) {
          const ratio = (curr.times[distance] - seconds) / (curr.times[distance] - next.times[distance]);
          closestVdot = curr.vdot + (ratio * 5);
        }
      }

      return Math.round(closestVdot * 10) / 10;
    }

    // 페이스 포맷팅 함수
    function formatPace(secondsPerKm) {
      const minutes = Math.floor(secondsPerKm / 60);
      const seconds = Math.floor(secondsPerKm % 60);
      return `${minutes}:${seconds.toString().padStart(2, '0')}`;
    }

    // 시간 포맷팅 함수
    function formatTime(seconds) {
      const hours = Math.floor(seconds / 3600);
      const mins = Math.floor((seconds % 3600) / 60);
      const secs = Math.floor(seconds % 60);
      
      if (hours > 0) {
        return `${hours}:${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
      } else {
        return `${mins}:${secs.toString().padStart(2, '0')}`;
      }
    }

    // VDOT 레벨 판정
    function getVDOTLevel(vdot) {
      if (vdot >= 80) return "세계 엘리트";
      if (vdot >= 70) return "국가대표급";
      if (vdot >= 60) return "엘리트";
      if (vdot >= 55) return "준엘리트";
      if (vdot >= 50) return "상급";
      if (vdot >= 45) return "중상급";
      if (vdot >= 40) return "중급";
      if (vdot >= 35) return "초중급";
      if (vdot >= 30) return "초급";
      return "입문";
    }

    // 메인 계산 함수
    function calculateTrainingPaces() {
      const distance = parseFloat(document.getElementById('distanceSelect').value);
      const hours = parseInt(document.getElementById('hours').value) || 0;
      const minutes = parseInt(document.getElementById('minutes').value) || 0;
      const seconds = parseInt(document.getElementById('seconds').value) || 0;
      
      if (!distance) {
        alert('거리를 선택해주세요.');
        return;
      }
      
      if (hours === 0 && minutes === 0 && seconds === 0) {
        alert('기록을 입력해주세요.');
        return;
      }
      
      const totalSeconds = hours * 3600 + minutes * 60 + seconds;
      const vdot = calculateVDOT(distance, totalSeconds);
      const paces = getTrainingPaces(vdot);
      
      // VDOT 정보 표시
      document.getElementById('vdotValue').textContent = vdot.toFixed(1);
      document.getElementById('vdotLevel').textContent = getVDOTLevel(vdot);
      document.getElementById('vo2maxValue').textContent = (vdot * 1.15).toFixed(1);
      
      // 주간 권장 거리 계산 (VDOT 기반)
      let weeklyKm = 30;  // 기본값
      if (vdot >= 70) weeklyKm = 120;
      else if (vdot >= 60) weeklyKm = 100;
      else if (vdot >= 50) weeklyKm = 80;
      else if (vdot >= 45) weeklyKm = 60;
      else if (vdot >= 40) weeklyKm = 50;
      else if (vdot >= 35) weeklyKm = 40;
      
      document.getElementById('weeklyMileage').textContent = weeklyKm + '-' + (weeklyKm + 20);
      
      // 훈련 페이스 표시
      document.getElementById('easyPace').textContent = formatPace(paces.easy) + '/km';
      document.getElementById('marathonPace').textContent = formatPace(paces.marathon) + '/km';
      document.getElementById('thresholdPace').textContent = formatPace(paces.threshold) + '/km';
      document.getElementById('intervalPace').textContent = formatPace(paces.interval) + '/km';
      document.getElementById('repetitionPace').textContent = formatPace(paces.repetition) + '/km';
      
      // 예상 기록 테이블 생성
      generatePredictedTimes(vdot, distance, totalSeconds);
      
      // 주간 훈련 계획 생성
      generateWeeklyPlan(paces, weeklyKm);
      
      // 트랙 훈련 세트 생성
      generateTrackSets(paces);
      
      // 결과 섹션 표시
      document.getElementById('resultsSection').classList.remove('hidden');
      
      // 스크롤
      document.getElementById('resultsSection').scrollIntoView({ behavior: 'smooth', block: 'start' });
    }

    // 예상 기록 테이블 생성
    function generatePredictedTimes(vdot, actualDistance, actualTime) {
      const tbody = document.getElementById('predictedTimesTable');
      const distances = [
        {dist: 800, name: '800m'},
        {dist: 1500, name: '1500m'},
        {dist: 3000, name: '3000m'},
        {dist: 5000, name: '5km'},
        {dist: 10000, name: '10km'},
        {dist: 21097.5, name: '하프마라톤'},
        {dist: 42195, name: '풀마라톤'}
      ];
      
      tbody.innerHTML = '';
      
      // VDOT 테이블에서 가장 가까운 값 찾기
      let closestIndex = 0;
      let minDiff = Math.abs(vdotTable[0].vdot - vdot);
      for (let i = 1; i < vdotTable.length; i++) {
        const diff = Math.abs(vdotTable[i].vdot - vdot);
        if (diff < minDiff) {
          minDiff = diff;
          closestIndex = i;
        }
      }
      
      const vdotEntry = vdotTable[closestIndex];
      
      distances.forEach(d => {
        const predictedTime = vdotEntry.times[d.dist];
        const pace = (predictedTime / (d.dist / 1000));
        const isActual = d.dist === actualDistance;
        
        const row = `
          <tr class="${isActual ? 'bg-yellow-50 font-bold' : ''}">
            <td class="px-4 py-2">${d.name} ${isActual ? '(입력)' : ''}</td>
            <td class="px-4 py-2 text-center">${formatTime(predictedTime)}</td>
            <td class="px-4 py-2 text-center">${formatPace(pace)}</td>
            <td class="px-4 py-2 text-center">
              ${isActual ? '100%' : Math.round((actualTime / predictedTime) * 100) + '%'}
            </td>
          </tr>
        `;
        tbody.innerHTML += row;
      });
    }

    // 주간 훈련 계획 생성
    function generateWeeklyPlan(paces, weeklyKm) {
      const tbody = document.querySelector('#weeklyPlanTable tbody');
      const weekPlan = [
        {
          day: '월요일',
          type: 'Easy Run',
          distance: Math.round(weeklyKm * 0.15),
          intensity: 'E',
          detail: `편안한 페이스 ${formatPace(paces.easy)}/km로 유지`
        },
        {
          day: '화요일',
          type: 'Interval Training',
          distance: Math.round(weeklyKm * 0.12),
          intensity: 'I',
          detail: `워밍업 2km + 1000m x 4 (${formatPace(paces.interval)}/km) + 쿨다운 2km`
        },
        {
          day: '수요일',
          type: 'Recovery Run',
          distance: Math.round(weeklyKm * 0.10),
          intensity: 'E',
          detail: `회복 목적, ${formatPace(paces.easy + 20)}/km 천천히`
        },
        {
          day: '목요일',
          type: 'Tempo Run',
          distance: Math.round(weeklyKm * 0.15),
          intensity: 'T',
          detail: `워밍업 2km + Tempo ${Math.round(weeklyKm * 0.08)}km (${formatPace(paces.threshold)}/km) + 쿨다운 2km`
        },
        {
          day: '금요일',
          type: 'Rest / Cross Training',
          distance: 0,
          intensity: '-',
          detail: '완전 휴식 또는 수영/자전거 30-45분'
        },
        {
          day: '토요일',
          type: 'Long Run',
          distance: Math.round(weeklyKm * 0.30),
          intensity: 'E/M',
          detail: `장거리 주, ${formatPace(paces.easy)}-${formatPace(paces.marathon)}/km`
        },
        {
          day: '일요일',
          type: 'Easy Run',
          distance: Math.round(weeklyKm * 0.18),
          intensity: 'E',
          detail: `편안하게 회복 목적 ${formatPace(paces.easy)}/km`
        }
      ];
      
      tbody.innerHTML = '';
      weekPlan.forEach(plan => {
        const intensityColor = {
          'E': 'bg-green-100',
          'M': 'bg-blue-100',
          'T': 'bg-yellow-100',
          'I': 'bg-red-100',
          'E/M': 'bg-blue-100',
          '-': 'bg-gray-100'
        };
        
        const row = `
          <tr>
            <td class="px-4 py-2 font-semibold">${plan.day}</td>
            <td class="px-4 py-2">${plan.type}</td>
            <td class="px-4 py-2 text-center">${plan.distance > 0 ? plan.distance + 'km' : '-'}</td>
            <td class="px-4 py-2 text-center">
              <span class="px-2 py-1 rounded text-xs font-bold ${intensityColor[plan.intensity]}">
                ${plan.intensity}
              </span>
            </td>
            <td class="px-4 py-2 text-sm text-gray-600">${plan.detail}</td>
          </tr>
        `;
        tbody.innerHTML += row;
      });
    }

    // 트랙 훈련 세트 생성
    function generateTrackSets(paces) {
      const intervalDiv = document.getElementById('intervalSets');
      const repetitionDiv = document.getElementById('repetitionSets');
      
      // 400m 랩타임 계산
      const interval400 = Math.round(paces.interval * 0.4);
      const repetition400 = Math.round(paces.repetition * 0.4);
      const repetition200 = Math.round(paces.repetition * 0.2);
      
      // 인터벌 세트
      intervalDiv.innerHTML = `
        <div class="p-3 bg-white rounded border border-red-200">
          <strong>400m x 10-12</strong><br>
          랩타임: ${formatTime(interval400)} / 휴식: 60-90초
        </div>
        <div class="p-3 bg-white rounded border border-red-200">
          <strong>800m x 5-6</strong><br>
          랩타임: ${formatTime(interval400 * 2)} / 휴식: 2-3분
        </div>
        <div class="p-3 bg-white rounded border border-red-200">
          <strong>1000m x 4-5</strong><br>
          랩타임: ${formatTime(paces.interval * 1)} / 휴식: 3분
        </div>
        <div class="p-3 bg-white rounded border border-red-200">
          <strong>1200m x 4</strong><br>
          랩타임: ${formatTime(paces.interval * 1.2)} / 휴식: 3-4분
        </div>
      `;
      
      // 반복 훈련 세트
      repetitionDiv.innerHTML = `
        <div class="p-3 bg-white rounded border border-purple-200">
          <strong>200m x 8-10</strong><br>
          랩타임: ${formatTime(repetition200)} / 휴식: 완전회복
        </div>
        <div class="p-3 bg-white rounded border border-purple-200">
          <strong>300m x 6-8</strong><br>
          랩타임: ${formatTime(repetition400 * 0.75)} / 휴식: 3-4분
        </div>
        <div class="p-3 bg-white rounded border border-purple-200">
          <strong>400m x 6-8</strong><br>
          랩타임: ${formatTime(repetition400)} / 휴식: 완전회복
        </div>
        <div class="p-3 bg-white rounded border border-purple-200">
          <strong>600m x 4-6</strong><br>
          랩타임: ${formatTime(paces.repetition * 0.6)} / 휴식: 5분
        </div>
      `;
    }

    // 심박수 구간 계산
    function calculateHeartRateZones() {
      const age = parseInt(document.getElementById('ageInput').value);
      
      if (!age || age < 10 || age > 100) {
        alert('올바른 나이를 입력해주세요 (10-100세)');
        return;
      }
      
      const maxHR = 220 - age;
      const zones = [
        {
          name: 'Easy',
          color: 'green',
          min: Math.round(maxHR * 0.65),
          max: Math.round(maxHR * 0.79),
          purpose: '회복/지구력'
        },
        {
          name: 'Marathon',
          color: 'blue',
          min: Math.round(maxHR * 0.80),
          max: Math.round(maxHR * 0.90),
          purpose: '마라톤 페이스'
        },
        {
          name: 'Threshold',
          color: 'orange',
          min: Math.round(maxHR * 0.88),
          max: Math.round(maxHR * 0.92),
          purpose: '젖산역치'
        },
        {
          name: 'Interval',
          color: 'red',
          min: Math.round(maxHR * 0.95),
          max: maxHR,
          purpose: 'VO₂max'
        },
        {
          name: 'Repetition',
          color: 'purple',
          min: Math.round(maxHR * 0.90),
          max: Math.round(maxHR * 0.95),
          purpose: '스피드/폼'
        }
      ];
      
      const zonesDiv = document.getElementById('heartRateZones');
      zonesDiv.innerHTML = '<h4 class="font-bold mb-3">최대 심박수: ' + maxHR + 'bpm</h4><div class="grid md:grid-cols-5 gap-3">';
      
      zones.forEach(zone => {
        zonesDiv.innerHTML += `
          <div class="bg-${zone.color}-50 border border-${zone.color}-200 rounded-lg p-3">
            <div class="text-sm font-bold text-${zone.color}-700">${zone.name}</div>
            <div class="text-lg font-bold mt-1">${zone.min}-${zone.max}</div>
            <div class="text-xs text-gray-600 mt-1">${zone.purpose}</div>
          </div>
        `;
      });
      
      zonesDiv.innerHTML += '</div>';
      zonesDiv.classList.remove('hidden');
    }

    // 폼 초기화
    function resetForm() {
      document.getElementById('distanceSelect').value = '';
      document.getElementById('hours').value = '';
      document.getElementById('minutes').value = '';
      document.getElementById('seconds').value = '';
      document.getElementById('resultsSection').classList.add('hidden');
      document.getElementById('heartRateZones').classList.add('hidden');
      document.getElementById('ageInput').value = '';
    }

    // 엔터키 이벤트
    document.addEventListener('keypress', function(e) {
      if (e.key === 'Enter') {
        calculateTrainingPaces();
      }
    });
  </script>
</body>
</html>