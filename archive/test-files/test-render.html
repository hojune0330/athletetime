<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Render ë°°í¬ í…ŒìŠ¤íŠ¸</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-900 text-white p-8">
  <div class="max-w-4xl mx-auto">
    <h1 class="text-3xl font-bold mb-8">ğŸš€ Render ë°°í¬ í…ŒìŠ¤íŠ¸</h1>
    
    <div class="space-y-6">
      <!-- API í…ŒìŠ¤íŠ¸ -->
      <div class="bg-gray-800 rounded-lg p-6">
        <h2 class="text-xl font-semibold mb-4">ğŸ“¡ API ì—°ê²° í…ŒìŠ¤íŠ¸</h2>
        <input type="text" id="apiUrl" placeholder="https://athletetime-backend-xxxx.onrender.com" 
          class="w-full p-3 bg-gray-700 rounded mb-4">
        <button onclick="testAPI()" class="bg-blue-500 px-6 py-2 rounded">API í…ŒìŠ¤íŠ¸</button>
        <div id="apiResult" class="mt-4 text-sm"></div>
      </div>

      <!-- WebSocket í…ŒìŠ¤íŠ¸ -->
      <div class="bg-gray-800 rounded-lg p-6">
        <h2 class="text-xl font-semibold mb-4">ğŸ’¬ WebSocket í…ŒìŠ¤íŠ¸</h2>
        <input type="text" id="wsUrl" placeholder="wss://athletetime-backend-xxxx.onrender.com"
          class="w-full p-3 bg-gray-700 rounded mb-4">
        <button onclick="testWebSocket()" class="bg-green-500 px-6 py-2 rounded">WebSocket í…ŒìŠ¤íŠ¸</button>
        <div id="wsResult" class="mt-4 text-sm"></div>
      </div>

      <!-- ë°ì´í„°ë² ì´ìŠ¤ í…ŒìŠ¤íŠ¸ -->
      <div class="bg-gray-800 rounded-lg p-6">
        <h2 class="text-xl font-semibold mb-4">ğŸ—„ï¸ ë°ì´í„°ë² ì´ìŠ¤ í…ŒìŠ¤íŠ¸</h2>
        <button onclick="testDatabase()" class="bg-purple-500 px-6 py-2 rounded">DB í…ŒìŠ¤íŠ¸</button>
        <div id="dbResult" class="mt-4 text-sm"></div>
      </div>
    </div>

    <div class="mt-8 p-4 bg-yellow-900 rounded">
      <p class="text-yellow-200">ğŸ’¡ Render Dashboardì—ì„œ Backend URLì„ ë³µì‚¬í•´ì„œ ìœ„ì— ì…ë ¥í•˜ì„¸ìš”</p>
    </div>
  </div>

  <script>
    async function testAPI() {
      const url = document.getElementById('apiUrl').value || 'https://athletetime-backend.onrender.com';
      const result = document.getElementById('apiResult');
      
      result.innerHTML = 'â³ í…ŒìŠ¤íŠ¸ ì¤‘...';
      
      try {
        const response = await fetch(url + '/api/posts');
        if (response.ok) {
          const data = await response.json();
          result.innerHTML = `âœ… API ì—°ê²° ì„±ê³µ! (${data.length || 0}ê°œ ê²Œì‹œë¬¼)`;
          result.className = 'mt-4 text-sm text-green-400';
        } else {
          result.innerHTML = `âŒ API ì‘ë‹µ ì˜¤ë¥˜: ${response.status}`;
          result.className = 'mt-4 text-sm text-red-400';
        }
      } catch (error) {
        result.innerHTML = `âŒ ì—°ê²° ì‹¤íŒ¨: ${error.message}`;
        result.className = 'mt-4 text-sm text-red-400';
      }
    }

    function testWebSocket() {
      const url = document.getElementById('wsUrl').value || 'wss://athletetime-backend.onrender.com';
      const result = document.getElementById('wsResult');
      
      result.innerHTML = 'â³ ì—°ê²° ì¤‘...';
      
      const ws = new WebSocket(url);
      
      ws.onopen = () => {
        result.innerHTML = 'âœ… WebSocket ì—°ê²° ì„±ê³µ!';
        result.className = 'mt-4 text-sm text-green-400';
        
        ws.send(JSON.stringify({
          type: 'join',
          room: 'test',
          userId: 'test-user',
          nickname: 'í…ŒìŠ¤í„°'
        }));
      };
      
      ws.onerror = (error) => {
        result.innerHTML = `âŒ WebSocket ì˜¤ë¥˜: ${error.message || 'ì—°ê²° ì‹¤íŒ¨'}`;
        result.className = 'mt-4 text-sm text-red-400';
      };
      
      ws.onmessage = (event) => {
        result.innerHTML += `<br>ğŸ“¨ ë©”ì‹œì§€ ìˆ˜ì‹ : ${event.data}`;
      };
      
      setTimeout(() => ws.close(), 5000);
    }

    async function testDatabase() {
      const url = document.getElementById('apiUrl').value || 'https://athletetime-backend.onrender.com';
      const result = document.getElementById('dbResult');
      
      result.innerHTML = 'â³ í…ŒìŠ¤íŠ¸ ì¤‘...';
      
      try {
        const response = await fetch(url + '/api/posts', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({
            category: 'í…ŒìŠ¤íŠ¸',
            title: 'DB í…ŒìŠ¤íŠ¸ ê²Œì‹œë¬¼',
            content: 'ì´ê²ƒì€ í…ŒìŠ¤íŠ¸ì…ë‹ˆë‹¤',
            author: 'í…ŒìŠ¤í„°'
          })
        });
        
        if (response.ok) {
          const data = await response.json();
          result.innerHTML = `âœ… DB ì“°ê¸° ì„±ê³µ! (ID: ${data.id})`;
          result.className = 'mt-4 text-sm text-green-400';
        } else {
          result.innerHTML = `âŒ DB ì˜¤ë¥˜: ${response.status}`;
          result.className = 'mt-4 text-sm text-red-400';
        }
      } catch (error) {
        result.innerHTML = `âŒ DB ì—°ê²° ì‹¤íŒ¨: ${error.message}`;
        result.className = 'mt-4 text-sm text-red-400';
      }
    }
  </script>
</body>
</html>