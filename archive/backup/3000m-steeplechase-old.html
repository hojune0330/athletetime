<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>3000m 장애물 페이스 계산기 | Athlete Time</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Malgun Gothic', '맑은 고딕', sans-serif;
    }
    
    .gradient-bg {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    }
    
    .water-jump-bg {
      background: linear-gradient(135deg, #0891b2 0%, #0e7490 100%);
    }
    
    .barrier-bg {
      background: linear-gradient(135deg, #ea580c 0%, #dc2626 100%);
    }
    
    /* 슬라이더 커스텀 스타일 */
    .custom-slider {
      -webkit-appearance: none;
      appearance: none;
      height: 6px;
      border-radius: 3px;
      background: #e5e7eb;
      outline: none;
      transition: background 0.3s;
    }
    
    .custom-slider::-webkit-slider-thumb {
      -webkit-appearance: none;
      appearance: none;
      width: 20px;
      height: 20px;
      border-radius: 50%;
      background: #8b5cf6;
      cursor: grab;
      box-shadow: 0 2px 6px rgba(0,0,0,0.2);
      transition: all 0.2s;
    }
    
    .custom-slider::-webkit-slider-thumb:hover {
      transform: scale(1.2);
      background: #7c3aed;
    }
    
    .custom-slider::-webkit-slider-thumb:active {
      cursor: grabbing;
      transform: scale(1.1);
    }
    
    .custom-slider::-moz-range-thumb {
      width: 20px;
      height: 20px;
      border-radius: 50%;
      background: #8b5cf6;
      cursor: grab;
      box-shadow: 0 2px 6px rgba(0,0,0,0.2);
      transition: all 0.2s;
    }
    
    .pace-slider { background: linear-gradient(to right, #10b981 0%, #fbbf24 50%, #ef4444 100%); }
    .volume-slider { background: linear-gradient(to right, #3b82f6 0%, #8b5cf6 50%, #ec4899 100%); }
    .intensity-slider { background: linear-gradient(to right, #06b6d4 0%, #f97316 50%, #dc2626 100%); }
    
    .lap-card {
      transition: all 0.3s ease;
      cursor: pointer;
    }
    
    .lap-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 16px rgba(0,0,0,0.1);
    }
    
    .water-jump {
      border: 3px solid #0891b2;
      background: linear-gradient(135deg, rgba(8, 145, 178, 0.1), rgba(14, 116, 144, 0.1));
    }
    
    .regular-barrier {
      border: 3px solid #ea580c;
      background: linear-gradient(135deg, rgba(234, 88, 12, 0.1), rgba(220, 38, 38, 0.1));
    }
  </style>
</head>
<body class="bg-gray-50">
  <div class="max-w-7xl mx-auto p-6">
    <!-- Header -->
    <div class="gradient-bg text-white p-6 rounded-xl mb-6">
      <div class="flex justify-between items-start">
        <div>
          <h1 class="text-3xl font-bold mb-2">3000m 장애물 페이스 계산기</h1>
          <p class="opacity-90">전문 장애물 훈련을 위한 과학적 페이스 분석</p>
        </div>
        <div class="flex gap-2">
          <button onclick="window.location.href='system-documentation.html'" class="bg-white/20 hover:bg-white/30 p-3 rounded-lg transition" title="시스템 문서">
            <i class="fas fa-book text-xl"></i>
          </button>
          <button onclick="window.location.href='index.html'" class="bg-white/20 hover:bg-white/30 p-3 rounded-lg transition" title="홈으로">
            <i class="fas fa-home text-xl"></i>
          </button>
        </div>
      </div>
    </div>

    <!-- Water Jump Configuration -->
    <div class="bg-white rounded-xl shadow-lg p-6 mb-6">
      <h2 class="text-2xl font-bold mb-6 flex items-center">
        <span class="bg-cyan-100 text-cyan-600 w-10 h-10 rounded-full flex items-center justify-center mr-3">
          <i class="fas fa-water"></i>
        </span>
        물 장애물 구성 선택
      </h2>
      
      <div class="grid md:grid-cols-2 gap-4">
        <button onclick="setWaterJumpConfig('standard')" id="config-standard" 
          class="p-4 border-2 rounded-lg transition hover:border-cyan-500 focus:border-cyan-500 focus:bg-cyan-50">
          <div class="font-bold text-lg mb-2">표준 구성 (Standard)</div>
          <div class="text-sm text-gray-600 mb-3">IAAF 공식 대회 규격</div>
          <div class="grid grid-cols-7 gap-1 mb-3">
            <div class="text-center text-xs">
              <div class="water-jump rounded p-2 mb-1">W</div>
              <div>2번</div>
            </div>
            <div class="text-center text-xs">
              <div class="regular-barrier rounded p-2 mb-1">B</div>
              <div>3번</div>
            </div>
            <div class="text-center text-xs">
              <div class="regular-barrier rounded p-2 mb-1">B</div>
              <div>4번</div>
            </div>
            <div class="text-center text-xs">
              <div class="regular-barrier rounded p-2 mb-1">B</div>
              <div>5번</div>
            </div>
            <div class="text-center text-xs">
              <div class="water-jump rounded p-2 mb-1">W</div>
              <div>6번</div>
            </div>
            <!-- 반복 -->
          </div>
          <div class="text-xs text-gray-500">
            • 총 7바퀴 (첫 바퀴 물 장애물 없음)<br>
            • 물 장애물: 7회 (2, 6번 위치)<br>
            • 일반 장애물: 28회
          </div>
        </button>
        
        <button onclick="setWaterJumpConfig('alternative')" id="config-alternative"
          class="p-4 border-2 rounded-lg transition hover:border-cyan-500 focus:border-cyan-500 focus:bg-cyan-50">
          <div class="font-bold text-lg mb-2">대체 구성 (Alternative)</div>
          <div class="text-sm text-gray-600 mb-3">일부 경기장 특수 배치</div>
          <div class="grid grid-cols-7 gap-1 mb-3">
            <div class="text-center text-xs">
              <div class="regular-barrier rounded p-2 mb-1">B</div>
              <div>1번</div>
            </div>
            <div class="text-center text-xs">
              <div class="water-jump rounded p-2 mb-1">W</div>
              <div>3번</div>
            </div>
            <div class="text-center text-xs">
              <div class="regular-barrier rounded p-2 mb-1">B</div>
              <div>4번</div>
            </div>
            <div class="text-center text-xs">
              <div class="regular-barrier rounded p-2 mb-1">B</div>
              <div>5번</div>
            </div>
            <div class="text-center text-xs">
              <div class="water-jump rounded p-2 mb-1">W</div>
              <div>7번</div>
            </div>
            <!-- 반복 -->
          </div>
          <div class="text-xs text-gray-500">
            • 총 7바퀴 (첫 바퀴 물 장애물 없음)<br>
            • 물 장애물: 7회 (3, 7번 위치)<br>
            • 일반 장애물: 28회
          </div>
        </button>
      </div>
    </div>

    <!-- Performance Input -->
    <div class="bg-white rounded-xl shadow-lg p-6 mb-6">
      <h2 class="text-2xl font-bold mb-6 flex items-center">
        <span class="bg-purple-100 text-purple-600 w-10 h-10 rounded-full flex items-center justify-center mr-3">
          <i class="fas fa-stopwatch"></i>
        </span>
        목표 기록 입력
      </h2>
      
      <div class="grid md:grid-cols-3 gap-4">
        <div>
          <label class="block text-sm font-medium mb-2">목표 기록</label>
          <div class="grid grid-cols-3 gap-2">
            <input type="number" id="targetMinutes" placeholder="분" min="7" max="15" 
              class="p-3 border rounded-lg text-center" value="9">
            <input type="number" id="targetSeconds" placeholder="초" min="0" max="59" 
              class="p-3 border rounded-lg text-center" value="30">
            <input type="number" id="targetMillis" placeholder=".00" min="0" max="99" step="1"
              class="p-3 border rounded-lg text-center" value="0">
          </div>
        </div>
        
        <div>
          <label class="block text-sm font-medium mb-2">평지 3000m 기록 (참고)</label>
          <div class="grid grid-cols-3 gap-2">
            <input type="number" id="flatMinutes" placeholder="분" min="7" max="15" 
              class="p-3 border rounded-lg text-center" value="8">
            <input type="number" id="flatSeconds" placeholder="초" min="0" max="59" 
              class="p-3 border rounded-lg text-center" value="45">
            <input type="number" id="flatMillis" placeholder=".00" min="0" max="99" step="1"
              class="p-3 border rounded-lg text-center" value="0">
          </div>
        </div>
        
        <div>
          <label class="block text-sm font-medium mb-2">장애물 손실 계수</label>
          <select id="barrierLoss" class="w-full p-3 border rounded-lg">
            <option value="beginner">초급 (바퀴당 5-7초 손실)</option>
            <option value="intermediate" selected>중급 (바퀴당 3-5초 손실)</option>
            <option value="advanced">상급 (바퀴당 2-3초 손실)</option>
            <option value="elite">엘리트 (바퀴당 1-2초 손실)</option>
          </select>
        </div>
      </div>
      
      <button onclick="calculateSteeplechasePace()" 
        class="mt-6 bg-gradient-to-r from-purple-600 to-pink-600 text-white px-8 py-3 rounded-lg font-semibold hover:shadow-lg transition">
        <i class="fas fa-calculator mr-2"></i>페이스 계산
      </button>
    </div>

    <!-- Fine-Tuning Controls -->
    <div class="bg-white rounded-xl shadow-lg p-6 mb-6">
      <h2 class="text-2xl font-bold mb-6 flex items-center">
        <span class="bg-amber-100 text-amber-600 w-10 h-10 rounded-full flex items-center justify-center mr-3">
          <i class="fas fa-sliders-h"></i>
        </span>
        개별 미세 조정
      </h2>
      
      <div class="space-y-6">
        <!-- 페이스 조정 -->
        <div>
          <div class="flex justify-between items-center mb-2">
            <label class="font-medium flex items-center">
              <i class="fas fa-running text-green-500 mr-2"></i>
              페이스 조정
            </label>
            <span id="paceValue" class="font-bold text-lg">100%</span>
          </div>
          <input type="range" id="paceAdjust" min="85" max="115" value="100" step="0.5"
            class="custom-slider pace-slider w-full" oninput="updateAdjustment('pace')">
          <div class="flex justify-between text-xs text-gray-500 mt-1">
            <span>느리게 (-15%)</span>
            <span>기준</span>
            <span>빠르게 (+15%)</span>
          </div>
        </div>
        
        <!-- 훈련량 조정 -->
        <div>
          <div class="flex justify-between items-center mb-2">
            <label class="font-medium flex items-center">
              <i class="fas fa-chart-line text-blue-500 mr-2"></i>
              훈련량 조정
            </label>
            <span id="volumeValue" class="font-bold text-lg">100%</span>
          </div>
          <input type="range" id="volumeAdjust" min="60" max="140" value="100" step="1"
            class="custom-slider volume-slider w-full" oninput="updateAdjustment('volume')">
          <div class="flex justify-between text-xs text-gray-500 mt-1">
            <span>감소 (-40%)</span>
            <span>기준</span>
            <span>증가 (+40%)</span>
          </div>
        </div>
        
        <!-- 강도 조정 -->
        <div>
          <div class="flex justify-between items-center mb-2">
            <label class="font-medium flex items-center">
              <i class="fas fa-fire text-red-500 mr-2"></i>
              강도 조정
            </label>
            <span id="intensityValue" class="font-bold text-lg">100%</span>
          </div>
          <input type="range" id="intensityAdjust" min="70" max="130" value="100" step="0.5"
            class="custom-slider intensity-slider w-full" oninput="updateAdjustment('intensity')">
          <div class="flex justify-between text-xs text-gray-500 mt-1">
            <span>낮춤 (-30%)</span>
            <span>기준</span>
            <span>높임 (+30%)</span>
          </div>
        </div>
        
        <!-- 리셋 버튼 -->
        <button onclick="resetAdjustments()" 
          class="w-full bg-gray-100 hover:bg-gray-200 text-gray-700 py-2 rounded-lg transition">
          <i class="fas fa-undo mr-2"></i>기본값으로 재설정
        </button>
      </div>
    </div>

    <!-- Results Section -->
    <div id="resultsSection" class="hidden">
      <!-- Lap Split Analysis -->
      <div class="bg-white rounded-xl shadow-lg p-6 mb-6">
        <h3 class="text-xl font-bold mb-4">바퀴별 스플릿 분석</h3>
        <div id="lapSplits" class="grid md:grid-cols-7 gap-3">
          <!-- Lap splits will be inserted here -->
        </div>
        
        <div class="mt-6">
          <canvas id="paceChart" width="400" height="200"></canvas>
        </div>
      </div>

      <!-- Barrier Strategy -->
      <div class="bg-white rounded-xl shadow-lg p-6 mb-6">
        <h3 class="text-xl font-bold mb-4">장애물 통과 전략</h3>
        <div id="barrierStrategy" class="space-y-4">
          <!-- Barrier strategy will be inserted here -->
        </div>
      </div>

      <!-- 9-10 Day Training Cycle -->
      <div class="bg-white rounded-xl shadow-lg p-6 mb-6">
        <h3 class="text-xl font-bold mb-4 flex items-center">
          <i class="fas fa-calendar-alt text-purple-600 mr-2"></i>
          9-10일 훈련 주기 (주간 계획보다 효과적)
        </h3>
        
        <div class="bg-blue-50 border-l-4 border-blue-500 p-4 mb-6">
          <div class="font-semibold text-blue-700 mb-2">
            <i class="fas fa-info-circle mr-2"></i>왜 9-10일 주기인가?
          </div>
          <ul class="text-sm text-gray-700 space-y-1">
            <li>• 7일 주기는 생물학적 리듬과 맞지 않아 피로 누적 발생</li>
            <li>• 9-10일 주기는 초보상(supercompensation) 원리에 최적화</li>
            <li>• 핵심 훈련 후 충분한 회복 시간 확보 (72-96시간)</li>
            <li>• 월간 3회 고강도 훈련으로 부상 위험 감소</li>
            <li>• 엘리트 선수들의 검증된 훈련 패턴</li>
          </ul>
        </div>
        
        <div id="trainingCycle" class="space-y-3">
          <!-- 9-10 day cycle will be inserted here -->
        </div>
      </div>

      <!-- Training Recommendations -->
      <div class="bg-white rounded-xl shadow-lg p-6">
        <h3 class="text-xl font-bold mb-4">장애물 특화 훈련</h3>
        <div id="recommendations" class="grid md:grid-cols-2 gap-4">
          <!-- Recommendations will be inserted here -->
        </div>
      </div>
    </div>

    <!-- Footer with Documentation Link -->
    <div class="text-center mt-8 text-gray-600">
      <div class="mb-4">
        <a href="system-documentation.html" class="inline-flex items-center px-4 py-2 bg-purple-100 hover:bg-purple-200 text-purple-700 rounded-lg transition">
          <i class="fas fa-file-alt mr-2"></i>
          <span class="font-medium">기술 문서 보기</span>
          <span class="text-xs ml-2 bg-purple-200 px-2 py-1 rounded">v2.0</span>
        </a>
      </div>
      <p class="text-sm">제작자: 장호준 코치</p>
      <p class="text-xs mt-1">© 2024 Athlete Time - 과학적 훈련의 시작</p>
    </div>
  </div>

  <script>
    // Configuration
    let waterJumpConfig = 'standard';
    let adjustments = {
      pace: 1.0,
      volume: 1.0,
      intensity: 1.0
    };

    // Exact Daniels-Gilbert VDOT Formula
    function calculateExactVDOT(distanceMeters, timeSeconds) {
      const velocity = distanceMeters / (timeSeconds / 60);
      const time = timeSeconds / 60;
      
      const vo2 = -4.60 + 0.182258 * velocity + 0.000104 * Math.pow(velocity, 2);
      const percentVO2max = 0.8 + 0.1894393 * Math.exp(-0.012778 * time) + 
                            0.2989558 * Math.exp(-0.1932605 * time);
      
      const vdot = vo2 / percentVO2max;
      return Math.max(20, Math.min(90, vdot));
    }

    function setWaterJumpConfig(config) {
      waterJumpConfig = config;
      
      // Update UI
      document.getElementById('config-standard').classList.remove('border-cyan-500', 'bg-cyan-50');
      document.getElementById('config-alternative').classList.remove('border-cyan-500', 'bg-cyan-50');
      
      document.getElementById(`config-${config}`).classList.add('border-cyan-500', 'bg-cyan-50');
    }

    // 전역 변수로 현재 계산 데이터 저장
    let currentTargetSeconds = 0;
    let currentVDOT = 0;
    let currentLossPerLap = 0;
    let currentBarrierLevel = '';

    function updateAdjustment(type) {
      const slider = document.getElementById(`${type}Adjust`);
      const value = parseFloat(slider.value);
      const displayElement = document.getElementById(`${type}Value`);
      
      adjustments[type] = value / 100;
      
      // Update display with color coding
      let color = 'text-gray-700';
      if (value < 95) color = 'text-blue-600';
      else if (value > 105) color = 'text-red-600';
      else if (value < 100) color = 'text-green-600';
      else if (value > 100) color = 'text-orange-600';
      
      displayElement.textContent = value + '%';
      displayElement.className = `font-bold text-lg ${color}`;
      
      // 결과가 표시되어 있으면 즉시 재계산
      if (!document.getElementById('resultsSection').classList.contains('hidden')) {
        realtimeUpdate();
      }
    }

    // 실시간 업데이트 함수
    function realtimeUpdate() {
      if (!currentTargetSeconds || !currentVDOT) return;
      
      // 바퀴별 스플릿 재계산
      generateLapSplits(currentTargetSeconds, currentLossPerLap);
      
      // 장애물 전략 재생성
      generateBarrierStrategy(currentVDOT);
      
      // 9-10일 훈련 주기 재생성
      generate9DayTrainingCycle(currentVDOT);
      
      // 추천사항 재생성
      generateRecommendations(currentVDOT, currentBarrierLevel);
    }

    function resetAdjustments() {
      ['pace', 'volume', 'intensity'].forEach(type => {
        document.getElementById(`${type}Adjust`).value = 100;
        updateAdjustment(type);
      });
    }

    function calculateSteeplechasePace() {
      // Get target time
      const targetMinutes = parseInt(document.getElementById('targetMinutes').value) || 9;
      const targetSeconds = parseInt(document.getElementById('targetSeconds').value) || 30;
      const targetMillis = parseInt(document.getElementById('targetMillis').value) || 0;
      currentTargetSeconds = targetMinutes * 60 + targetSeconds + targetMillis / 100;
      
      // Get flat 3000m time for VDOT calculation
      const flatMinutes = parseInt(document.getElementById('flatMinutes').value) || 8;
      const flatSeconds = parseInt(document.getElementById('flatSeconds').value) || 45;
      const flatMillis = parseInt(document.getElementById('flatMillis').value) || 0;
      const flatTotalSeconds = flatMinutes * 60 + flatSeconds + flatMillis / 100;
      
      // Calculate VDOT from flat 3000m
      currentVDOT = calculateExactVDOT(3000, flatTotalSeconds);
      
      // Get barrier loss factor
      currentBarrierLevel = document.getElementById('barrierLoss').value;
      currentLossPerLap = {
        'beginner': 6,
        'intermediate': 4,
        'advanced': 2.5,
        'elite': 1.5
      }[currentBarrierLevel];
      
      // Calculate lap splits
      generateLapSplits(currentTargetSeconds, currentLossPerLap);
      
      // Generate barrier strategy
      generateBarrierStrategy(currentVDOT);
      
      // Generate 9-10 day training cycle
      generate9DayTrainingCycle(currentVDOT);
      
      // Generate recommendations
      generateRecommendations(currentVDOT, currentBarrierLevel);
      
      // Show results
      document.getElementById('resultsSection').classList.remove('hidden');
      document.getElementById('resultsSection').scrollIntoView({ behavior: 'smooth' });
    }

    function generateLapSplits(totalSeconds, lossPerLap) {
      const lapSplits = document.getElementById('lapSplits');
      const basePacePerLap = (totalSeconds - (7 * lossPerLap)) / 7.5; // 7.5 laps equivalent
      
      const laps = [];
      let cumulativeTime = 0;
      
      // Lap 1: No water jump, slightly faster
      const lap1Time = basePacePerLap * 0.95 * adjustments.pace;
      cumulativeTime += lap1Time;
      laps.push({ lap: 1, time: lap1Time, cumulative: cumulativeTime, hasWater: false });
      
      // Laps 2-7: With barriers and water jumps
      for (let i = 2; i <= 7; i++) {
        const hasWater = (waterJumpConfig === 'standard' && (i === 2 || i === 6)) ||
                        (waterJumpConfig === 'alternative' && (i === 3 || i === 7));
        
        let lapTime = basePacePerLap * adjustments.pace;
        
        // Fatigue factor
        if (i >= 5) lapTime *= 1.02;
        if (i === 7) lapTime *= 1.03;
        
        // Water jump adds more time
        if (hasWater) lapTime += lossPerLap * 1.5;
        else lapTime += lossPerLap;
        
        cumulativeTime += lapTime;
        laps.push({ lap: i, time: lapTime, cumulative: cumulativeTime, hasWater });
      }
      
      // Display lap splits
      lapSplits.innerHTML = laps.map(lap => `
        <div class="lap-card ${lap.hasWater ? 'water-jump' : 'regular-barrier'} p-3 rounded-lg text-center">
          <div class="font-bold text-lg">Lap ${lap.lap}</div>
          ${lap.hasWater ? '<i class="fas fa-water text-cyan-600"></i>' : '<i class="fas fa-running text-orange-600"></i>'}
          <div class="text-sm mt-2">
            <div>${formatTime(lap.time)}</div>
            <div class="text-xs text-gray-600">${formatTime(lap.cumulative)}</div>
          </div>
        </div>
      `).join('');
      
      // Draw pace chart
      drawPaceChart(laps);
    }

    function drawPaceChart(laps) {
      const ctx = document.getElementById('paceChart').getContext('2d');
      
      new Chart(ctx, {
        type: 'line',
        data: {
          labels: laps.map(l => `Lap ${l.lap}`),
          datasets: [{
            label: '바퀴별 시간',
            data: laps.map(l => l.time),
            borderColor: 'rgb(139, 92, 246)',
            backgroundColor: 'rgba(139, 92, 246, 0.1)',
            tension: 0.4
          }]
        },
        options: {
          responsive: true,
          plugins: {
            legend: {
              display: false
            },
            title: {
              display: true,
              text: '바퀴별 페이스 변화'
            }
          },
          scales: {
            y: {
              beginAtZero: false,
              ticks: {
                callback: function(value) {
                  return formatTime(value);
                }
              }
            }
          }
        }
      });
    }

    function generateBarrierStrategy(vdot) {
      const barrierStrategy = document.getElementById('barrierStrategy');
      
      const strategies = [
        {
          title: '장애물 접근',
          icon: 'fa-running',
          tips: [
            '장애물 3-5m 전부터 보폭 조정',
            '마지막 3보는 짧고 빠르게',
            '시선은 장애물 너머 고정',
            '팔 스윙으로 리듬 유지'
          ]
        },
        {
          title: '물 장애물 기술',
          icon: 'fa-water',
          tips: [
            '장애물 위 한발 착지 후 도약',
            '물 착지 지점은 가능한 멀리',
            '착지 후 빠른 가속 필수',
            '물기 있는 신발 고려한 그립'
          ]
        },
        {
          title: '일반 장애물',
          icon: 'fa-th-large',
          tips: [
            '도약 거리 최소화 (에너지 절약)',
            '낮은 무게중심 유지',
            '착지 즉시 다음 보폭 준비',
            '리드 다리는 곧게 펴기'
          ]
        },
        {
          title: '체력 배분',
          icon: 'fa-battery-three-quarters',
          tips: [
            '첫 1000m: 목표 페이스 -2초',
            '중간 1000m: 목표 페이스 유지',
            '마지막 1000m: 남은 체력 소진',
            '물 장애물 후 회복 구간 활용'
          ]
        }
      ];
      
      barrierStrategy.innerHTML = strategies.map(s => `
        <div class="border rounded-lg p-4">
          <h4 class="font-bold text-lg mb-2 text-purple-700">
            <i class="fas ${s.icon} mr-2"></i>${s.title}
          </h4>
          <ul class="text-sm space-y-1">
            ${s.tips.map(tip => `<li class="flex items-start"><span class="text-purple-500 mr-2">•</span>${tip}</li>`).join('')}
          </ul>
        </div>
      `).join('');
    }

    function generate9DayTrainingCycle(vdot) {
      const trainingCycle = document.getElementById('trainingCycle');
      
      // Intensity adjusted cycles
      const cycles = [
        {
          day: 1,
          type: '핵심 장애물 훈련',
          intensity: 'high',
          description: '3-5 x 1000m 장애물 포함, I 페이스',
          volume: Math.round(8 * adjustments.volume),
          details: '완전 회복 between reps'
        },
        {
          day: 2,
          type: '회복 조깅',
          intensity: 'low',
          description: '40-50분 E 페이스',
          volume: Math.round(6 * adjustments.volume),
          details: '심박수 65-70% 유지'
        },
        {
          day: 3,
          type: '임계 훈련',
          intensity: 'medium',
          description: '2 x 20분 T 페이스',
          volume: Math.round(10 * adjustments.volume),
          details: '휴식 3분'
        },
        {
          day: 4,
          type: '적극적 회복',
          intensity: 'rest',
          description: '크로스 트레이닝 또는 휴식',
          volume: 0,
          details: '수영, 자전거 권장'
        },
        {
          day: 5,
          type: '스피드 세션',
          intensity: 'high',
          description: '6-8 x 400m R 페이스',
          volume: Math.round(7 * adjustments.volume),
          details: '장애물 기술 집중'
        },
        {
          day: 6,
          type: '회복런',
          intensity: 'low',
          description: '30-40분 매우 편안하게',
          volume: Math.round(5 * adjustments.volume),
          details: '다음 훈련 준비'
        },
        {
          day: 7,
          type: '장거리',
          intensity: 'medium',
          description: '90-120분 E/M 페이스',
          volume: Math.round(15 * adjustments.volume),
          details: 'Progressive 가능'
        },
        {
          day: 8,
          type: '회복',
          intensity: 'rest',
          description: '완전 휴식 또는 가벼운 조깅',
          volume: Math.round(3 * adjustments.volume),
          details: '마사지, 스트레칭'
        },
        {
          day: 9,
          type: '레이스 시뮬레이션',
          intensity: 'high',
          description: '2000m 장애물 타임트라이얼',
          volume: Math.round(6 * adjustments.volume),
          details: '실전같은 페이스'
        }
      ];
      
      // Add optional day 10
      const day10 = {
        day: 10,
        type: '선택적 회복',
        intensity: 'rest',
        description: '필요시 추가 회복일',
        volume: 0,
        details: '피로도에 따라 결정'
      };
      
      const intensityColors = {
        'high': 'border-red-500 bg-red-50',
        'medium': 'border-orange-500 bg-orange-50',
        'low': 'border-green-500 bg-green-50',
        'rest': 'border-gray-400 bg-gray-50'
      };
      
      const intensityIcons = {
        'high': 'fa-fire text-red-500',
        'medium': 'fa-bolt text-orange-500',
        'low': 'fa-leaf text-green-500',
        'rest': 'fa-bed text-gray-500'
      };
      
      const cycleHTML = cycles.map(day => `
        <div class="border-2 ${intensityColors[day.intensity]} rounded-lg p-4">
          <div class="flex justify-between items-start">
            <div>
              <div class="font-bold text-lg mb-1">Day ${day.day}: ${day.type}</div>
              <div class="text-sm text-gray-700">${day.description}</div>
              <div class="text-xs text-gray-600 mt-1">${day.details}</div>
            </div>
            <div class="text-center">
              <i class="fas ${intensityIcons[day.intensity]} text-2xl mb-1"></i>
              <div class="text-xs font-semibold">${day.volume}km</div>
            </div>
          </div>
        </div>
      `).join('');
      
      trainingCycle.innerHTML = cycleHTML + `
        <div class="border-2 border-dashed ${intensityColors['rest']} rounded-lg p-4 opacity-75">
          <div class="flex justify-between items-start">
            <div>
              <div class="font-bold text-lg mb-1">Day 10: ${day10.type}</div>
              <div class="text-sm text-gray-700">${day10.description}</div>
              <div class="text-xs text-gray-600 mt-1">${day10.details}</div>
            </div>
            <div class="text-center">
              <i class="fas fa-question-circle text-gray-400 text-2xl mb-1"></i>
              <div class="text-xs font-semibold">선택</div>
            </div>
          </div>
        </div>
      `;
    }

    function generateRecommendations(vdot, level) {
      const recommendations = document.getElementById('recommendations');
      
      const recs = [
        {
          title: '장애물 기술 훈련',
          icon: 'fa-graduation-cap',
          items: [
            '주 2-3회 장애물 드릴 (피로하지 않은 상태)',
            '허들 모빌리티 매일 10분',
            '물 장애물 착지 연습 별도 시행',
            '비디오 분석으로 폼 체크'
          ]
        },
        {
          title: '근력 훈련',
          icon: 'fa-dumbbell',
          items: [
            '플라이오메트릭 주 2회',
            '코어 강화 매일 15분',
            '한발 스쿼트, 런지 필수',
            '종아리 강화 (물 장애물 대비)'
          ]
        },
        {
          title: '영양 전략',
          icon: 'fa-apple-alt',
          items: [
            '훈련 2시간 전 탄수화물 섭취',
            '철분 수치 정기 체크',
            '수분 손실 보충 계획',
            '레이스 3일 전 카보로딩'
          ]
        },
        {
          title: '부상 예방',
          icon: 'fa-shield-alt',
          items: [
            '정강이 스트레칭/아이싱',
            '아킬레스건 강화 운동',
            '발목 안정성 훈련',
            '충격 흡수 좋은 신발 선택'
          ]
        }
      ];
      
      recommendations.innerHTML = recs.map(r => `
        <div class="border rounded-lg p-4 bg-gray-50">
          <h4 class="font-bold mb-2 text-purple-700">
            <i class="fas ${r.icon} mr-2"></i>${r.title}
          </h4>
          <ul class="text-sm space-y-1">
            ${r.items.map(item => `<li class="flex items-start"><span class="text-purple-500 mr-2">•</span>${item}</li>`).join('')}
          </ul>
        </div>
      `).join('');
    }

    function formatTime(seconds) {
      const mins = Math.floor(seconds / 60);
      const secs = (seconds % 60).toFixed(1);
      return `${mins}:${secs.padStart(4, '0')}`;
    }

    // Initialize on page load
    document.addEventListener('DOMContentLoaded', function() {
      setWaterJumpConfig('standard');
      resetAdjustments();
    });
  </script>
</body>
</html>