<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ì •í™•í•œ í›ˆë ¨ í˜ì´ìŠ¤ ê³„ì‚°ê¸° | Athlete Time</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Malgun Gothic', 'ë§‘ì€ ê³ ë”•', sans-serif;
    }
    
    .gradient-bg {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    }
    
    .training-zone-easy { 
      background: linear-gradient(135deg, #10b981, #059669); 
    }
    .training-zone-marathon { 
      background: linear-gradient(135deg, #3b82f6, #2563eb); 
    }
    .training-zone-threshold { 
      background: linear-gradient(135deg, #f59e0b, #d97706); 
    }
    .training-zone-interval { 
      background: linear-gradient(135deg, #ef4444, #dc2626); 
    }
    .training-zone-repetition { 
      background: linear-gradient(135deg, #a855f7, #9333ea); 
    }
  </style>
</head>
<body class="bg-gray-50">
  <div class="max-w-7xl mx-auto p-6">
    <!-- Header -->
    <div class="gradient-bg text-white p-6 rounded-xl mb-6">
      <div class="flex justify-between items-start">
        <div>
          <h1 class="text-3xl font-bold mb-2">ğŸ¯ ì •í™•í•œ í›ˆë ¨ í˜ì´ìŠ¤ ê³„ì‚°ê¸°</h1>
          <p class="opacity-90">Daniels-Gilbert ì •í™•í•œ ê³µì‹ ê¸°ë°˜</p>
          <div class="mt-2 bg-white/20 backdrop-blur rounded-lg px-3 py-1 inline-block">
            <span class="text-sm">âœ¨ NEW: ì •í™•í•œ ìˆ˜í•™ ê³µì‹ ì‚¬ìš©</span>
          </div>
        </div>
        <button onclick="window.location.href='index.html'" class="bg-white/20 hover:bg-white/30 p-3 rounded-lg transition">
          <i class="fas fa-home text-xl"></i>
        </button>
      </div>
    </div>

    <!-- ê³µì‹ vs í…Œì´ë¸” ë¹„êµ ì•Œë¦¼ -->
    <div class="bg-yellow-50 border-l-4 border-yellow-400 p-4 rounded-lg mb-6">
      <div class="flex items-start">
        <span class="text-2xl mr-3">âš ï¸</span>
        <div>
          <h3 class="font-bold text-yellow-800">ì´ì „ ë²„ì „ê³¼ì˜ ì°¨ì´ì </h3>
          <p class="text-sm text-yellow-700 mt-1">
            ì´ ê³„ì‚°ê¸°ëŠ” <strong>ì •í™•í•œ Daniels-Gilbert ê³µì‹</strong>ì„ ì‚¬ìš©í•©ë‹ˆë‹¤. 
            ê¸°ì¡´ í…Œì´ë¸” ë°©ì‹ë³´ë‹¤ <strong>2-5% ë” ì •í™•í•œ ê²°ê³¼</strong>ë¥¼ ì œê³µí•©ë‹ˆë‹¤.
          </p>
        </div>
      </div>
    </div>

    <!-- Step 1: ê¸°ë³¸ ì •ë³´ ì…ë ¥ -->
    <div class="bg-white rounded-xl shadow-lg p-6 mb-6">
      <h2 class="text-2xl font-bold mb-6 flex items-center">
        <span class="bg-purple-100 text-purple-600 w-10 h-10 rounded-full flex items-center justify-center mr-3">1</span>
        ê¸°ë³¸ ì •ë³´ & ìµœê·¼ ê¸°ë¡
      </h2>
      
      <div class="grid md:grid-cols-2 gap-6">
        <!-- ê¸°ë³¸ ì •ë³´ -->
        <div>
          <h3 class="font-semibold mb-3 text-gray-700">ğŸ‘¤ ê¸°ë³¸ ì •ë³´</h3>
          
          <div class="grid grid-cols-2 gap-3 mb-4">
            <button onclick="selectGender('male')" id="btn-male" 
              class="p-3 border-2 rounded-lg transition text-center hover:border-purple-500">
              <i class="fas fa-mars text-blue-500 text-xl"></i>
              <div class="text-sm mt-1">ë‚¨ì„±</div>
            </button>
            <button onclick="selectGender('female')" id="btn-female"
              class="p-3 border-2 rounded-lg transition text-center hover:border-purple-500">
              <i class="fas fa-venus text-pink-500 text-xl"></i>
              <div class="text-sm mt-1">ì—¬ì„±</div>
            </button>
          </div>
          
          <div class="mb-4">
            <label class="block text-sm font-medium mb-1">ì—°ë ¹ëŒ€</label>
            <select id="ageGroup" class="w-full border rounded-lg p-2">
              <option value="junior">ì£¼ë‹ˆì–´ (18ì„¸ ë¯¸ë§Œ)</option>
              <option value="senior" selected>ì‹œë‹ˆì–´ (18-39ì„¸)</option>
              <option value="master40">ë§ˆìŠ¤í„°ì¦ˆ 40-49ì„¸</option>
              <option value="master50">ë§ˆìŠ¤í„°ì¦ˆ 50-59ì„¸</option>
              <option value="master60">ë§ˆìŠ¤í„°ì¦ˆ 60ì„¸ ì´ìƒ</option>
            </select>
          </div>
          
          <div class="mb-4">
            <label class="block text-sm font-medium mb-1">í›ˆë ¨ ê²½ë ¥</label>
            <select id="experience" class="w-full border rounded-lg p-2">
              <option value="beginner">ì´ˆê¸‰ì (1ë…„ ë¯¸ë§Œ)</option>
              <option value="intermediate" selected>ì¤‘ê¸‰ì (1-3ë…„)</option>
              <option value="advanced">ê³ ê¸‰ì (3-5ë…„)</option>
              <option value="elite">ì—˜ë¦¬íŠ¸ (5ë…„ ì´ìƒ)</option>
            </select>
          </div>
        </div>
        
        <!-- ê¸°ë¡ ì…ë ¥ -->
        <div>
          <h3 class="font-semibold mb-3 text-gray-700">ğŸƒ ìµœê·¼ ê¸°ë¡ ì…ë ¥</h3>
          
          <div class="mb-4">
            <label class="block text-sm font-medium mb-1">ê±°ë¦¬</label>
            <select id="raceDistance" class="w-full border rounded-lg p-2" onchange="updateDistanceCustom()">
              <option value="800">800m</option>
              <option value="1500">1500m</option>
              <option value="3000">3000m</option>
              <option value="5000" selected>5000m</option>
              <option value="10000">10000m</option>
              <option value="21097.5">í•˜í”„ë§ˆë¼í†¤</option>
              <option value="42195">í’€ë§ˆë¼í†¤</option>
              <option value="custom">ì§ì ‘ ì…ë ¥</option>
            </select>
            <input type="number" id="customDistance" placeholder="ê±°ë¦¬ (m)" 
              class="w-full border rounded-lg p-2 mt-2 hidden">
          </div>
          
          <label class="block text-sm font-medium mb-1">ê¸°ë¡</label>
          <div class="grid grid-cols-3 gap-2">
            <input type="number" id="hours" placeholder="ì‹œ" min="0" max="24"
              class="p-2 border rounded-lg text-center">
            <input type="number" id="minutes" placeholder="ë¶„" min="0" max="59"
              class="p-2 border rounded-lg text-center">
            <input type="number" id="seconds" placeholder="ì´ˆ" min="0" max="59" step="0.1"
              class="p-2 border rounded-lg text-center">
          </div>
        </div>
      </div>
    </div>

    <!-- Step 2: ì˜¤ëŠ˜ ì»¨ë””ì…˜ ì²´í¬ -->
    <div class="bg-white rounded-xl shadow-lg p-6 mb-6">
      <h2 class="text-2xl font-bold mb-6 flex items-center">
        <span class="bg-purple-100 text-purple-600 w-10 h-10 rounded-full flex items-center justify-center mr-3">2</span>
        ì˜¤ëŠ˜ ë‚´ ëª¸ ìƒíƒœëŠ”? ğŸŒŸ
      </h2>
      
      <!-- ì»¨ë””ì…˜ ì„ íƒ -->
      <div class="mb-6">
        <h3 class="font-semibold mb-3 text-gray-700">ğŸ’ª ì˜¤ëŠ˜ ì»¨ë””ì…˜</h3>
        <div class="flex gap-2 flex-wrap">
          <button onclick="setCondition('very-bad')" class="condition-btn px-4 py-3 rounded-lg border-2 transition hover:border-red-400" data-value="very-bad">
            <div class="text-2xl mb-1">ğŸ˜«</div>
            <div class="text-xs font-medium">ìµœì•…ì´ì•¼</div>
            <div class="text-xs text-gray-500">-20%</div>
          </button>
          <button onclick="setCondition('bad')" class="condition-btn px-4 py-3 rounded-lg border-2 transition hover:border-orange-400" data-value="bad">
            <div class="text-2xl mb-1">ğŸ˜”</div>
            <div class="text-xs font-medium">í”¼ê³¤í•´</div>
            <div class="text-xs text-gray-500">-10%</div>
          </button>
          <button onclick="setCondition('normal')" class="condition-btn px-4 py-3 rounded-lg border-2 transition hover:border-gray-400 border-purple-500 bg-purple-50" data-value="normal">
            <div class="text-2xl mb-1">ğŸ˜Š</div>
            <div class="text-xs font-medium">ë³´í†µ</div>
            <div class="text-xs text-gray-500">0%</div>
          </button>
          <button onclick="setCondition('good')" class="condition-btn px-4 py-3 rounded-lg border-2 transition hover:border-green-400" data-value="good">
            <div class="text-2xl mb-1">ğŸ˜„</div>
            <div class="text-xs font-medium">ì¢‹ì•„!</div>
            <div class="text-xs text-gray-500">+5%</div>
          </button>
          <button onclick="setCondition('excellent')" class="condition-btn px-4 py-3 rounded-lg border-2 transition hover:border-green-500" data-value="excellent">
            <div class="text-2xl mb-1">ğŸ¤©</div>
            <div class="text-xs font-medium">ìµœê³ ì•¼!</div>
            <div class="text-xs text-gray-500">+10%</div>
          </button>
        </div>
      </div>

      <!-- ë¯¸ì„¸ ì¡°ì • -->
      <div class="mb-6">
        <h3 class="font-semibold mb-3 text-gray-700">ğŸšï¸ ì„¸ë¶€ ì¡°ì • (ì„ íƒì‚¬í•­)</h3>
        <div class="space-y-4">
          <div>
            <div class="flex justify-between items-center mb-2">
              <label class="text-sm font-medium">í˜ì´ìŠ¤ ì¡°ì •</label>
              <span id="paceAdjustValue" class="text-sm font-bold text-blue-600">0%</span>
            </div>
            <input type="range" id="paceAdjust" min="-20" max="20" value="0" 
              class="w-full accent-blue-600" oninput="updateAdjustment('pace')">
            <div class="flex justify-between text-xs text-gray-500">
              <span>ëŠë¦¬ê²Œ</span>
              <span>ë¹ ë¥´ê²Œ</span>
            </div>
          </div>
          
          <div>
            <div class="flex justify-between items-center mb-2">
              <label class="text-sm font-medium">í›ˆë ¨ëŸ‰ ì¡°ì •</label>
              <span id="volumeAdjustValue" class="text-sm font-bold text-green-600">0%</span>
            </div>
            <input type="range" id="volumeAdjust" min="-30" max="30" value="0" 
              class="w-full accent-green-600" oninput="updateAdjustment('volume')">
            <div class="flex justify-between text-xs text-gray-500">
              <span>ì ê²Œ</span>
              <span>ë§ì´</span>
            </div>
          </div>
        </div>
      </div>

      <button onclick="calculateExactTraining()" 
        class="w-full bg-gradient-to-r from-purple-600 to-pink-600 text-white px-8 py-3 rounded-lg font-semibold hover:shadow-lg transition">
        <i class="fas fa-calculator mr-2"></i>ì •í™•í•œ í›ˆë ¨ ê³„íš ìƒì„±
      </button>
    </div>

    <!-- Results Section (Hidden initially) -->
    <div id="resultsSection" class="hidden">
      <!-- VDOT ê²°ê³¼ -->
      <div class="bg-white rounded-xl shadow-lg p-6 mb-6">
        <h2 class="text-2xl font-bold mb-6">ğŸ“Š VDOT ë¶„ì„ ê²°ê³¼</h2>
        
        <div class="grid md:grid-cols-3 gap-4 mb-6">
          <div class="bg-gradient-to-r from-purple-500 to-purple-600 text-white p-4 rounded-lg">
            <div class="text-sm opacity-90">ì •í™•í•œ VDOT</div>
            <div class="text-3xl font-bold" id="exactVdot">-</div>
            <div class="text-xs mt-1">Daniels-Gilbert ê³µì‹</div>
          </div>
          <div class="bg-gradient-to-r from-blue-500 to-blue-600 text-white p-4 rounded-lg">
            <div class="text-sm opacity-90">ìˆ˜ì¤€</div>
            <div class="text-2xl font-bold" id="level">-</div>
            <div class="text-xs mt-1" id="levelDesc">-</div>
          </div>
          <div class="bg-gradient-to-r from-green-500 to-green-600 text-white p-4 rounded-lg">
            <div class="text-sm opacity-90">ì˜ˆìƒ VOâ‚‚max</div>
            <div class="text-2xl font-bold" id="vo2max">-</div>
            <div class="text-xs mt-1">ml/kg/min</div>
          </div>
        </div>

        <!-- ì •í™•ë„ ë¹„êµ -->
        <div id="accuracyComparison" class="bg-gray-50 p-4 rounded-lg"></div>
      </div>

      <!-- í›ˆë ¨ í˜ì´ìŠ¤ -->
      <div class="bg-white rounded-xl shadow-lg p-6 mb-6">
        <h2 class="text-2xl font-bold mb-6">ğŸƒ í›ˆë ¨ í˜ì´ìŠ¤</h2>
        
        <div class="space-y-3">
          <div class="training-zone-easy text-white p-4 rounded-lg">
            <div class="flex justify-between items-center">
              <div>
                <div class="font-bold text-lg">Easy (E) í˜ì´ìŠ¤</div>
                <div class="text-sm opacity-90">íšŒë³µ & ê¸°ì´ˆ ì²´ë ¥</div>
              </div>
              <div class="text-right">
                <div class="text-2xl font-bold" id="easyPace">-</div>
                <div class="text-xs">65-79% HRmax</div>
              </div>
            </div>
          </div>
          
          <div class="training-zone-marathon text-white p-4 rounded-lg">
            <div class="flex justify-between items-center">
              <div>
                <div class="font-bold text-lg">Marathon (M) í˜ì´ìŠ¤</div>
                <div class="text-sm opacity-90">ë§ˆë¼í†¤ ëª©í‘œ í˜ì´ìŠ¤</div>
              </div>
              <div class="text-right">
                <div class="text-2xl font-bold" id="marathonPace">-</div>
                <div class="text-xs">80-90% HRmax</div>
              </div>
            </div>
          </div>
          
          <div class="training-zone-threshold text-white p-4 rounded-lg">
            <div class="flex justify-between items-center">
              <div>
                <div class="font-bold text-lg">Threshold (T) í˜ì´ìŠ¤</div>
                <div class="text-sm opacity-90">ì –ì‚° ì—­ì¹˜ í–¥ìƒ</div>
              </div>
              <div class="text-right">
                <div class="text-2xl font-bold" id="thresholdPace">-</div>
                <div class="text-xs">88-92% HRmax</div>
              </div>
            </div>
          </div>
          
          <div class="training-zone-interval text-white p-4 rounded-lg">
            <div class="flex justify-between items-center">
              <div>
                <div class="font-bold text-lg">Interval (I) í˜ì´ìŠ¤</div>
                <div class="text-sm opacity-90">VOâ‚‚max í–¥ìƒ</div>
              </div>
              <div class="text-right">
                <div class="text-2xl font-bold" id="intervalPace">-</div>
                <div class="text-xs">95-100% HRmax</div>
              </div>
            </div>
          </div>
          
          <div class="training-zone-repetition text-white p-4 rounded-lg">
            <div class="flex justify-between items-center">
              <div>
                <div class="font-bold text-lg">Repetition (R) í˜ì´ìŠ¤</div>
                <div class="text-sm opacity-90">ìŠ¤í”¼ë“œ & í¼</div>
              </div>
              <div class="text-right">
                <div class="text-2xl font-bold" id="repetitionPace">-</div>
                <div class="text-xs">105% VOâ‚‚max</div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- ì˜ˆìƒ ê¸°ë¡ -->
      <div class="bg-white rounded-xl shadow-lg p-6">
        <h2 class="text-2xl font-bold mb-6">ğŸ¯ ì˜ˆìƒ ë ˆì´ìŠ¤ ê¸°ë¡</h2>
        
        <div class="grid md:grid-cols-4 gap-4" id="racePredictions"></div>
      </div>
    </div>
  </div>

  <script>
    // ==========================================
    // ì •í™•í•œ Daniels-Gilbert ê³µì‹
    // ==========================================
    
    /**
     * ì •í™•í•œ VDOT ê³„ì‚° (Daniels-Gilbert Formula)
     * @param {number} distanceMeters - ê±°ë¦¬ (ë¯¸í„°)
     * @param {number} timeSeconds - ì‹œê°„ (ì´ˆ)
     * @returns {number} VDOT ê°’
     */
    function calculateExactVDOT(distanceMeters, timeSeconds) {
      const velocity = distanceMeters / (timeSeconds / 60); // m/min
      const time = timeSeconds / 60; // minutes
      
      // VO2 ê³„ì‚° (oxygen consumption)
      const vo2 = -4.60 + 0.182258 * velocity + 0.000104 * Math.pow(velocity, 2);
      
      // %VO2max ê³„ì‚° (sustainable fraction)
      const percentVO2max = 0.8 + 
        0.1894393 * Math.exp(-0.012778 * time) + 
        0.2989558 * Math.exp(-0.1932605 * time);
      
      // VDOT = VO2 / %VO2max
      const vdot = vo2 / percentVO2max;
      
      return vdot;
    }

    /**
     * VDOTì—ì„œ íŠ¹ì • ê±°ë¦¬ì˜ ì˜ˆìƒ ì‹œê°„ ê³„ì‚°
     * ì—­í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•œ ê·¼ì‚¬ê°’ ê³„ì‚°
     */
    function predictTimeFromVDOT(vdot, distanceMeters) {
      // ì´ì§„ íƒìƒ‰ìœ¼ë¡œ ì‹œê°„ ì°¾ê¸°
      let minTime = distanceMeters / 600; // 10 m/s = 600 m/min (ë§¤ìš° ë¹ ë¦„)
      let maxTime = distanceMeters / 60;  // 1 m/s = 60 m/min (ë§¤ìš° ëŠë¦¼)
      let midTime;
      
      for (let i = 0; i < 50; i++) { // 50íšŒ ë°˜ë³µìœ¼ë¡œ ì¶©ë¶„í•œ ì •í™•ë„
        midTime = (minTime + maxTime) / 2;
        const calculatedVDOT = calculateExactVDOT(distanceMeters, midTime * 60);
        
        if (Math.abs(calculatedVDOT - vdot) < 0.01) {
          break;
        }
        
        if (calculatedVDOT > vdot) {
          minTime = midTime;
        } else {
          maxTime = midTime;
        }
      }
      
      return midTime * 60; // seconds
    }

    /**
     * VDOTì—ì„œ í›ˆë ¨ í˜ì´ìŠ¤ ê³„ì‚°
     * Jack Danielsì˜ í›ˆë ¨ ê°•ë„ë³„ %VDOT ì‚¬ìš©
     */
    function calculateTrainingPaces(vdot) {
      // í›ˆë ¨ ê°•ë„ë³„ %VDOT (Jack Daniels' recommendations)
      const intensities = {
        easy: { min: 0.65, max: 0.79 },      // 65-79% of VDOT
        marathon: 0.84,                       // 84% of VDOT
        threshold: 0.88,                      // 88% of VDOT
        interval: 0.97,                       // 97-100% of VDOT
        repetition: 1.05                      // 105% of VDOT (anaerobic)
      };
      
      // 5000m ê¸°ì¤€ ì‹œê°„ ê³„ì‚° (í˜ì´ìŠ¤ ê³„ì‚°ìš©)
      const vdot5kTime = predictTimeFromVDOT(vdot, 5000);
      const vdot5kPace = vdot5kTime / 5; // seconds per km
      
      // ê° í›ˆë ¨ í˜ì´ìŠ¤ ê³„ì‚°
      const paces = {
        easy: {
          min: vdot5kPace / intensities.easy.max,
          max: vdot5kPace / intensities.easy.min
        },
        marathon: vdot5kPace / intensities.marathon,
        threshold: vdot5kPace / intensities.threshold,
        interval: vdot5kPace / intensities.interval,
        repetition: vdot5kPace / intensities.repetition
      };
      
      return paces;
    }

    // ==========================================
    // UI ê´€ë ¨ í•¨ìˆ˜ë“¤
    // ==========================================
    
    let userProfile = {
      gender: null,
      ageGroup: 'senior',
      experience: 'intermediate',
      condition: 0,
      adjustments: {
        pace: 0,
        volume: 0
      }
    };

    function selectGender(gender) {
      userProfile.gender = gender;
      
      document.getElementById('btn-male').classList.remove('border-purple-500', 'bg-purple-50');
      document.getElementById('btn-female').classList.remove('border-purple-500', 'bg-purple-50');
      
      if (gender === 'male') {
        document.getElementById('btn-male').classList.add('border-purple-500', 'bg-purple-50');
      } else {
        document.getElementById('btn-female').classList.add('border-purple-500', 'bg-purple-50');
      }
    }

    function setCondition(value) {
      document.querySelectorAll('.condition-btn').forEach(btn => {
        btn.classList.remove('border-purple-500', 'bg-purple-50');
      });
      
      const btn = document.querySelector(`.condition-btn[data-value="${value}"]`);
      btn.classList.add('border-purple-500', 'bg-purple-50');
      
      const conditionMap = {
        'very-bad': -20,
        'bad': -10,
        'normal': 0,
        'good': 5,
        'excellent': 10
      };
      userProfile.condition = conditionMap[value];
    }

    function updateAdjustment(type) {
      const value = parseInt(document.getElementById(type + 'Adjust').value);
      userProfile.adjustments[type] = value;
      document.getElementById(type + 'AdjustValue').textContent = 
        (value > 0 ? '+' : '') + value + '%';
    }

    function updateDistanceCustom() {
      const select = document.getElementById('raceDistance');
      const customInput = document.getElementById('customDistance');
      
      if (select.value === 'custom') {
        customInput.classList.remove('hidden');
      } else {
        customInput.classList.add('hidden');
      }
    }

    function formatPace(secondsPerKm) {
      const minutes = Math.floor(secondsPerKm / 60);
      const seconds = Math.floor(secondsPerKm % 60);
      return `${minutes}:${seconds.toString().padStart(2, '0')}/km`;
    }

    function formatTime(seconds) {
      const hours = Math.floor(seconds / 3600);
      const minutes = Math.floor((seconds % 3600) / 60);
      const secs = Math.floor(seconds % 60);
      
      if (hours > 0) {
        return `${hours}:${minutes.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
      }
      return `${minutes}:${secs.toString().padStart(2, '0')}`;
    }

    function getPerformanceLevel(vdot) {
      if (vdot >= 75) return { level: "ì—˜ë¦¬íŠ¸", desc: "êµ­ì œ ìˆ˜ì¤€" };
      if (vdot >= 65) return { level: "ì¤€ì—˜ë¦¬íŠ¸", desc: "êµ­ë‚´ ìƒìœ„ê¶Œ" };
      if (vdot >= 55) return { level: "ìƒê¸‰ì", desc: "ì§€ì—­ ëŒ€íšŒ ì…ìƒê¶Œ" };
      if (vdot >= 45) return { level: "ì¤‘ê¸‰ì", desc: "ê¾¸ì¤€í•œ í›ˆë ¨ì" };
      if (vdot >= 35) return { level: "ì´ˆê¸‰ì", desc: "ëŸ¬ë‹ ì…ë¬¸ì" };
      return { level: "ì…ë¬¸ì", desc: "ì‹œì‘ ë‹¨ê³„" };
    }

    function calculateExactTraining() {
      // ì…ë ¥ê°’ ê²€ì¦
      const distanceSelect = document.getElementById('raceDistance').value;
      let distance;
      
      if (distanceSelect === 'custom') {
        distance = parseFloat(document.getElementById('customDistance').value);
      } else {
        distance = parseFloat(distanceSelect);
      }
      
      const hours = parseInt(document.getElementById('hours').value) || 0;
      const minutes = parseInt(document.getElementById('minutes').value) || 0;
      const seconds = parseFloat(document.getElementById('seconds').value) || 0;
      
      if (!distance || (hours === 0 && minutes === 0 && seconds === 0)) {
        alert('ê±°ë¦¬ì™€ ê¸°ë¡ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
        return;
      }
      
      if (!userProfile.gender) {
        alert('ì„±ë³„ì„ ì„ íƒí•´ì£¼ì„¸ìš”.');
        return;
      }
      
      // ì´ ì‹œê°„ ê³„ì‚° (ì´ˆ)
      const totalSeconds = hours * 3600 + minutes * 60 + seconds;
      
      // ì •í™•í•œ VDOT ê³„ì‚°
      let exactVDOT = calculateExactVDOT(distance, totalSeconds);
      
      // ì—¬ì„± ë³´ì • (í‘œì‹œìš©)
      const displayVDOT = userProfile.gender === 'female' ? exactVDOT * 0.88 : exactVDOT;
      
      // í›ˆë ¨ í˜ì´ìŠ¤ ê³„ì‚°
      let paces = calculateTrainingPaces(exactVDOT);
      
      // ì¡°ì •ê°’ ì ìš©
      const paceAdjustment = 1 + (userProfile.condition + userProfile.adjustments.pace) / 100;
      Object.keys(paces).forEach(key => {
        if (key === 'easy') {
          paces.easy.min *= paceAdjustment;
          paces.easy.max *= paceAdjustment;
        } else {
          paces[key] *= paceAdjustment;
        }
      });
      
      // ìˆ˜ì¤€ íŒë‹¨
      const level = getPerformanceLevel(displayVDOT);
      
      // UI ì—…ë°ì´íŠ¸
      document.getElementById('exactVdot').textContent = displayVDOT.toFixed(1);
      document.getElementById('level').textContent = level.level;
      document.getElementById('levelDesc').textContent = level.desc;
      document.getElementById('vo2max').textContent = exactVDOT.toFixed(1);
      
      // í˜ì´ìŠ¤ í‘œì‹œ
      document.getElementById('easyPace').textContent = 
        `${formatPace(paces.easy.min)} - ${formatPace(paces.easy.max)}`;
      document.getElementById('marathonPace').textContent = formatPace(paces.marathon);
      document.getElementById('thresholdPace').textContent = formatPace(paces.threshold);
      document.getElementById('intervalPace').textContent = formatPace(paces.interval);
      document.getElementById('repetitionPace').textContent = formatPace(paces.repetition);
      
      // ì •í™•ë„ ë¹„êµ (ê¸°ì¡´ í…Œì´ë¸” ë°©ì‹ê³¼ ë¹„êµ)
      showAccuracyComparison(distance, totalSeconds, exactVDOT);
      
      // ì˜ˆìƒ ê¸°ë¡ ê³„ì‚°
      showRacePredictions(exactVDOT);
      
      // ê²°ê³¼ ì„¹ì…˜ í‘œì‹œ
      document.getElementById('resultsSection').classList.remove('hidden');
      document.getElementById('resultsSection').scrollIntoView({ behavior: 'smooth' });
    }

    function showAccuracyComparison(distance, timeSeconds, exactVDOT) {
      // ê°„ë‹¨í•œ í…Œì´ë¸” ë°©ì‹ VDOT (ë¹„êµìš©)
      const tableVDOT = Math.round(exactVDOT / 5) * 5; // 5 ë‹¨ìœ„ë¡œ ë°˜ì˜¬ë¦¼
      const difference = exactVDOT - tableVDOT;
      const percentError = (difference / exactVDOT) * 100;
      
      const html = `
        <div class="flex items-center justify-between">
          <div>
            <span class="text-sm text-gray-600">ì •í™•í•œ ê³µì‹ vs í…Œì´ë¸” ë°©ì‹</span>
            <div class="text-sm mt-1">
              <span class="font-bold text-green-600">${exactVDOT.toFixed(2)}</span> vs 
              <span class="font-bold text-orange-600">${tableVDOT}</span>
              <span class="text-gray-500 ml-2">(ì°¨ì´: ${difference > 0 ? '+' : ''}${difference.toFixed(2)})</span>
            </div>
          </div>
          <div class="text-right">
            <span class="text-xs text-gray-500">ì •í™•ë„ í–¥ìƒ</span>
            <div class="text-lg font-bold ${Math.abs(percentError) > 3 ? 'text-green-600' : 'text-gray-600'}">
              ${Math.abs(percentError).toFixed(1)}%
            </div>
          </div>
        </div>
      `;
      
      document.getElementById('accuracyComparison').innerHTML = html;
    }

    function showRacePredictions(vdot) {
      const distances = [
        { name: '800m', distance: 800 },
        { name: '1500m', distance: 1500 },
        { name: '3000m', distance: 3000 },
        { name: '5000m', distance: 5000 },
        { name: '10km', distance: 10000 },
        { name: 'í•˜í”„', distance: 21097.5 },
        { name: 'í’€ë§ˆë¼í†¤', distance: 42195 },
        { name: '3000m SC', distance: 3000 }
      ];
      
      let html = '';
      distances.forEach(race => {
        const predictedTime = predictTimeFromVDOT(vdot, race.distance);
        const pace = formatPace(predictedTime / (race.distance / 1000));
        
        html += `
          <div class="bg-gray-50 p-3 rounded-lg">
            <div class="text-sm text-gray-600">${race.name}</div>
            <div class="font-bold text-lg">${formatTime(predictedTime)}</div>
            <div class="text-xs text-gray-500">${pace}</div>
          </div>
        `;
      });
      
      document.getElementById('racePredictions').innerHTML = html;
    }

    // ì´ˆê¸°í™”
    document.addEventListener('DOMContentLoaded', function() {
      setCondition('normal');
    });
  </script>
</body>
</html>